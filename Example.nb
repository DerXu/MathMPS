(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     56022,       1464]
NotebookOptionsPosition[     49597,       1264]
NotebookOutlinePosition[     50451,       1295]
CellTagsIndexPosition[     50281,       1288]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
the directory that contains the MPS library", "Text",
 CellChangeTimes->{{3.489233981644697*^9, 3.4,

Cell[CellGroupData[{

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], ",

ut",
 CellChangeTimes->{{3.4742833947087593`*^9, 3.4742833971097183`*^9}}],

Cell[BoxData["\<\"/Users/fcucchietti/Code/MathMPS\"\>"], "Output",,

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4742833947087593`*^9, 3.4742833971097183`*^9}}],

Cell[BoxData["\<\"/Users/fcucchietti/Code/MathMPS\"\>"], "Output",
 CellChangeTimes->{
  3.47428339993287*^9, 3.4742834900929127`*^9, 3.4742839068114157`*^9, 
   3.4742861595526752`*^9, 3.474286276253614*^9, 3.47429022395389*^9, 
   3.474290358882016*^9, 3.4742905428907433`*^9, 3.474291254839636*^9, 
   3.474291384203182*^9, 3.474291504371645*^9, 3.4742919670093822`*^9, 
   3.474292932942101*^9, 3.4743056200856457`*^9, 3.474352808709919*^9, 
   3.474367971530735*^9, 3.47437037146124*^9, 3.4892340440393333`*^9, 
   3.4892361947511463`*^9, 3.489236574298616*^9, 3.489236826405078*^9, 
   3.4892374111952953`*^9, 3.4892375557086782`*^9, 3.489294204443529*^9, 
   3.4892953240856857`*^9, 3.4892961744909363`*^9, 3.4893006961774607`*^9, {
   3.4893012132077303`*^9, 3.489301214363079*^9}, 3.489306964260322*^9}]
}, Open  ]],

Cell["Load the library", "Text",
 CellChangeTimes->{{3.489233993386242*^9, 3.48923399543499*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "MPS.m"}]], "Input",
 CellChangeTimes->{{3.474265959754241*^9, 3.4742659727833023`*^9}, {
  3.474266006004148*^9, 3.474266006093193*^9}, {3.47426605128262*^9, 
  3.4742660515198603`*^9}}],

Cell[BoxData["\<\"MPS manipulation from Mathematica.\\nMPS Manipulation and \
creation:\\n\\tMPSProductState\\n\\tMPSExpandBond\\n\\tMPSNormalize\\n\\\
tMPSCanonize\\nReading and saving to \
disk:\\n\\tMPSRead\\n\\tMPSSave\\nExpectation \
values:\\n\\tMPSExpectation\\n\\tMPSCorrelation\\nAlgorithms:\\n\\\
tMPSApproximate\\n\\tMPSMinimizeEnergy\\nHamiltonian \
Creation:\\n\\tMPSInitHamiltonian\\n\\tMPSHamiltonianAdd\\n\\nAlso available \
are TEBD algorithms:\\n\\nCreation and disk \
interaction:\\n\\tTEBDProductState\\n\\tTEBDRead\\n\\tTEBDSave\\nReal and \
imaginary time evolution:\\n\\tTEBDEvolve\\nExpectation \
values:\\n\\tTEBDExpectation\\n\\tTEBDExpectationList\\n\\tTEBDentropy\\n\\\
tTEBDentropyList\\nHamiltonians and evolution \
operators:\\n\\tTEBDInitHamiltonian\\n\\tTEBDHamiltonianAdd\\n\\\
tTEBDEvolutionFromHamiltonian\\n\\tTEBDInitEvolution\\n\\\
tTEBDEvolutionAddGate\\n\"\>"], "Print",
 CellChangeTimes->{
  3.489236196025882*^9, 3.4892365756257143`*^9, {3.489236827698267*^9, 
   3.48923683143458*^9}, 3.489237413811884*^9, 3.4892375576998568`*^9, 
   3.4892942059936647`*^9, 3.489295325654924*^9, 3.489296101094775*^9, 
   3.489296176290408*^9, 3.489296488886742*^9, 3.489297152106338*^9, {
   3.489297239596204*^9, 3.489297248436446*^9}, 3.4892973410652533`*^9, 
   3.489297398965304*^9, 3.489300126529524*^9, {3.489300193562796*^9, 
   3.4893002285150557`*^9}, 3.4893006321721497`*^9, 3.4893006963381453`*^9, 
   3.489300772297621*^9, 3.48930112848275*^9, 3.489301182447118*^9, 
   3.489301214494012*^9, 3.48930171595041*^9, 3.489305181587626*^9, 
   3.489305331842105*^9, 3.4893054241466093`*^9, {3.489306965912939*^9, 
   3.489306988462085*^9}}]
}, Open  ]],

Cell["Set some simulation parameters", "Text",
 CellChangeTimes->{{3.4892339979539213`*^9, 3.489234002561816*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bond", "=", "8"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "will", " ", "be", " ", "the", " ", "Bond", " ", 
     "Dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"length", "=", "10"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Length", " ", "of", " ", "the", " ", "chain"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intrange", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Interaction", " ", "range"}], ",", " ", 
    RowBox[{"1", " ", "is", " ", "nearest", " ", "neighbor"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]Field", " ", "=", " ", "0.3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Magnetic", " ", "field"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JCoupling", "=", "1.0"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Spin", "-", 
    RowBox[{"spin", " ", "coupling"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4892340060049553`*^9, 3.4892341413757877`*^9}, {
  3.489236204244766*^9, 3.489236231113943*^9}}],

Cell["We start by creating a random MPS.", "Text",
 CellChangeTimes->{{3.48923415927713*^9, 3.48923417481992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mymps", "=", 
   RowBox[{"MPSProductState", "[", 
    RowBox[{"length", ",", 
     RowBox[{"Bond", "\[Rule]", "bond"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4892341774480467`*^9, 3.489234178310319*^9}}],

Cell["Normalization typically is optional, but it's a good habit", "Text",
 CellChangeTimes->{{3.489234181844184*^9, 3.489234196603504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MPSNormalize", "[", "mymps", "]"}], ";"}]], "Input",
 CellChangeTimes->{3.48923419903065*^9}],

Cell["The MPS is a nasty collection of matrices", "Text",
 CellChangeTimes->{{3.489294224545177*^9, 3.489294234144956*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mymps", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Normal"}]], "Input",
 CellChangeTimes->{{3.489294236743082*^9, 3.489294251821848*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.21272893993024297`"}], "-", 
       RowBox[{"0.17620501004948994`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.102540463561758`"}], "+", 
       RowBox[{"0.22427796574478004`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.048322720347164`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.2601178001952004`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.09403715866231306`"}], "-", 
       RowBox[{"0.19377791818935736`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.3333633636421698`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.18757021154031425`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.1805105897979548`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.27160568421303355`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.21116109134909788`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.11356768731540894`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.2510131543231555`"}], "+", 
       RowBox[{"0.050215564221329986`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.28525251641419674`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.005034313356966591`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.09932966001956926`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.2949823993670018`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.2901896350149127`"}], "-", 
       RowBox[{"0.059074278089239894`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.24051734763028895`"}], "+", 
       RowBox[{"0.2312026958835081`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.09365009829659182`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.05110863425031449`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.19796125411547794`"}], "+", 
       RowBox[{"0.11024414281486819`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.31119745446304065`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.05801437852640171`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.13946668517850802`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.2696590200122844`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.489294240357108*^9, 3.489294252296864*^9}, 
   3.4892953333443336`*^9, 3.489301214611249*^9, 3.489305187407249*^9, 
   3.489305435356701*^9}]
}, Open  ]],

Cell["\<\
Now we need to create the Hamiltonian. For readability we define the axes \
names\
\>", "Text",
 CellChangeTimes->{{3.4892342050516043`*^9, 3.489234212219406*^9}, {
  3.489236295870122*^9, 3.489236303389817*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xaxis", "=", "1"}], ";", " ", 
  RowBox[{"Yaxis", "=", "2"}], ";", 
  RowBox[{"Zaxis", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyHamiltonian", "=", 
   RowBox[{"MPSInitHamiltonian", "[", "length", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Add", " ", "field", " ", "terms"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", "m"}], ",", 
      RowBox[{"MPSHamiltonianAdd", "[", 
       RowBox[{"MyHamiltonian", ",", "Xaxis", ",", "\[Mu]Field", ",", "n"}], 
       "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Add", " ", "nearest", " ", "neighborg", " ", "interaction"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", 
       RowBox[{"m", "+", "1"}]}], ",", 
      RowBox[{"MPSHamiltonianAdd", "[", 
       RowBox[{
       "MyHamiltonian", ",", "Zaxis", ",", "JCoupling", ",", "n", ",", "m"}], 
       "]"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "length"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"m", ",", "1", ",", "length"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.489236147788294*^9, 3.489236192466975*^9}, {
  3.489236241689937*^9, 3.489236407775688*^9}, {3.489237433345026*^9, 
  3.489237435358623*^9}}],

Cell["Finally compute the ground state", "Text",
 CellChangeTimes->{{3.489236418981338*^9, 3.489236428350278*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"energy", "=", 
  RowBox[{"MPSMinimizeEnergy", "[", 
   RowBox[{"mymps", ",", "MyHamiltonian", ",", 
    RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
    RowBox[{"Tolerance", "\[Rule]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "7"}], ")"}]}]}], ",", 
    RowBox[{"Sweeps", "\[Rule]", "6"}], ",", 
    RowBox[{"MonitorEnergy", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.489236455774604*^9, 3.489236459796526*^9}, {
  3.4892365900807858`*^9, 3.4892365995418043`*^9}, {3.489236849546856*^9, 
  3.4892368575343924`*^9}, {3.4892368964642467`*^9, 3.48923689659702*^9}, {
  3.489237510546959*^9, 3.4892375111441803`*^9}, {3.4893051941262493`*^9, 
  3.48930520588696*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Lists \\\\\\\"\\\", \\\"MT\\\
\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\({MathMPS`Private`energy$86122, \
MathMPS`Private`new$86122, MathMPS`Private`info$86122}\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" and \\\\\\\"\\\", \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\!\\(MathMPS`Private`FindGroundMPSSite[\\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)]\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" are not the same \
shape.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Set/shape\\\", \
ButtonNote -> \\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4893054378826437`*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305437908866*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkn\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Argument \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkObject[\\(\\(\\\"/Users/\
fcucchietti/Code/MathMPS/arpackformps_MacOSX-x86-64\\\", 8, 8\\)\\)]\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" in \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkClose[\\(\\(LinkObject[\\(\
\\(\\\"/Users/fcucchietti/Code/MathMPS/arpackformps_MacOSX-x86-64\\\", 8, \
8\\)\\)]\\)\\)]\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" \
has an invalid LinkObject number; the link may be closed.\\\\\\\"\\\", \\\"MT\
\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\
\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkn\\\", ButtonNote -> \
\\\"LinkObject::linkn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.48930543797519*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkn\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Argument \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkObject[\\(\\(\\\"/Users/\
fcucchietti/Code/MathMPS/arpackformps_MacOSX-x86-64\\\", 8, 8\\)\\)]\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" in \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkPatterns[\\(\\(LinkObject[\
\\(\\(\\\"/Users/fcucchietti/Code/MathMPS/arpackformps_MacOSX-x86-64\\\", 8, \
8\\)\\)]\\)\\)]\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" \
has an invalid LinkObject number; the link may be closed.\\\\\\\"\\\", \\\"MT\
\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\
\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkn\\\", ButtonNote -> \
\\\"LinkObject::linkn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4893054379993773`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unset", "::", "\<\"norep\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Assignment on \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkPatterns\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" for \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkPatterns[\\(\\(LinkObject[\
\\(\\(\\\"/Users/fcucchietti/Code/MathMPS/arpackformps_MacOSX-x86-64\\\", 8, \
8\\)\\)]\\)\\)]\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" \
not found.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Unset/norep\\\", \
ButtonNote -> \\\"Unset::norep\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4893054380366783`*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.489305439040423*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Lists \\\\\\\"\\\", \\\"MT\\\
\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\({MathMPS`Private`energy$86122, \
MathMPS`Private`new$86122, MathMPS`Private`info$86122}\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" and \\\\\\\"\\\", \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\!\\(MathMPS`Private`FindGroundMPSSite[\\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)]\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" are not the same \
shape.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Set/shape\\\", \
ButtonNote -> \\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.489305439065819*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305439096981*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkn\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Argument \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkObject[\\(\\(\\\"/Users/\
fcucchietti/Code/MathMPS/arpackformps_MacOSX-x86-64\\\", 9, 8\\)\\)]\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" in \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkClose[\\(\\(LinkObject[\\(\
\\(\\\"/Users/fcucchietti/Code/MathMPS/arpackformps_MacOSX-x86-64\\\", 9, \
8\\)\\)]\\)\\)]\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" \
has an invalid LinkObject number; the link may be closed.\\\\\\\"\\\", \\\"MT\
\\\"]\\) \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\
\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkn\\\", ButtonNote -> \
\\\"LinkObject::linkn\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.489305439130891*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Further output of \\\\\\\"\\\
\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkObject :: \\\"linkn\\\
\"\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" will be \
suppressed during this calculation.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.489305439162785*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unset", "::", "\<\"norep\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Assignment on \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkPatterns\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" for \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkPatterns[\\(\\(LinkObject[\
\\(\\(\\\"/Users/fcucchietti/Code/MathMPS/arpackformps_MacOSX-x86-64\\\", 9, \
8\\)\\)]\\)\\)]\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" \
not found.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Unset/norep\\\", \
ButtonNote -> \\\"Unset::norep\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.489305439196879*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.489305440100996*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Lists \\\\\\\"\\\", \\\"MT\\\
\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\({MathMPS`Private`energy$86122, \
MathMPS`Private`new$86122, MathMPS`Private`info$86122}\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" and \\\\\\\"\\\", \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\!\\(MathMPS`Private`FindGroundMPSSite[\\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)]\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" are not the same \
shape.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Set/shape\\\", \
ButtonNote -> \\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.489305440126828*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Further output of \\\\\\\"\\\
\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Set :: \\\"shape\\\"\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" will be suppressed \
during this calculation.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.489305440160499*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305440192484*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unset", "::", "\<\"norep\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Assignment on \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkPatterns\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" for \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(LinkPatterns[\\(\\(LinkObject[\
\\(\\(\\\"/Users/fcucchietti/Code/MathMPS/arpackformps_MacOSX-x86-64\\\", 10, \
8\\)\\)]\\)\\)]\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" \
not found.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Unset/norep\\\", \
ButtonNote -> \\\"Unset::norep\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4893054402273808`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Further output of \\\\\\\"\\\
\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(Unset :: \
\\\"norep\\\"\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" will \
be suppressed during this calculation.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.489305440259379*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.489305441154726*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305441178856*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.489305442190054*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305442217683*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.4893054432272377`*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305443255315*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.489305444264998*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305444293641*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.4893054453026047`*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305445331169*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.489305446339191*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305446367263*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.489305447376046*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.4893054474038*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.489305448414647*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.4893054484429703`*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.48930544945444*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305449482382*^9}],

Cell[BoxData["\<\"And we're back.\"\>"], "Print",
 CellChangeTimes->{3.4893054504860992`*^9}],

Cell[BoxData["\<\"Fallen link...\"\>"], "Print",
 CellChangeTimes->{3.489305450516438*^9}]
}, Open  ]],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.489236613331408*^9, 3.4892368461353083`*^9, {3.489236891659401*^9, 
   3.4892369008576517`*^9}, 3.489236982668428*^9, 3.48923713496948*^9, 
   3.4892374417669783`*^9, {3.4892375050135193`*^9, 3.489237515613399*^9}, 
   3.489237566015382*^9, 3.4892942600120907`*^9, 3.489295336663473*^9, 
   3.489301214906769*^9, 3.4893052079162827`*^9, 3.489305335669949*^9, 
   3.489305367137938*^9, 3.489305451522265*^9}]
}, Open  ]],

Cell["The state has changed.", "Text",
 CellChangeTimes->{{3.489294270868896*^9, 3.489294274215707*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mymps", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Normal"}]], "Input",
 CellChangeTimes->{{3.489294261633889*^9, 3.489294265817164*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.08146729006672038`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.6223168742744813`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.04227748964194811`"}], "-", 
       RowBox[{"0.3229510844791508`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.08146728993747587`"}], "-", 
       RowBox[{"0.6223168732921847`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.04227748970749942`"}], "-", 
       RowBox[{"0.3229510849894366`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4892942661840467`*^9, 3.489295338059111*^9, 
  3.4893012149427547`*^9}]
}, Open  ]],

Cell["\<\
Now improve precision by making a larger bond MPS. You can ask for help on \
specific commands like in Mathematica\
\>", "Text",
 CellChangeTimes->{{3.4892375726617613`*^9, 3.48923758221214*^9}, {
  3.489294281767747*^9, 3.4892942941909323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MPSExpandBond"}]], "Input",
 CellChangeTimes->{{3.489237583933896*^9, 3.489237596396716*^9}}],

Cell[BoxData[
 StyleBox["\<\"MPSExpandBond[mps,new\[Chi]] expands the bond dimension \[Chi] \
of mps to new\[Chi]. Returns the expanded mps as a new variable\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.489301215226935*^9},
 CellTags->"Info3489308414-8469528"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MPSExpandBond", "[", 
   RowBox[{"mymps", ",", "15"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.489237598777522*^9, 3.4892376127488194`*^9}}],

Cell[BoxData["\<\"Grow \[Chi] to 15\"\>"], "Print",
 CellChangeTimes->{{3.489237607961445*^9, 3.489237613125641*^9}, 
   3.489294302148835*^9, 3.489295341378667*^9, 3.48930121558326*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Newenergy", "=", 
  RowBox[{"MPSMinimizeEnergy", "[", 
   RowBox[{"mymps", ",", "MyHamiltonian", ",", 
    RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
    RowBox[{"Tolerance", "\[Rule]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "5"}], ")"}]}]}], ",", 
    RowBox[{"Sweeps", "\[Rule]", "5"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.489237621470517*^9, 3.489237628308235*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2.5289174665369405`"}], "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.4892376321327*^9, 3.489294304058454*^9, 
  3.489295342592107*^9, 3.489301215901973*^9}]
}, Open  ]],

Cell["Measure something", "Text",
 CellChangeTimes->{{3.48923764396305*^9, 3.489237647121537*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MPSExpectation"}]], "Input",
 CellChangeTimes->{{3.489237649056497*^9, 3.4892376537781982`*^9}, {
  3.48923768575609*^9, 3.489237689801693*^9}}],

Cell[BoxData[
 StyleBox["\<\"\\nMPSExpectation[mps,operator,site]\\nMPSExpectation[mps,\
operator,site1,site2]\\nMPSExpectation[mps,operator1,site1,operator2,site2]\\\
n\\nComputes the expectation value of one or two Hermitian operators acting \
on one or two sites\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.489301216275836*^9},
 CellTags->"Info3489308415-5731344"]
}, Open  ]],

Cell["Let us define some operators to make it clean", "Text",
 CellChangeTimes->{{3.4892944137792253`*^9, 3.489294420258649*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.0", ",", "0.0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "1.0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"I", " ", "1.0"}], ",", "0.0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.0", ",", "0.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", 
       RowBox[{"-", "1.0"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Id", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.0", ",", "0.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", "1.0"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.489294422863744*^9, 3.489294457796294*^9}, {
  3.489301656712947*^9, 3.489301660248805*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSExpectation", "[", 
  RowBox[{"mymps", ",", "X", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.48923769206278*^9, 3.489237718184559*^9}, {
  3.489237840593968*^9, 3.48923784646985*^9}, {3.489294902111092*^9, 
  3.489294906156665*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.32402135414550304`"}]], "Output",
 CellChangeTimes->{3.489237719307809*^9, 3.489237847230175*^9, 
  3.4892949068259497`*^9, 3.489295347970153*^9, 3.489301216701922*^9}]
}, Open  ]],

Cell["A correlation can be directly plotted", "Text",
 CellChangeTimes->{{3.48929491193437*^9, 3.4892949256906347`*^9}, {
  3.489295011818145*^9, 3.4892950150560293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"MPSCorrelation", "[", 
   RowBox[{"mymps", ",", "Z", ",", "1", ",", "Z", ",", "10"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.489294986554552*^9, 3.489295019233067*^9}, {
  3.48930144348917*^9, 3.489301444845552*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], 
   PointBox[{{1., -0.78752652850323}, {2., 0.7602954340219814}, {
    3., -0.7530958164997116}, {4., 0.7501483162107191}, {
    5., -0.7480094494247441}, {6., 0.7449515649745176}, {
    7., -0.73770157719623}, {8., 0.7153190229659891}, {
    9., -0.631021087535252}}]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, Automatic},
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.489295000137792*^9, 3.489295019956675*^9}, 
   3.4892953497553673`*^9, 3.4893012167698727`*^9, 3.489301445181386*^9},
 ImageCache->GraphicsData["CompressedBitmap", "\<\
eJztWr+L5FQcf7s7uwqKZ2W9WqrkPxAJ7uxWGtuDNMth2BXEcC5isEuXStLN
gTDVgDDXDBZTDXJTTTMcTOEcmGI4SGGKFGlSBPn4fe8lmaiZJLN3npHNwLzM
vO/vH8n7JC+fXt5cffHV5c31g8vTi4eX5tX1g29Oz79+SFNHB4wdXDHGfj1l
PfoN+lkc+OeaD4y9Iw5HyKb5PzF+3iK6IL+bcj596uO7b6f8KDk/3K0pk+H8
H3/0iB8by+xjpy6iL0t0Pq9nL7p9XqLi0X4Wz0vUXpTwabvV/lzCflGitkLF
H/tZrEvtS6dvyW06Bf4NelntTxrKFIvdVGYfO11FX4D+WkoHEoRBSCNYL5tL
YkRRJP4d1+iRRXoTCJcwVROjkQPNHCPm88lv0EnuxyePhbxuO7BMF+sIvRq1
0uxbwr2pwWBMA0GeWwrMqS9+h/7vZCYhV2OpwZ9A1Ufc9FGNevYGYm8K0zBh
WVb6NWE6P+F7pmIWSpmlq4DZizwJSJZQFQdhmrpKE8QQh/B9n3/ZoRhP4D//
BSqZWERSJpzbUO2FzAeNSYAJxciaxSEd4zUI4Shbx1euyh0/zEsYYWyqkKu7
jkWQyGIf55o/+7vCGCON513mmteA8p75sxoYsCYrRHHSsEOIK0o7ZCw7JMqT
SLR4BUNCDzBtWKA16eAYYSi7NZtLYt4YUuawRs9/fSa2gn7nrn//C3pXlTbS
u6q0kS7Iz1JOJBFCCQvyWxoxl64TH+xW/EnGjgCuKu+GD8V4hJEX53xnGV+8
hKa6Ysnqi7ljwkJDaLqDoUuYYrAQ4OospflzF6pmY0xASTeGZAXs/d3uZGJ8
hTQ1Bxu+rEUeprN16qpcrH1vjdV6jfViRPjCwNwLznKyRzBMwVzEHsGRCGcr
HcFVFEwkwsKQgh6s4wqf+lnomwmFILBe6ietv8kamsB6NmxTF3KGOxM8mcVk
MwJTRMqE7wOFwV1GWagc41nzgLI4IHHyO6zMUFbfYGZDd5d/yVpAyXYEKFqJ
Im09JS8ILkowFCNYcFMqljEkuSeyZqWQxJkHtR1zImBznKIOgRRJuZcgryCH
sgQ0Z94cBvkSFqtLWdMF9rHgUOYmqyBvJm9skDkTw4EJ3ZmJZqpIx7asHhxr
yM1QwicyvAj9LLzEg83bWx1wlqykm4lJnBLh9gvtxbGguxaBif6hXmrQtDz9
SppD3Z0L17NyxZ5sgjCf68Gb0rmhGhjNVrw5cjVUHZ3uG8YDC5ol+61Je/Lb
GFkQ5mZz/FTZ+IWzNbswyItFRZnF+IquaPfSOcbu8+Fgt9S9hnNvd7IvJCvv
croStLME5w3nLhryNVhuXoEpMbYJY3XI+i7Su6q0kd5Vpct6C+h3ex9h+7g8
gP3PjYPb7BvkKuPlvhsFFU/zb7c90CjybqPgLtG7C2Ab6Vvyeyl7cSO97qFG
JlPcsG8qs4+dioielai72c3+Qwl72asrFSr6JSrK3lwoe6mmgdq6F2hm+3km
KK/fPr8vnb73dYAd/Alg8mzX\
\>"]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["TEBD Example", "Section",
 CellChangeTimes->{{3.4892951054221153`*^9, 3.4892951080206547`*^9}}],

Cell["We will use the same parameters as above", "Text",
 CellChangeTimes->{{3.4892952215547047`*^9, 3.48929522931316*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bond", "=", "8"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "will", " ", "be", " ", "the", " ", "Bond", " ", 
     "Dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"length", "=", "10"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Length", " ", "of", " ", "the", " ", "chain"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intrange", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Interaction", " ", "range"}], ",", " ", 
    RowBox[{"1", " ", "is", " ", "nearest", " ", "neighbor"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]Field", " ", "=", " ", "0.3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Magnetic", " ", "field"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JCoupling", "=", "1.0"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Spin", "-", 
    RowBox[{"spin", " ", "coupling"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4892340060049553`*^9, 3.4892341413757877`*^9}, {
  3.489236204244766*^9, 3.489236231113943*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "TEBDProductState"}]], "Input",
 CellChangeTimes->{{3.4892952800409937`*^9, 3.489295280264814*^9}}],

Cell[BoxData[
 StyleBox["\<\"TEBDProductState[numSites,Options]\\nCreates a TEBD \
representation state. \\nOptions:\\n\tSpin\[Rule]integer (Default is 2)\\n\t\
BondDimension\[Rule]integer   (default is 20)\\n\tType\[Rule]{type,list}     \
(Creates several types of TEBDs: type=\\\"Random\\\" , \\\"Identity\\\", or \
\\\"Specified\\\".\\n\t\t\t\t\t\tIf Specified is chosen, then list must be a \
Table of dimensions {numSites,2}, containing in each element a pair \
{probAmplitude,phase}\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.489301217002061*^9},
 CellTags->"Info3489308416-9597017"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mytebd", "=", 
   RowBox[{"TEBDProductState", "[", 
    RowBox[{"10", ",", 
     RowBox[{"BondDimension", "\[Rule]", "15"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4892952045398808`*^9, 3.489295250153894*^9}, 
   3.48929550283377*^9, {3.489299693222336*^9, 3.489299705501548*^9}}],

Cell["\<\
To create the Hamiltonian we must keep in mind that the order in which the \
operators are added imposes the sequence in which they are implemented later \
in the evolution operator. In principle we can also create an evolution \
operator directly, which gives us even more control since we can do periodic \
boundary conditions or long range interactions. The control is primitive but \
powerful, however in the future I expect to come up with some algorithm that \
finds some optimal evolution operator automatically.\
\>", "Text",
 CellChangeTimes->{{3.489295534535015*^9, 3.4892956625311747`*^9}}],

Cell["\<\
For now, let us see how we can make the evolution operator with imaginary \
time of the same system but with periodic boundary conditions. We have to \
first initialize\
\>", "Text",
 CellChangeTimes->{{3.4892956684508867`*^9, 3.489295739080545*^9}, {
  3.4892960842809057`*^9, 3.489296093693654*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TEBDInitEvolution", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4892961899700813`*^9, 3.48929619824019*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]t", "=", 
   RowBox[{
    RowBox[{"-", "I"}], " ", "0.01"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZZ", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"Z", ",", "Z"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4892962354495373`*^9, 3.4892962456313877`*^9}, {
  3.4892962882348013`*^9, 3.4892963232638063`*^9}}],

Cell["\<\
We will do a Trotter-Suzuki evolution of second order. For this, we first add \
evolution gates to the odd bonds for a time \[Delta]t/2\
\>", "Text",
 CellChangeTimes->{{3.489296210963647*^9, 3.4892962517522907`*^9}, {
  3.489296384492824*^9, 3.48929641145214*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
       RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
     RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "9", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296257400681*^9, 3.489296275481769*^9}, {
  3.489296327472519*^9, 3.489296378775653*^9}}],

Cell["Now the even bonds", "Text",
 CellChangeTimes->{{3.489296505569009*^9, 3.489296508816763*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
       RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
     RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2", ",", "8", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296521154668*^9, 3.4892965261865063`*^9}}],

Cell["\<\
The end-to-end coupling needs to be done by swapping the first and last spins \
until they are next to each other. For this, we add a bunch of swap operations\
\>", "Text",
 CellChangeTimes->{{3.489296535922002*^9, 3.489296576222486*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"SWAP", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.0", ",", "0.0", ",", "0.0", ",", "0.0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "0.0", ",", "1.0", ",", "0.0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "1.0", ",", "0.0", ",", "0.0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "0.0", ",", "0.0", ",", "1.0"}], "}"}]}], "}"}]}], 
   ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.489296577936371*^9, 3.489296627342717*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "1.`", "0.`"},
     {"0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4892966279074993`*^9, 3.489297020963616*^9, 
  3.489297107157806*^9, 3.489301217293997*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", "SWAP", ",", "i", ",", 
     RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296640953506*^9, 3.489296650646451*^9}}],

Cell["Now make them interact", "Text",
 CellChangeTimes->{{3.489296679860825*^9, 3.4892966831389713`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TEBDEvolutionAddGate", "[", 
   RowBox[{"U", ",", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
      RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "9", ",", "10"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.489296699492585*^9, 3.489296717607849*^9}}],

Cell["And bring it back to where it was", "Text",
 CellChangeTimes->{{3.4892967221140013`*^9, 3.489296727481517*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", "SWAP", ",", "i", ",", 
     RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "8", ",", "1", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296640953506*^9, 3.489296650646451*^9}, {
  3.48929673638741*^9, 3.489296739123128*^9}}],

Cell["Now we add the field terms to all the sites", "Text",
 CellChangeTimes->{{3.489296679860825*^9, 3.4892966831389713`*^9}, {
  3.4892967477367764`*^9, 3.489296754192624*^9}, {3.489296790655737*^9, 
  3.4892967922793903`*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "\[Mu]Field", " ", "X"}], 
      "]"}], ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296774348378*^9, 3.489296787289901*^9}, {
  3.489297037147304*^9, 3.489297037290173*^9}, {3.489299735389337*^9, 
  3.48929973554928*^9}}],

Cell["\<\
To complete the second order Trotter-Suzuki, we need to add the same gates \
but in transposed order\
\>", "Text",
 CellChangeTimes->{{3.4892967978090057`*^9, 3.489296818014518*^9}, {
  3.4892970420480223`*^9, 3.4892971242451353`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", "SWAP", ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TEBDEvolutionAddGate", "[", 
   RowBox[{"U", ",", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
      RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "9", ",", "10"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", "SWAP", ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "8", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
        RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "8", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
        RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "9", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.4892968244666986`*^9, 3.48929685953802*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
        RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "8", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
        RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "9", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input"],

Cell["We have a total of", "Text",
 CellChangeTimes->{{3.489296886636304*^9, 3.489296889468389*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "U", "]"}]], "Input",
 CellChangeTimes->{{3.489296892691613*^9, 3.4892968945173283`*^9}}],

Cell[BoxData["28"], "Output",
 CellChangeTimes->{3.489296894901493*^9, 3.4892971286469*^9, 
  3.489299751531309*^9, 3.489299899047667*^9, 3.4893007384745903`*^9, 
  3.489301217481509*^9, 3.489301275897027*^9}]
}, Open  ]],

Cell["gates per evolution step (the swaps add a lot of work).", "Text",
 CellChangeTimes->{{3.489296897117446*^9, 3.489296910027528*^9}}],

Cell["Let us see if it works by applying this 1000 times...", "Text",
 CellChangeTimes->{{3.489296871205886*^9, 3.489296878788549*^9}, {
   3.4892969297632427`*^9, 3.489296934667137*^9}, 3.4892971583206577`*^9, 
   3.489301740146902*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"error", "=", 
  RowBox[{"TEBDEvolve", "[", 
   RowBox[{"mytebd", ",", "U", ",", "1000", ",", 
    RowBox[{"Verbose", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.489296913480155*^9, 3.4892969374040403`*^9}, 
   3.489297160621194*^9, 3.489299756859661*^9, {3.489299830473275*^9, 
   3.489299830872786*^9}, {3.489299912750939*^9, 3.489299916158414*^9}, {
   3.489300137224627*^9, 3.4893001390630817`*^9}, {3.4893002807904673`*^9, 
   3.4893002890664597`*^9}}],

Cell[BoxData[
 RowBox[{"-", "176.82275084529488`"}]], "Output",
 CellChangeTimes->{
  3.4892999170313873`*^9, 3.4893001395844917`*^9, {3.489300214712162*^9, 
   3.489300240440283*^9}, 3.489300637444323*^9, 3.489300679829383*^9, 
   3.4893007435980473`*^9, 3.4893008534772463`*^9, 3.4893012502426443`*^9, 
   3.489301371124634*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"TEBDExpectationList", "[", 
   RowBox[{"mytebd", ",", "1", ",", "10", ",", "Z", ",", "Z"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4892971641424913`*^9, 3.489297171140254*^9}, 
   3.489297349014318*^9, {3.4892974058722267`*^9, 3.4892974280526323`*^9}, {
   3.4893014343759947`*^9, 3.489301435421694*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], 
   PointBox[{{1., -0.9446467259668619}, {2., 0.9428750959656944}, {
    3., -0.9427678495476954}, {4., 0.9427644900664437}, {
    5., -0.9427597415059967}, {6., 0.9427519971173002}, {
    7., -0.9426014954142589}, {8., 0.9406022650917247}, {
    9., -0.9100057140182654}}]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.4892974217595387`*^9, 3.489297428474471*^9}, {
   3.489299793243491*^9, 3.489299832746026*^9}, 3.489299918940604*^9, 
   3.489300245169269*^9, 3.489300853718211*^9, {3.489301417783581*^9, 
   3.4893014358320513`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"TEBDEntropyList", "[", "mytebd", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.489301195876363*^9, 3.489301196957211*^9}, {
  3.489301673766898*^9, 3.489301728675927*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], 
   PointBox[{{1., 0.10453347898066422`}, {2., 0.10947461188684142`}, {3., 
    0.10994639837139174`}, {4., 0.11001434929449537`}, {5., 
    0.10999993100122048`}, {6., 0.11001435070557622`}, {7., 
    0.10994639418764833`}, {8., 0.10947457158109639`}, {9., 
    0.10453332474706882`}}]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.489301674256071*^9, 3.489301688137817*^9}, 
   3.48930172907226*^9}]
}, Open  ]],

Cell["\<\
Overlaps can be calculated by the expectation value of Identity...maybe I \
will improve this later\
\>", "Text",
 CellChangeTimes->{{3.4893017361170177`*^9, 3.48930176378575*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TEBDExpectation", "[", 
  RowBox[{"mytebd", ",", "1", ",", "Id"}], "]"}]], "Input",
 CellChangeTimes->{{3.489301771226988*^9, 3.489301784203162*^9}}],

Cell[BoxData["1.0000000000000004`"], "Output",
 CellChangeTimes->{3.4893017850754337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["IsLinkActive"], "Input",
 CellChangeTimes->{{3.489305725019937*^9, 3.489305747012034*^9}}],

Cell[BoxData["IsLinkActive"], "Output",
 CellChangeTimes->{{3.48930574431565*^9, 3.489305747456971*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{748, 785},
WindowMargins->{{Automatic, 118}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3489308414-8469528"->{
  Cell[25783, 614, 277, 5, 60, "Print",
   CellTags->"Info3489308414-8469528"]},
 "Info3489308415-5731344"->{
  Cell[27483, 667, 382, 6, 130, "Print",
   CellTags->"Info3489308415-5731344"]},
 "Info3489308416-9597017"->{
  Cell[33967, 843, 605, 9, 168, "Print",
   CellTags->"Info3489308416-9597017"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3489308414-8469528", 49955, 1276},
 {"Info3489308415-5731344", 50065, 1279},
 {"Info3489308416-9597017", 50176, 1282}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 99, 1, 76, "Title"],
Cell[CellGroupData[{
Cell[691, 27, 119, 1, 67, "Section"],
Cell[813, 30, 143, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[981, 35, 174, 3, 27, "Input"],
Cell[1158, 40, 812, 11, 27, "Output"]
}, Open  ]],
Cell[1985, 54, 97, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[2107, 59, 216, 4, 27, "Input"],
Cell[2326, 65, 1677, 26, 591, "Print"]
}, Open  ]],
Cell[4018, 94, 114, 1, 26, "Text"],
Cell[4135, 97, 1148, 31, 103, "Input"],
Cell[5286, 130, 114, 1, 26, "Text"],
Cell[5403, 133, 250, 6, 27, "Input"],
Cell[5656, 141, 140, 1, 26, "Text"],
Cell[5799, 144, 128, 3, 27, "Input"],
Cell[5930, 149, 123, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[6078, 154, 177, 4, 27, "Input"],
Cell[6258, 160, 2538, 52, 103, "Output"]
}, Open  ]],
Cell[8811, 215, 222, 5, 26, "Text"],
Cell[9036, 222, 1503, 38, 133, "Input"],
Cell[10542, 262, 114, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[10681, 267, 735, 15, 43, "Input"],
Cell[11419, 284, 867, 15, 59, "Message"],
Cell[12289, 301, 90, 1, 20, "Print"],
Cell[12382, 304, 972, 16, 77, "Message"],
Cell[13357, 322, 978, 16, 77, "Message"],
Cell[14338, 340, 834, 14, 41, "Message"],
Cell[15175, 356, 91, 1, 20, "Print"],
Cell[15269, 359, 865, 15, 59, "Message"],
Cell[16137, 376, 90, 1, 20, "Print"],
Cell[16230, 379, 973, 16, 77, "Message"],
Cell[17206, 397, 633, 11, 23, "Message"],
Cell[17842, 410, 832, 14, 41, "Message"],
Cell[18677, 426, 91, 1, 20, "Print"],
Cell[18771, 429, 865, 15, 59, "Message"],
Cell[19639, 446, 626, 11, 23, "Message"],
Cell[20268, 459, 90, 1, 20, "Print"],
Cell[20361, 462, 835, 14, 41, "Message"],
Cell[21199, 478, 628, 11, 23, "Message"],
Cell[CellGroupData[{
Cell[21852, 493, 91, 1, 20, "Print"],
Cell[21946, 496, 90, 1, 20, "Print"],
Cell[22039, 499, 91, 1, 20, "Print"],
Cell[22133, 502, 90, 1, 20, "Print"],
Cell[22226, 505, 93, 1, 20, "Print"],
Cell[22322, 508, 90, 1, 20, "Print"],
Cell[22415, 511, 91, 1, 20, "Print"],
Cell[22509, 514, 90, 1, 20, "Print"],
Cell[22602, 517, 93, 1, 20, "Print"],
Cell[22698, 520, 90, 1, 20, "Print"],
Cell[22791, 523, 91, 1, 20, "Print"],
Cell[22885, 526, 90, 1, 20, "Print"],
Cell[22978, 529, 91, 1, 20, "Print"],
Cell[23072, 532, 88, 1, 20, "Print"],
Cell[23163, 535, 91, 1, 20, "Print"],
Cell[23257, 538, 92, 1, 20, "Print"],
Cell[23352, 541, 90, 1, 20, "Print"],
Cell[23445, 544, 90, 1, 20, "Print"],
Cell[23538, 547, 93, 1, 20, "Print"],
Cell[23634, 550, 90, 1, 20, "Print"]
}, Open  ]],
Cell[23739, 554, 467, 7, 27, "Output"]
}, Open  ]],
Cell[24221, 564, 104, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[24350, 569, 177, 4, 27, "Input"],
Cell[24530, 575, 832, 23, 43, "Output"]
}, Open  ]],
Cell[25377, 601, 256, 5, 26, "Text"],
Cell[CellGroupData[{
Cell[25658, 610, 122, 2, 27, "Input"],
Cell[25783, 614, 277, 5, 60, "Print",
 CellTags->"Info3489308414-8469528"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26097, 624, 181, 4, 27, "Input"],
Cell[26281, 630, 186, 2, 20, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26504, 637, 430, 10, 43, "Input"],
Cell[26937, 649, 232, 5, 27, "Output"]
}, Open  ]],
Cell[27184, 657, 98, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[27307, 662, 173, 3, 27, "Input"],
Cell[27483, 667, 382, 6, 130, "Print",
 CellTags->"Info3489308415-5731344"]
}, Open  ]],
Cell[27880, 676, 129, 1, 26, "Text"],
Cell[28012, 679, 1150, 40, 73, "Input"],
Cell[CellGroupData[{
Cell[29187, 723, 266, 5, 27, "Input"],
Cell[29456, 730, 199, 3, 27, "Output"]
}, Open  ]],
Cell[29670, 736, 171, 2, 26, "Text"],
Cell[CellGroupData[{
Cell[29866, 742, 278, 6, 27, "Input"],
Cell[30147, 750, 2238, 42, 229, 490, 12, "CachedBoxData", "BoxData", \
"Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32434, 798, 101, 1, 67, "Section"],
Cell[32538, 801, 123, 1, 26, "Text"],
Cell[32664, 804, 1148, 31, 103, "Input"],
Cell[CellGroupData[{
Cell[33837, 839, 127, 2, 27, "Input"],
Cell[33967, 843, 605, 9, 168, "Print",
 CellTags->"Info3489308416-9597017"]
}, Open  ]],
Cell[34587, 855, 326, 7, 27, "Input"],
Cell[34916, 864, 611, 9, 71, "Text"],
Cell[35530, 875, 311, 6, 41, "Text"],
Cell[35844, 883, 174, 4, 27, "Input"],
Cell[36021, 889, 385, 10, 43, "Input"],
Cell[36409, 901, 275, 5, 26, "Text"],
Cell[36687, 908, 581, 13, 58, "Input"],
Cell[37271, 923, 100, 1, 26, "Text"],
Cell[37374, 926, 534, 12, 58, "Input"],
Cell[37911, 940, 248, 4, 41, "Text"],
Cell[CellGroupData[{
Cell[38184, 948, 582, 15, 43, "Input"],
Cell[38769, 965, 804, 21, 89, "Output"]
}, Open  ]],
Cell[39588, 989, 371, 8, 58, "Input"],
Cell[39962, 999, 106, 1, 26, "Text"],
Cell[40071, 1002, 355, 9, 27, "Input"],
Cell[40429, 1013, 117, 1, 26, "Text"],
Cell[40549, 1016, 450, 10, 58, "Input"],
Cell[41002, 1028, 229, 3, 26, "Text"],
Cell[41234, 1033, 573, 13, 58, "Input"],
Cell[41810, 1048, 245, 5, 26, "Text"],
Cell[42058, 1055, 2072, 53, 223, "Input"],
Cell[44133, 1110, 1020, 26, 118, "Input"],
Cell[45156, 1138, 100, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[45281, 1143, 127, 2, 27, "Input"],
Cell[45411, 1147, 209, 3, 27, "Output"]
}, Open  ]],
Cell[45635, 1153, 137, 1, 26, "Text"],
Cell[45775, 1156, 237, 3, 26, "Text"],
Cell[CellGroupData[{
Cell[46037, 1163, 500, 9, 27, "Input"],
Cell[46540, 1174, 330, 6, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46907, 1185, 366, 7, 27, "Input"],
Cell[47276, 1194, 705, 15, 247, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48018, 1214, 223, 4, 27, "Input"],
Cell[48244, 1220, 569, 13, 238, "Output"]
}, Open  ]],
Cell[48828, 1236, 190, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[49043, 1244, 173, 3, 27, "Input"],
Cell[49219, 1249, 90, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49346, 1255, 104, 1, 27, "Input"],
Cell[49453, 1258, 104, 1, 27, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)
\)\\)}\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" exceeds the levels, \\\
\\\\\"\\\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(1\\), \\\"MT\\\"]\
\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\", which can be flattened together \
in \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\(\\({\\(\\({\\(\\({\\(\\(\\(\
\\(-0.5531388757300928`\\)\\) + \\(\\(0.2250787955345641`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5531388739243515` \
\[InvisibleSpace]\\)\\) - \\(\\(0.22507878908137938`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\({\\(\\(\\(\\(-0.14955571305755813`\\)\
\\) - \\(\\(0.3475192231844429`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.1495556954145716`\\)\\) - \\(\\(0.34751923048427086`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\
\\), \\(\\({\\(\\(7.219091538808083`*^-8 + \\(\\(1.55846335273272`*^-8\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(7.390581449630305`*^-8 + \
\\(\\(1.5619067394599653`*^-8\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\), \
\\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\), \\(\\(\[LeftSkeleton] \
4 \[RightSkeleton]\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\
\\), \\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\)}\\)\\) . \
\\(\\({\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)}\\)\\) . \
\\(\\({\\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\), \\(\\({\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\)}\\)\\)\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\".\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Flatten\\\", ButtonNote -> \
\\\"Flatten::fldep\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.489237719078973*^9, 3.4892378471129007`*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{278., {3., 8.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "}"}], ".", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
           "1.`", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "1.0000000000000004`", ",", "0", ",", 
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0.9999999999999993`", ",", "0", ",", "0", ",", "0", ",", 
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
            "0.9999999999999987`", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", 
            "0.9999999999999998`", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "1.000000000000001`",
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
            "0", ",", "0", ",", "1.000000000000002`", ",", "0", ",", "0", ",",
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
            "1.0000000000000004`"}], "}"}]}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{49., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 37, 22867113457526894742, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{52., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 37, 22867113457526894742, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{82., {2., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 37, 22867113457526894742, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{74., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->{Deployed -> True}],
  Out[37]]], "Output",
 CellChangeTimes->{3.489237719307809*^9, 3.489237847230175*^9}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{748, 785},
WindowMargins->{{Automatic, 163}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3489244796-1930353"->{
  Cell[8035, 214, 279, 5, 60, "Print",
   CellTags->"Info3489244796-1930353"]},
 "Info3489244890-7984606"->{
  Cell[9599, 265, 382, 6, 130, "Print",
   CellTags->"Info3489244890-7984606"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3489244796-1930353", 27457, 641},
 {"Info3489244890-7984606", 27566, 644}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 143, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[713, 25, 174, 3, 27, "Input"],
Cell[890, 30, 630, 8, 27, "Output"]
}, Open  ]],
Cell[1535, 41, 97, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[1657, 46, 243, 5, 27, "Input",
 InitializationCell->True],
Cell[1903, 53, 1017, 16, 561, "Print"]
}, Open  ]],
Cell[2935, 72, 114, 1, 26, "Text"],
Cell[3052, 75, 1148, 31, 103, "Input"],
Cell[4203, 108, 114, 1, 26, "Text"],
Cell[4320, 111, 250, 6, 27, "Input"],
Cell[4573, 119, 140, 1, 26, "Text"],
Cell[4716, 122, 128, 3, 27, "Input"],
Cell[4847, 127, 222, 5, 26, "Text"],
Cell[5072, 134, 1503, 38, 133, "Input"],
Cell[6578, 174, 114, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[6717, 179, 629, 13, 43, "Input"],
Cell[7349, 194, 389, 8, 27, "Output"]
}, Open  ]],
Cell[7753, 205, 132, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[7910, 210, 122, 2, 27, "Input"],
Cell[8035, 214, 279, 5, 60, "Print",
 CellTags->"Info3489244796-1930353"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8351, 224, 181, 4, 27, "Input"],
Cell[8535, 230, 117, 1, 20, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8689, 236, 430, 10, 43, "Input"],
Cell[9122, 248, 163, 4, 27, "Output"]
}, Open  ]],
Cell[9300, 255, 98, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[9423, 260, 173, 3, 27, "Input"],
Cell[9599, 265, 382, 6, 130, "Print",
 CellTags->"Info3489244890-7984606"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10018, 276, 487, 12, 27, "Input"],
Cell[10508, 290, 880, 16, 23, "Message"],
Cell[11391, 308, 2413, 37, 115, "Message"],
Cell[13807, 347, 882, 16, 23, "Message"],
Cell[14692, 365, 1778, 29, 104, "Message"],
Cell[16473, 396, 650, 11, 23, "Message"],
Cell[17126, 409, 2205, 34, 115, "Message"],
Cell[19334, 445, 2205, 34, 115, "Message"],
Cell[21542, 481, 5541, 145, 137, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
