(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[     52035,       1383]
NotebookOptionsPosition[     47050,       1222]
NotebookOutlinePosition[     47902,       1253]
CellTagsIndexPosition[     47732,       1246]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[RawData[""], "Title"],

Cell[RawData[""], "Section"],

Cell[RawData[""], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.4742833947087593`*^9, 3.4742833971097183`*^9}}],

Cell[BoxData["\<\"/ICFO/home/fcucchietti/Code/MathMPS\"\>"], "Output",
 CellChangeTimes->{
  3.47428339993287*^9, 3.4742834900929127`*^9, 3.4742839068114157`*^9, 
   3.4742861595526752`*^9, 3.474286276253614*^9, 3.47429022395389*^9, 
   3.474290358882016*^9, 3.4742905428907433`*^9, 3.474291254839636*^9, 
   3.474291384203182*^9, 3.474291504371645*^9, 3.4742919670093822`*^9, 
   3.474292932942101*^9, 3.4743056200856457`*^9, 3.474352808709919*^9, 
   3.474367971530735*^9, 3.47437037146124*^9, 3.4892340440393333`*^9, 
   3.4892361947511463`*^9, 3.489236574298616*^9, 3.489236826405078*^9, 
   3.4892374111952953`*^9, 3.4892375557086782`*^9, 3.489294204443529*^9, 
   3.4892953240856857`*^9, 3.4892961744909363`*^9, 3.4893006961774607`*^9, {
   3.4893012132077303`*^9, 3.489301214363079*^9}, 3.489306964260322*^9, 
   3.489314781065288*^9}]
}, Open  ]],

Cell["Load the library", "Text",
 CellChangeTimes->{{3.489233993386242*^9, 3.48923399543499*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "MPS.m"}]], "Input",
 CellChangeTimes->{{3.474265959754241*^9, 3.4742659727833023`*^9}, {
  3.474266006004148*^9, 3.474266006093193*^9}, {3.47426605128262*^9, 
  3.4742660515198603`*^9}}],

Cell[BoxData["\<\"MPS manipulation from Mathematica.\\nMPS Manipulation and \
creation:\\n\\tMPSProductState\\n\\tMPSExpandBond\\n\\tMPSNormalize\\n\\\
tMPSCanonize\\nReading and saving to \
disk:\\n\\tMPSRead\\n\\tMPSSave\\nExpectation \
values:\\n\\tMPSExpectation\\n\\tMPSCorrelation\\nAlgorithms:\\n\\\
tMPSApproximate\\n\\tMPSMinimizeEnergy\\nHamiltonian \
Creation:\\n\\tMPSInitHamiltonian\\n\\tMPSHamiltonianAdd\\n\\nAlso available \
are TEBD algorithms:\\n\\nCreation and disk \
interaction:\\n\\tTEBDProductState\\n\\tTEBDRead\\n\\tTEBDSave\\nReal and \
imaginary time evolution:\\n\\tTEBDEvolve\\nExpectation \
values:\\n\\tTEBDExpectation\\n\\tTEBDExpectationList\\n\\tTEBDentropy\\n\\\
tTEBDentropyList\\nHamiltonians and evolution \
operators:\\n\\tTEBDInitHamiltonian\\n\\tTEBDHamiltonianAdd\\n\\\
tTEBDEvolutionFromHamiltonian\\n\\tTEBDInitEvolution\\n\\\
tTEBDEvolutionAddGate\\n\"\>"], "Print",
 CellChangeTimes->{
  3.489236196025882*^9, 3.4892365756257143`*^9, {3.489236827698267*^9, 
   3.48923683143458*^9}, 3.489237413811884*^9, 3.4892375576998568`*^9, 
   3.4892942059936647`*^9, 3.489295325654924*^9, 3.489296101094775*^9, 
   3.489296176290408*^9, 3.489296488886742*^9, 3.489297152106338*^9, {
   3.489297239596204*^9, 3.489297248436446*^9}, 3.4892973410652533`*^9, 
   3.489297398965304*^9, 3.489300126529524*^9, {3.489300193562796*^9, 
   3.4893002285150557`*^9}, 3.4893006321721497`*^9, 3.4893006963381453`*^9, 
   3.489300772297621*^9, 3.48930112848275*^9, 3.489301182447118*^9, 
   3.489301214494012*^9, 3.48930171595041*^9, 3.489305181587626*^9, 
   3.489305331842105*^9, 3.4893054241466093`*^9, {3.489306965912939*^9, 
   3.489306988462085*^9}, 3.4893147829275093`*^9, 3.489315849138592*^9, 
   3.489315916913335*^9, 3.489315970145665*^9, 3.489317355992989*^9, 
   3.489317556871387*^9, 3.489317601126111*^9, 3.489317651608889*^9, 
   3.489317774188841*^9, {3.489317854085724*^9, 3.48931787791356*^9}, 
   3.4893179948293667`*^9, 3.489318339032361*^9, 3.489318833377974*^9}]
}, Open  ]],

Cell["Set some simulation parameters", "Text",
 CellChangeTimes->{{3.4892339979539213`*^9, 3.489234002561816*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bond", "=", "6"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "will", " ", "be", " ", "the", " ", "Bond", " ", 
     "Dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"length", "=", "10"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Length", " ", "of", " ", "the", " ", "chain"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"intrange", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Interaction", " ", "range"}], ",", " ", 
    RowBox[{"1", " ", "is", " ", "nearest", " ", "neighbor"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Mu]Field", " ", "=", " ", "0.10"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Magnetic", " ", "field"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"JCoupling", "=", 
   RowBox[{"-", "1.0"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Spin", "-", 
    RowBox[{"spin", " ", "coupling"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4892340060049553`*^9, 3.4892341413757877`*^9}, {
   3.489236204244766*^9, 3.489236231113943*^9}, 3.489316328904992*^9, 
   3.489318423960681*^9, {3.489318464713283*^9, 3.489318464978002*^9}, {
   3.489318501515135*^9, 3.489318509713661*^9}, {3.489318554409346*^9, 
   3.4893185578942127`*^9}, {3.489318689555035*^9, 3.489318696826315*^9}}],

Cell["We start by creating a random MPS.", "Text",
 CellChangeTimes->{{3.48923415927713*^9, 3.48923417481992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mymps", "=", 
   RowBox[{"MPSProductState", "[", 
    RowBox[{"length", ",", 
     RowBox[{"Bond", "\[Rule]", "bond"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4892341774480467`*^9, 3.489234178310319*^9}}],

Cell["Normalization typically is optional, but it's a good habit", "Text",
 CellChangeTimes->{{3.489234181844184*^9, 3.489234196603504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MPSNormalize", "[", "mymps", "]"}], ";"}]], "Input",
 CellChangeTimes->{3.48923419903065*^9}],

Cell["The MPS is a nasty collection of matrices", "Text",
 CellChangeTimes->{{3.489294224545177*^9, 3.489294234144956*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mymps", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Normal"}]], "Input",
 CellChangeTimes->{{3.489294236743082*^9, 3.489294251821848*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.016136638659417325`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.0832833857037442`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.15531408911248024`"}], "-", 
       RowBox[{"0.09275264118836797`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.2549513922956283`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.04912361512888027`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.02344785668996839`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.12673484533959392`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.18727316314834397`"}], "-", 
       RowBox[{"0.0880815350615268`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.17470922829999794`"}], "+", 
       RowBox[{"0.01751922236272066`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.18595173900752718`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.18075581818659914`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.17776058548762988`"}], "+", 
       RowBox[{"0.03842215312129731`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.1888476598594779`"}], "-", 
       RowBox[{"0.07871327303597914`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.19374836728926478`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.05594095644015634`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.06205248146897906`"}], "+", 
       RowBox[{"0.11347973422097814`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.07550838816170895`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.2480613092751253`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.13755080797777589`"}], "+", 
       RowBox[{"0.17287746415760363`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.07886930228419069`"}], "-", 
       RowBox[{"0.1179210622078022`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.09523634694679908`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.018616227239479453`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.14262186690599013`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.003003054553415631`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.1997448713861289`"}], "+", 
       RowBox[{"0.14321095187674104`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.1342233182839185`"}], "+", 
       RowBox[{"0.12552079656919463`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.14268966540100234`"}], "+", 
       RowBox[{"0.13487857761036845`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.16404622758930829`"}], "-", 
       RowBox[{"0.07806755667981596`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.15962717887689776`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.19531815161759208`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.15754392823685312`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.11524288255877983`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.019902359567041287`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.054927990276975654`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.17528196260183015`"}], "-", 
       RowBox[{"0.15326852452104958`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.12165976599172657`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.11487313399341957`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.07489887691428096`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.1854358397414512`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.057471891283450045`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.016516558148898595`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.14008356196264446`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.13464040290154208`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.17017871383871733`"}], "-", 
       RowBox[{"0.0025529196570468174`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.09075928451172621`"}], "-", 
       RowBox[{"0.14805898104889567`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.190293555396486`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.13374128856959516`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.0391374036250447`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.04537470467600546`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.02203656328033495`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.14674494035196686`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.07120038727408516`"}], "-", 
       RowBox[{"0.21361481953746078`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.24234516290515615`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.05175737965820289`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.20487197220523665`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.09221707964010264`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.0001379154700390596`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.10207409380363251`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.08779444667626012`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.17131052395959548`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.17027814116702494`"}], "+", 
       RowBox[{"0.057265289305735545`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.18644136991343166`"}], "-", 
       RowBox[{"0.055321220355091134`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.489294240357108*^9, 3.489294252296864*^9}, 
   3.4892953333443336`*^9, 3.489301214611249*^9, 3.489305187407249*^9, 
   3.489305435356701*^9, {3.489314790327855*^9, 3.489314814496211*^9}, 
   3.4893174936231813`*^9, 3.489317608185361*^9, 3.489318517316936*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "mymps", "]"}]], "Input",
 CellChangeTimes->{{3.48931749512458*^9, 3.4893174993242483`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.489317499801671*^9}]
}, Open  ]],

Cell["\<\
Now we need to create the Hamiltonian. For readability we define the axes \
names\
\>", "Text",
 CellChangeTimes->{{3.4892342050516043`*^9, 3.489234212219406*^9}, {
  3.489236295870122*^9, 3.489236303389817*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Xaxis", "=", "1"}], ";", " ", 
  RowBox[{"Yaxis", "=", "2"}], ";", 
  RowBox[{"Zaxis", "=", "3"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyHamiltonian", "=", 
   RowBox[{"MPSInitHamiltonian", "[", "length", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Add", " ", "field", " ", "terms"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", "m"}], ",", 
      RowBox[{"MPSHamiltonianAdd", "[", 
       RowBox[{"MyHamiltonian", ",", "Xaxis", ",", "\[Mu]Field", ",", "n"}], 
       "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Add", " ", "nearest", " ", "neighborg", " ", "interaction"}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"n", "\[Equal]", 
       RowBox[{"m", "+", "1"}]}], ",", 
      RowBox[{"MPSHamiltonianAdd", "[", 
       RowBox[{
       "MyHamiltonian", ",", "Zaxis", ",", "JCoupling", ",", "n", ",", "m"}], 
       "]"}]}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"n", ",", "1", ",", "length"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"m", ",", "1", ",", "length"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.489236147788294*^9, 3.489236192466975*^9}, {
  3.489236241689937*^9, 3.489236407775688*^9}, {3.489237433345026*^9, 
  3.489237435358623*^9}}],

Cell["Finally compute the ground state", "Text",
 CellChangeTimes->{{3.489236418981338*^9, 3.489236428350278*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"energy", "=", 
  RowBox[{"MPSMinimizeEnergy", "[", 
   RowBox[{"mymps", ",", "MyHamiltonian", ",", 
    RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
    RowBox[{"Tolerance", "\[Rule]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "7"}], ")"}]}]}], ",", 
    RowBox[{"Sweeps", "\[Rule]", "6"}], ",", 
    RowBox[{"MonitorEnergy", "\[Rule]", "True"}], ",", 
    RowBox[{"Debug", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.489236455774604*^9, 3.489236459796526*^9}, {
   3.4892365900807858`*^9, 3.4892365995418043`*^9}, {3.489236849546856*^9, 
   3.4892368575343924`*^9}, {3.4892368964642467`*^9, 3.48923689659702*^9}, {
   3.489237510546959*^9, 3.4892375111441803`*^9}, {3.4893051941262493`*^9, 
   3.48930520588696*^9}, {3.489314819894567*^9, 3.4893148238394423`*^9}, 
   3.489318530333214*^9, {3.489318675575572*^9, 3.489318678903036*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{377., {3., 10.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "0.6929705378500249`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "0.8622823826257373`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "1.0390148696331993`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "1.1845708842583704`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "1.663762411850534`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{"\[LeftSkeleton]", "30", "\[RightSkeleton]"}], ",", 
             RowBox[{
              RowBox[{"-", "2.280088542510521`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "2.280088535991273`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "2.2800885425434596`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "2.280088542543456`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
             RowBox[{
              RowBox[{"-", "2.280088542543457`"}], "+", 
              RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "}"}]}], 
          "}"}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{68., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 197, 22867619595434273614, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{71., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 197, 22867619595434273614, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{110., {3., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 197, 22867619595434273614, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{101., {0., 10.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->{Deployed -> True}],
  Out[197]]], "Output",
 CellChangeTimes->{
  3.489236613331408*^9, 3.4892368461353083`*^9, {3.489236891659401*^9, 
   3.4892369008576517`*^9}, 3.489236982668428*^9, 3.48923713496948*^9, 
   3.4892374417669783`*^9, {3.4892375050135193`*^9, 3.489237515613399*^9}, 
   3.489237566015382*^9, 3.4892942600120907`*^9, 3.489295336663473*^9, 
   3.489301214906769*^9, 3.4893052079162827`*^9, 3.489305335669949*^9, 
   3.489305367137938*^9, 3.489305451522265*^9, 3.4893147956245604`*^9, 
   3.489314827819158*^9, 3.489315859582527*^9, 3.48931592663486*^9, 
   3.489315979450296*^9, 3.489316340151658*^9, 3.489317365110977*^9, 
   3.489317564074239*^9, 3.489317614231374*^9, 3.489317661272704*^9, 
   3.489317783437851*^9, {3.48931783712084*^9, 3.489317883860524*^9}, 
   3.489318000795809*^9, 3.489318059968402*^9, 3.4893183504495687`*^9, 
   3.489318431012376*^9, 3.489318473261004*^9, 3.489318525492365*^9, 
   3.489318566723858*^9, {3.48931868466405*^9, 3.489318705074954*^9}, 
   3.489318841368781*^9}]
}, Open  ]],

Cell["The state has changed.", "Text",
 CellChangeTimes->{{3.489294270868896*^9, 3.489294274215707*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mymps", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "Normal"}]], "Input",
 CellChangeTimes->{{3.489294261633889*^9, 3.489294265817164*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.08146729006672038`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.6223168742744813`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.04227748964194811`"}], "-", 
       RowBox[{"0.3229510844791508`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.08146728993747587`"}], "-", 
       RowBox[{"0.6223168732921847`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.04227748970749942`"}], "-", 
       RowBox[{"0.3229510849894366`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4892942661840467`*^9, 3.489295338059111*^9, 
  3.4893012149427547`*^9}]
}, Open  ]],

Cell["\<\
Now improve precision by making a larger bond MPS. You can ask for help on \
specific commands like in Mathematica\
\>", "Text",
 CellChangeTimes->{{3.4892375726617613`*^9, 3.48923758221214*^9}, {
  3.489294281767747*^9, 3.4892942941909323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MPSExpandBond"}]], "Input",
 CellChangeTimes->{{3.489237583933896*^9, 3.489237596396716*^9}}],

Cell[BoxData[
 StyleBox["\<\"MPSExpandBond[mps,new\[Chi]] expands the bond dimension \[Chi] \
of mps to new\[Chi]. Returns the expanded mps as a new variable\"\>", 
  "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.489301215226935*^9},
 CellTags->"Info3489308414-8469528"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MPSExpandBond", "[", 
   RowBox[{"mymps", ",", "15"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.489237598777522*^9, 3.4892376127488194`*^9}}],

Cell[BoxData["\<\"Grow \[Chi] to 15\"\>"], "Print",
 CellChangeTimes->{{3.489237607961445*^9, 3.489237613125641*^9}, 
   3.489294302148835*^9, 3.489295341378667*^9, 3.48930121558326*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Newenergy", "=", 
  RowBox[{"MPSMinimizeEnergy", "[", 
   RowBox[{"mymps", ",", "MyHamiltonian", ",", 
    RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
    RowBox[{"Tolerance", "\[Rule]", 
     RowBox[{"10", "^", 
      RowBox[{"(", 
       RowBox[{"-", "5"}], ")"}]}]}], ",", 
    RowBox[{"Sweeps", "\[Rule]", "5"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.489237621470517*^9, 3.489237628308235*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2.5289174665369405`"}], "+", 
  RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{3.4892376321327*^9, 3.489294304058454*^9, 
  3.489295342592107*^9, 3.489301215901973*^9}]
}, Open  ]],

Cell["Measure something", "Text",
 CellChangeTimes->{{3.48923764396305*^9, 3.489237647121537*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "MPSExpectation"}]], "Input",
 CellChangeTimes->{{3.489237649056497*^9, 3.4892376537781982`*^9}, {
  3.48923768575609*^9, 3.489237689801693*^9}}],

Cell[BoxData[
 StyleBox["\<\"\\nMPSExpectation[mps,operator,site]\\nMPSExpectation[mps,\
operator,site1,site2]\\nMPSExpectation[mps,operator1,site1,operator2,site2]\\\
n\\nComputes the expectation value of one or two Hermitian operators acting \
on one or two sites\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.489301216275836*^9},
 CellTags->"Info3489308415-5731344"]
}, Open  ]],

Cell["Let us define some operators to make it clean", "Text",
 CellChangeTimes->{{3.4892944137792253`*^9, 3.489294420258649*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"X", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", "1.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.0", ",", "0.0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Y", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0.0", ",", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "1.0"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"I", " ", "1.0"}], ",", "0.0"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.0", ",", "0.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", 
       RowBox[{"-", "1.0"}]}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Id", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1.0", ",", "0.0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.0", ",", "1.0"}], "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.489294422863744*^9, 3.489294457796294*^9}, {
  3.489301656712947*^9, 3.489301660248805*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSExpectation", "[", 
  RowBox[{"mymps", ",", "X", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.48923769206278*^9, 3.489237718184559*^9}, {
  3.489237840593968*^9, 3.48923784646985*^9}, {3.489294902111092*^9, 
  3.489294906156665*^9}}],

Cell[BoxData[
 RowBox[{"-", "0.32402135476900046`"}]], "Output",
 CellChangeTimes->{3.489237719307809*^9, 3.489237847230175*^9, 
  3.4892949068259497`*^9, 3.489295347970153*^9, 3.489301216701922*^9, 
  3.489318441049747*^9, 3.489318537678443*^9}]
}, Open  ]],

Cell["A correlation can be directly plotted", "Text",
 CellChangeTimes->{{3.48929491193437*^9, 3.4892949256906347`*^9}, {
  3.489295011818145*^9, 3.4892950150560293`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"ListPlot", "[", 
  RowBox[{"MPSCorrelation", "[", 
   RowBox[{"mymps", ",", "Z", ",", "1", ",", "Z", ",", "10"}], "]"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"MPSCorrelation", "[", 
   RowBox[{"mymps", ",", "X", ",", "1", ",", "X", ",", "10"}], "]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.489294986554552*^9, 3.489295019233067*^9}, {
  3.48930144348917*^9, 3.489301444845552*^9}, {3.489318450290427*^9, 
  3.48931845603376*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], 
   PointBox[{{1., 0.7875265282477508}, {2., 0.7602954332798708}, {3., 
    0.7530958153584475}, {4., 0.7501483153766377}, {5., 0.7480094913441924}, {
    6., 0.7449513556750849}, {7., 0.7377013104217642}, {8., 
    0.715319839469057}, {9., 0.6310239864776502}}]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, Automatic},
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.489295000137792*^9, 3.489295019956675*^9}, 
   3.4892953497553673`*^9, 3.4893012167698727`*^9, 3.489301445181386*^9, {
   3.4893184425885773`*^9, 3.489318478943821*^9}, 3.48931853972955*^9}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], 
   PointBox[{{1., 0.35245981483602895`}, {2., 0.21173783151454942`}, {3., 
    0.1934571113584555}, {4., 0.18916680546395107`}, {5., 
    0.18835987981484575`}, {6., 0.18966991479798928`}, {7., 
    0.19556101561771494`}, {8., 0.21816505239228967`}, {9., 
    0.3321494935162803}}]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, Automatic},
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.489295000137792*^9, 3.489295019956675*^9}, 
   3.4892953497553673`*^9, 3.4893012167698727`*^9, 3.489301445181386*^9, {
   3.4893184425885773`*^9, 3.489318478943821*^9}, 3.489318539776326*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["TEBD Example", "Section",
 CellChangeTimes->{{3.4892951054221153`*^9, 3.4892951080206547`*^9}}],

Cell["We will use the same parameters as above", "Text",
 CellChangeTimes->{{3.4892952215547047`*^9, 3.48929522931316*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"bond", "=", "8"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "This", " ", "will", " ", "be", " ", "the", " ", "Bond", " ", 
     "Dimension"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"length", "=", "10"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Length", " ", "of", " ", "the", " ", "chain"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"intrange", "=", "1"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Interaction", " ", "range"}], ",", " ", 
    RowBox[{"1", " ", "is", " ", "nearest", " ", "neighbor"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Mu]Field", " ", "=", " ", "0.3"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Magnetic", " ", "field"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JCoupling", "=", "1.0"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Spin", "-", 
    RowBox[{"spin", " ", "coupling"}]}], " ", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.4892340060049553`*^9, 3.4892341413757877`*^9}, {
  3.489236204244766*^9, 3.489236231113943*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"?", "TEBDProductState"}]], "Input",
 CellChangeTimes->{{3.4892952800409937`*^9, 3.489295280264814*^9}}],

Cell[BoxData[
 StyleBox["\<\"TEBDProductState[numSites,Options]\\nCreates a TEBD \
representation state. \\nOptions:\\n\tSpin\[Rule]integer (Default is 2)\\n\t\
BondDimension\[Rule]integer   (default is 20)\\n\tType\[Rule]{type,list}     \
(Creates several types of TEBDs: type=\\\"Random\\\" , \\\"Identity\\\", or \
\\\"Specified\\\".\\n\t\t\t\t\t\tIf Specified is chosen, then list must be a \
Table of dimensions {numSites,2}, containing in each element a pair \
{probAmplitude,phase}\"\>", "MSG"]], "Print", "PrintUsage",
 CellChangeTimes->{3.489301217002061*^9},
 CellTags->"Info3489308416-9597017"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"mytebd", "=", 
   RowBox[{"TEBDProductState", "[", 
    RowBox[{"10", ",", 
     RowBox[{"BondDimension", "\[Rule]", "15"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4892952045398808`*^9, 3.489295250153894*^9}, 
   3.48929550283377*^9, {3.489299693222336*^9, 3.489299705501548*^9}}],

Cell["\<\
To create the Hamiltonian we must keep in mind that the order in which the \
operators are added imposes the sequence in which they are implemented later \
in the evolution operator. In principle we can also create an evolution \
operator directly, which gives us even more control since we can do periodic \
boundary conditions or long range interactions. The control is primitive but \
powerful, however in the future I expect to come up with some algorithm that \
finds some optimal evolution operator automatically.\
\>", "Text",
 CellChangeTimes->{{3.489295534535015*^9, 3.4892956625311747`*^9}}],

Cell["\<\
For now, let us see how we can make the evolution operator with imaginary \
time of the same system but with periodic boundary conditions. We have to \
first initialize\
\>", "Text",
 CellChangeTimes->{{3.4892956684508867`*^9, 3.489295739080545*^9}, {
  3.4892960842809057`*^9, 3.489296093693654*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"U", "=", 
   RowBox[{"TEBDInitEvolution", "[", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.4892961899700813`*^9, 3.48929619824019*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Delta]t", "=", 
   RowBox[{
    RowBox[{"-", "I"}], " ", "0.01"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ZZ", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{"Z", ",", "Z"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.4892962354495373`*^9, 3.4892962456313877`*^9}, {
  3.4892962882348013`*^9, 3.4892963232638063`*^9}}],

Cell["\<\
We will do a Trotter-Suzuki evolution of second order. For this, we first add \
evolution gates to the odd bonds for a time \[Delta]t/2\
\>", "Text",
 CellChangeTimes->{{3.489296210963647*^9, 3.4892962517522907`*^9}, {
  3.489296384492824*^9, 3.48929641145214*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
       RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
     RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "9", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296257400681*^9, 3.489296275481769*^9}, {
  3.489296327472519*^9, 3.489296378775653*^9}}],

Cell["Now the even bonds", "Text",
 CellChangeTimes->{{3.489296505569009*^9, 3.489296508816763*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
       RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
     RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "2", ",", "8", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296521154668*^9, 3.4892965261865063`*^9}}],

Cell["\<\
The end-to-end coupling needs to be done by swapping the first and last spins \
until they are next to each other. For this, we add a bunch of swap operations\
\>", "Text",
 CellChangeTimes->{{3.489296535922002*^9, 3.489296576222486*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"SWAP", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.0", ",", "0.0", ",", "0.0", ",", "0.0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "0.0", ",", "1.0", ",", "0.0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "1.0", ",", "0.0", ",", "0.0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0.0", ",", "0.0", ",", "0.0", ",", "1.0"}], "}"}]}], "}"}]}], 
   ")"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.489296577936371*^9, 3.489296627342717*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "1.`", "0.`"},
     {"0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.4892966279074993`*^9, 3.489297020963616*^9, 
  3.489297107157806*^9, 3.489301217293997*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", "SWAP", ",", "i", ",", 
     RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296640953506*^9, 3.489296650646451*^9}}],

Cell["Now make them interact", "Text",
 CellChangeTimes->{{3.489296679860825*^9, 3.4892966831389713`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TEBDEvolutionAddGate", "[", 
   RowBox[{"U", ",", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
      RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "9", ",", "10"}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.489296699492585*^9, 3.489296717607849*^9}}],

Cell["And bring it back to where it was", "Text",
 CellChangeTimes->{{3.4892967221140013`*^9, 3.489296727481517*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", "SWAP", ",", "i", ",", 
     RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "8", ",", "1", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296640953506*^9, 3.489296650646451*^9}, {
  3.48929673638741*^9, 3.489296739123128*^9}}],

Cell["Now we add the field terms to all the sites", "Text",
 CellChangeTimes->{{3.489296679860825*^9, 3.4892966831389713`*^9}, {
  3.4892967477367764`*^9, 3.489296754192624*^9}, {3.489296790655737*^9, 
  3.4892967922793903`*^9}}],

Cell[BoxData[
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"TEBDEvolutionAddGate", "[", 
    RowBox[{"U", ",", 
     RowBox[{"MatrixExp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "\[Mu]Field", " ", "X"}], 
      "]"}], ",", "i"}], "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.489296774348378*^9, 3.489296787289901*^9}, {
  3.489297037147304*^9, 3.489297037290173*^9}, {3.489299735389337*^9, 
  3.48929973554928*^9}}],

Cell["\<\
To complete the second order Trotter-Suzuki, we need to add the same gates \
but in transposed order\
\>", "Text",
 CellChangeTimes->{{3.4892967978090057`*^9, 3.489296818014518*^9}, {
  3.4892970420480223`*^9, 3.4892971242451353`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", "SWAP", ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "8"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TEBDEvolutionAddGate", "[", 
   RowBox[{"U", ",", 
    RowBox[{"MatrixExp", "[", 
     RowBox[{
      RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
      RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "9", ",", "10"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", "SWAP", ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "8", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
        RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "8", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
        RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "9", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.4892968244666986`*^9, 3.48929685953802*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
        RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "2", ",", "8", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TEBDEvolutionAddGate", "[", 
     RowBox[{"U", ",", 
      RowBox[{"MatrixExp", "[", 
       RowBox[{
        RowBox[{"-", "I"}], " ", "\[Delta]t", " ", "JCoupling", " ", 
        RowBox[{"ZZ", "/", "2"}]}], "]"}], ",", "i", ",", 
      RowBox[{"i", "+", "1"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "9", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]"}], "Input"],

Cell["We have a total of", "Text",
 CellChangeTimes->{{3.489296886636304*^9, 3.489296889468389*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "U", "]"}]], "Input",
 CellChangeTimes->{{3.489296892691613*^9, 3.4892968945173283`*^9}}],

Cell[BoxData["28"], "Output",
 CellChangeTimes->{3.489296894901493*^9, 3.4892971286469*^9, 
  3.489299751531309*^9, 3.489299899047667*^9, 3.4893007384745903`*^9, 
  3.489301217481509*^9, 3.489301275897027*^9}]
}, Open  ]],

Cell["gates per evolution step (the swaps add a lot of work).", "Text",
 CellChangeTimes->{{3.489296897117446*^9, 3.489296910027528*^9}}],

Cell["Let us see if it works by applying this 1000 times...", "Text",
 CellChangeTimes->{{3.489296871205886*^9, 3.489296878788549*^9}, {
   3.4892969297632427`*^9, 3.489296934667137*^9}, 3.4892971583206577`*^9, 
   3.489301740146902*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"error", "=", 
  RowBox[{"TEBDEvolve", "[", 
   RowBox[{"mytebd", ",", "U", ",", "1000", ",", 
    RowBox[{"Verbose", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.489296913480155*^9, 3.4892969374040403`*^9}, 
   3.489297160621194*^9, 3.489299756859661*^9, {3.489299830473275*^9, 
   3.489299830872786*^9}, {3.489299912750939*^9, 3.489299916158414*^9}, {
   3.489300137224627*^9, 3.4893001390630817`*^9}, {3.4893002807904673`*^9, 
   3.4893002890664597`*^9}}],

Cell[BoxData[
 RowBox[{"-", "176.82275084529488`"}]], "Output",
 CellChangeTimes->{
  3.4892999170313873`*^9, 3.4893001395844917`*^9, {3.489300214712162*^9, 
   3.489300240440283*^9}, 3.489300637444323*^9, 3.489300679829383*^9, 
   3.4893007435980473`*^9, 3.4893008534772463`*^9, 3.4893012502426443`*^9, 
   3.489301371124634*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"TEBDExpectationList", "[", 
   RowBox[{"mytebd", ",", "1", ",", "10", ",", "Z", ",", "Z"}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4892971641424913`*^9, 3.489297171140254*^9}, 
   3.489297349014318*^9, {3.4892974058722267`*^9, 3.4892974280526323`*^9}, {
   3.4893014343759947`*^9, 3.489301435421694*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], 
   PointBox[{{1., -0.9446467259668619}, {2., 0.9428750959656944}, {
    3., -0.9427678495476954}, {4., 0.9427644900664437}, {
    5., -0.9427597415059967}, {6., 0.9427519971173002}, {
    7., -0.9426014954142589}, {8., 0.9406022650917247}, {
    9., -0.9100057140182654}}]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.4892974217595387`*^9, 3.489297428474471*^9}, {
   3.489299793243491*^9, 3.489299832746026*^9}, 3.489299918940604*^9, 
   3.489300245169269*^9, 3.489300853718211*^9, {3.489301417783581*^9, 
   3.4893014358320513`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"TEBDEntropyList", "[", "mytebd", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.489301195876363*^9, 3.489301196957211*^9}, {
  3.489301673766898*^9, 3.489301728675927*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], 
   PointBox[{{1., 0.10453347898066422`}, {2., 0.10947461188684142`}, {3., 
    0.10994639837139174`}, {4., 0.11001434929449537`}, {5., 
    0.10999993100122048`}, {6., 0.11001435070557622`}, {7., 
    0.10994639418764833`}, {8., 0.10947457158109639`}, {9., 
    0.10453332474706882`}}]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{{3.489301674256071*^9, 3.489301688137817*^9}, 
   3.48930172907226*^9}]
}, Open  ]],

Cell["\<\
Overlaps can be calculated by the expectation value of Identity...maybe I \
will improve this later\
\>", "Text",
 CellChangeTimes->{{3.4893017361170177`*^9, 3.48930176378575*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TEBDExpectation", "[", 
  RowBox[{"mytebd", ",", "1", ",", "Id"}], "]"}]], "Input",
 CellChangeTimes->{{3.489301771226988*^9, 3.489301784203162*^9}}],

Cell[BoxData["1.0000000000000004`"], "Output",
 CellChangeTimes->{3.4893017850754337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["IsLinkActive"], "Input",
 CellChangeTimes->{{3.489305725019937*^9, 3.489305747012034*^9}}],

Cell[BoxData["IsLinkActive"], "Output",
 CellChangeTimes->{{3.48930574431565*^9, 3.489305747456971*^9}}]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{748, 785},
WindowMargins->{{Automatic, 115}, {Automatic, 25}},
ShowSelection->True,
FrontEndVersion->"7.0 for Linux x86 (64-bit) (February 25, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3489308414-8469528"->{
  Cell[23818, 579, 277, 5, 64, "Print",
   CellTags->"Info3489308414-8469528"]},
 "Info3489308415-5731344"->{
  Cell[25518, 632, 382, 6, 144, "Print",
   CellTags->"Info3489308415-5731344"]},
 "Info3489308416-9597017"->{
  Cell[31432, 802, 605, 9, 204, "Print",
   CellTags->"Info3489308416-9597017"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3489308414-8469528", 47406, 1234},
 {"Info3489308415-5731344", 47516, 1237},
 {"Info3489308416-9597017", 47627, 1240}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 26, 0, 25, "Title"],
Cell[574, 22, 28, 0, 25, "Section"],
Cell[605, 24, 25, 0, 25, "Text"],
Cell[CellGroupData[{
Cell[655, 28, 174, 3, 32, "Input"],
Cell[832, 33, 842, 12, 31, "Output"]
}, Open  ]],
Cell[1689, 48, 97, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[1811, 53, 216, 4, 32, "Input"],
Cell[2030, 59, 2006, 30, 785, "Print"]
}, Open  ]],
Cell[4051, 92, 114, 1, 31, "Text"],
Cell[4168, 95, 1362, 31, 143, "Input"],
Cell[5533, 128, 114, 1, 31, "Text"],
Cell[5650, 131, 250, 6, 32, "Input"],
Cell[5903, 139, 140, 1, 31, "Text"],
Cell[6046, 142, 128, 3, 32, "Input"],
Cell[6177, 147, 123, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[6325, 152, 177, 4, 32, "Input"],
Cell[6505, 158, 5952, 112, 292, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12494, 275, 134, 2, 32, "Input"],
Cell[12631, 279, 116, 3, 31, "Output"]
}, Open  ]],
Cell[12762, 285, 222, 5, 31, "Text"],
Cell[12987, 292, 1503, 38, 187, "Input"],
Cell[14493, 332, 114, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[14632, 337, 907, 17, 55, "Input"],
Cell[15542, 356, 6699, 170, 158, "Output"]
}, Open  ]],
Cell[22256, 529, 104, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[22385, 534, 177, 4, 32, "Input"],
Cell[22565, 540, 832, 23, 52, "Output"]
}, Open  ]],
Cell[23412, 566, 256, 5, 51, "Text"],
Cell[CellGroupData[{
Cell[23693, 575, 122, 2, 32, "Input"],
Cell[23818, 579, 277, 5, 64, "Print",
 CellTags->"Info3489308414-8469528"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24132, 589, 181, 4, 32, "Input"],
Cell[24316, 595, 186, 2, 24, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24539, 602, 430, 10, 55, "Input"],
Cell[24972, 614, 232, 5, 31, "Output"]
}, Open  ]],
Cell[25219, 622, 98, 1, 31, "Text"],
Cell[CellGroupData[{
Cell[25342, 627, 173, 3, 32, "Input"],
Cell[25518, 632, 382, 6, 144, "Print",
 CellTags->"Info3489308415-5731344"]
}, Open  ]],
Cell[25915, 641, 129, 1, 31, "Text"],
Cell[26047, 644, 1150, 40, 99, "Input"],
Cell[CellGroupData[{
Cell[27222, 688, 266, 5, 32, "Input"],
Cell[27491, 695, 246, 4, 31, "Output"]
}, Open  ]],
Cell[27752, 702, 171, 2, 31, "Text"],
Cell[CellGroupData[{
Cell[27948, 708, 493, 11, 55, "Input"],
Cell[28444, 721, 697, 14, 227, "Output"],
Cell[29144, 737, 718, 15, 227, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29899, 757, 101, 1, 73, "Section"],
Cell[30003, 760, 123, 1, 31, "Text"],
Cell[30129, 763, 1148, 31, 143, "Input"],
Cell[CellGroupData[{
Cell[31302, 798, 127, 2, 32, "Input"],
Cell[31432, 802, 605, 9, 204, "Print",
 CellTags->"Info3489308416-9597017"]
}, Open  ]],
Cell[32052, 814, 326, 7, 32, "Input"],
Cell[32381, 823, 611, 9, 111, "Text"],
Cell[32995, 834, 311, 6, 51, "Text"],
Cell[33309, 842, 174, 4, 32, "Input"],
Cell[33486, 848, 385, 10, 55, "Input"],
Cell[33874, 860, 275, 5, 51, "Text"],
Cell[34152, 867, 581, 13, 77, "Input"],
Cell[34736, 882, 100, 1, 31, "Text"],
Cell[34839, 885, 534, 12, 77, "Input"],
Cell[35376, 899, 248, 4, 51, "Text"],
Cell[CellGroupData[{
Cell[35649, 907, 582, 15, 55, "Input"],
Cell[36234, 924, 804, 21, 76, "Output"]
}, Open  ]],
Cell[37053, 948, 371, 8, 58, "Input"],
Cell[37427, 958, 106, 1, 26, "Text"],
Cell[37536, 961, 355, 9, 27, "Input"],
Cell[37894, 972, 117, 1, 26, "Text"],
Cell[38014, 975, 450, 10, 58, "Input"],
Cell[38467, 987, 229, 3, 26, "Text"],
Cell[38699, 992, 573, 13, 58, "Input"],
Cell[39275, 1007, 245, 5, 26, "Text"],
Cell[39523, 1014, 2072, 53, 223, "Input"],
Cell[41598, 1069, 1020, 26, 118, "Input"],
Cell[42621, 1097, 100, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[42746, 1102, 127, 2, 27, "Input"],
Cell[42876, 1106, 209, 3, 27, "Output"]
}, Open  ]],
Cell[43100, 1112, 137, 1, 26, "Text"],
Cell[43240, 1115, 237, 3, 26, "Text"],
Cell[CellGroupData[{
Cell[43502, 1122, 500, 9, 27, "Input"],
Cell[44005, 1133, 330, 6, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44372, 1144, 366, 7, 27, "Input"],
Cell[44741, 1153, 705, 15, 247, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45483, 1173, 223, 4, 27, "Input"],
Cell[45709, 1179, 569, 13, 238, "Output"]
}, Open  ]],
Cell[46293, 1195, 190, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[46508, 1203, 173, 3, 27, "Input"],
Cell[46684, 1208, 90, 1, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46811, 1214, 104, 1, 27, "Input"],
Cell[46918, 1217, 104, 1, 27, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)
\)\\)}\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" exceeds the levels, \\\
\\\\\"\\\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(1\\), \\\"MT\\\"]\
\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\", which can be flattened together \
in \\\\\\\"\\\", \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(\\(\\({\\(\\({\\(\\({\\(\\(\\(\
\\(-0.5531388757300928`\\)\\) + \\(\\(0.2250787955345641`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5531388739243515` \
\[InvisibleSpace]\\)\\) - \\(\\(0.22507878908137938`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\({\\(\\(\\(\\(-0.14955571305755813`\\)\
\\) - \\(\\(0.3475192231844429`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.1495556954145716`\\)\\) - \\(\\(0.34751923048427086`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\
\\), \\(\\({\\(\\(7.219091538808083`*^-8 + \\(\\(1.55846335273272`*^-8\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(7.390581449630305`*^-8 + \
\\(\\(1.5619067394599653`*^-8\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\), \
\\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\), \\(\\(\[LeftSkeleton] \
4 \[RightSkeleton]\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\
\\), \\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\)}\\)\\) . \
\\(\\({\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)}\\)\\) . \
\\(\\({\\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\), \\(\\({\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\)}\\)\\)\\), \\\"MT\\\"]\\)\
\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\".\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/Flatten\\\", ButtonNote -> \
\\\"Flatten::fldep\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.489237719078973*^9, 3.4892378471129007`*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{278., {3., 8.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "}"}], ".", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"3", ",", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}], ".", 
          RowBox[{"{", 
           RowBox[{
           "1.`", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "1.0000000000000004`", ",", "0", ",", 
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0.9999999999999993`", ",", "0", ",", "0", ",", "0", ",", 
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
            "0.9999999999999987`", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", 
            "0.9999999999999998`", ",", "0", ",", "0", ",", "0", ",", "0", 
            ",", "0", ",", "0", ",", "0", ",", "0", ",", "1.000000000000001`",
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
            "0", ",", "0", ",", "1.000000000000002`", ",", "0", ",", "0", ",",
             "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
            "1.0000000000000004`"}], "}"}]}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{49., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 37, 22867113457526894742, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{52., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 37, 22867113457526894742, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{82., {2., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 37, 22867113457526894742, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{74., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->{Deployed -> True}],
  Out[37]]], "Output",
 CellChangeTimes->{3.489237719307809*^9, 3.489237847230175*^9}]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{748, 785},
WindowMargins->{{Automatic, 163}, {Automatic, 0}},
ShowSelection->True,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (February 18, 2009)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{
 "Info3489244796-1930353"->{
  Cell[8035, 214, 279, 5, 60, "Print",
   CellTags->"Info3489244796-1930353"]},
 "Info3489244890-7984606"->{
  Cell[9599, 265, 382, 6, 130, "Print",
   CellTags->"Info3489244890-7984606"]}
 }
*)
(*CellTagsIndex
CellTagsIndex->{
 {"Info3489244796-1930353", 27457, 641},
 {"Info3489244890-7984606", 27566, 644}
 }
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 143, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[713, 25, 174, 3, 27, "Input"],
Cell[890, 30, 630, 8, 27, "Output"]
}, Open  ]],
Cell[1535, 41, 97, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[1657, 46, 243, 5, 27, "Input",
 InitializationCell->True],
Cell[1903, 53, 1017, 16, 561, "Print"]
}, Open  ]],
Cell[2935, 72, 114, 1, 26, "Text"],
Cell[3052, 75, 1148, 31, 103, "Input"],
Cell[4203, 108, 114, 1, 26, "Text"],
Cell[4320, 111, 250, 6, 27, "Input"],
Cell[4573, 119, 140, 1, 26, "Text"],
Cell[4716, 122, 128, 3, 27, "Input"],
Cell[4847, 127, 222, 5, 26, "Text"],
Cell[5072, 134, 1503, 38, 133, "Input"],
Cell[6578, 174, 114, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[6717, 179, 629, 13, 43, "Input"],
Cell[7349, 194, 389, 8, 27, "Output"]
}, Open  ]],
Cell[7753, 205, 132, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[7910, 210, 122, 2, 27, "Input"],
Cell[8035, 214, 279, 5, 60, "Print",
 CellTags->"Info3489244796-1930353"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8351, 224, 181, 4, 27, "Input"],
Cell[8535, 230, 117, 1, 20, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8689, 236, 430, 10, 43, "Input"],
Cell[9122, 248, 163, 4, 27, "Output"]
}, Open  ]],
Cell[9300, 255, 98, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[9423, 260, 173, 3, 27, "Input"],
Cell[9599, 265, 382, 6, 130, "Print",
 CellTags->"Info3489244890-7984606"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10018, 276, 487, 12, 27, "Input"],
Cell[10508, 290, 880, 16, 23, "Message"],
Cell[11391, 308, 2413, 37, 115, "Message"],
Cell[13807, 347, 882, 16, 23, "Message"],
Cell[14692, 365, 1778, 29, 104, "Message"],
Cell[16473, 396, 650, 11, 23, "Message"],
Cell[17126, 409, 2205, 34, 115, "Message"],
Cell[19334, 445, 2205, 34, 115, "Message"],
Cell[21542, 481, 5541, 145, 137, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
