(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 6.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    820555,      20071]
NotebookOptionsPosition[    789027,      19131]
NotebookOutlinePosition[    789385,      19147]
CellTagsIndexPosition[    789342,      19144]
WindowFrame->Normal
ContainsDynamic->True *)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MemoryInUse", "[", "]"}], "/", 
  RowBox[{"(", 
   RowBox[{"1024", " ", "1024."}], ")"}]}]], "Input",
 CellChangeTimes->{{3.4728788592206907`*^9, 3.472878890957872*^9}}],

Cell[BoxData["10.951255798339844`"], "Output",
 CellChangeTimes->{{3.472878865876123*^9, 3.472878892087722*^9}, 
   3.4729771251592093`*^9, 3.473061751209318*^9, 3.4730626215102797`*^9, 
   3.47306269772717*^9, 3.473144147209106*^9, {3.473144256330772*^9, 
   3.4731442646700487`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsLinkActive", "[", "]"}]], "Input",
 CellChangeTimes->{{3.4736894558843727`*^9, 3.47368945862986*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.4736894592738*^9, 3.47369809356691*^9, 
  3.473704580930614*^9, 3.473751764954322*^9, 3.474186220048983*^9, 
  3.4741936220312*^9, 3.474198140980753*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"bondtime", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.473688301900276*^9, 3.47368831514109*^9}, {
  3.473689731097561*^9, 3.4736897314180737`*^9}, {3.473697784240296*^9, 
  3.4736977865152197`*^9}, {3.4741981464726954`*^9, 3.474198146824153*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"bond", "=", "25"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numTensors", "=", "60"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntRange", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mps", "=", 
   RowBox[{"MPSProductState", "[", 
    RowBox[{"numTensors", ",", 
     RowBox[{"BondDimension", "\[Rule]", "bond"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MPSNormalize", "[", "mps", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HMatrix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.0", ",", 
            RowBox[{"n", "\[Equal]", "m"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"\[Alpha]", "\[Equal]", "3"}], ",", "1.0", ",", 
               RowBox[{"-", "0.3"}]}], "]"}], "/", 
             RowBox[{
              RowBox[{"Abs", "[", 
               RowBox[{"n", "-", "m"}], "]"}], "^", "3"}]}], ",", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"n", "-", "m"}], "]"}], "\[LessEqual]", "IntRange"}]}], 
           "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "numTensors"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "numTensors"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{"tim", ",", "energ"}], "}"}], "=", 
  RowBox[{"AbsoluteTiming", "[", 
   RowBox[{"MPSMinimizeEnergy", "[", 
    RowBox[{"mps", ",", "HMatrix", ",", 
     RowBox[{"Verbose", "\[Rule]", "False"}], ",", 
     RowBox[{"InteractionRange", "\[Rule]", "IntRange"}]}], "]"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.470562815079976*^9, 3.470562829047551*^9}, {
   3.470563042105328*^9, 3.470563042308668*^9}, {3.472448106017445*^9, 
   3.472448114686049*^9}, {3.472468495564139*^9, 3.47246849565727*^9}, {
   3.472470242654462*^9, 3.472470242711316*^9}, {3.4725372975528812`*^9, 
   3.4725372983004427`*^9}, {3.4728042093571863`*^9, 
   3.4728042095632553`*^9}, {3.4728194265500917`*^9, 3.472819426653634*^9}, {
   3.4728194798146353`*^9, 3.472819500225472*^9}, 3.4728196871720467`*^9, {
   3.472819738679819*^9, 3.472819738750421*^9}, {3.473055578089985*^9, 
   3.473055578180675*^9}, {3.473055851452385*^9, 3.473055851812931*^9}, 
   3.473056178684888*^9, 3.4730590549569387`*^9, {3.4730591699827147`*^9, 
   3.473059170070253*^9}, 3.473061460174273*^9, {3.473063936176875*^9, 
   3.473063936443788*^9}, 3.473080198725671*^9, {3.473080251558997*^9, 
   3.473080251662895*^9}, 3.473144143562531*^9, {3.47314438569864*^9, 
   3.473144386539295*^9}, {3.473661901062212*^9, 3.473661905237671*^9}, {
   3.473661964622751*^9, 3.473661964679277*^9}, {3.473662099914034*^9, 
   3.47366211949533*^9}, {3.473664986067692*^9, 3.473664986153576*^9}, {
   3.473665152855309*^9, 3.473665152947796*^9}, {3.473665484586979*^9, 
   3.473665487001459*^9}, 3.473666462892768*^9, 3.473669957339097*^9, {
   3.4736720619369802`*^9, 3.4736720644882812`*^9}, {3.473685430174861*^9, 
   3.4736854302743673`*^9}, 3.473685493659278*^9, {3.473685592336429*^9, 
   3.4736855923796997`*^9}, {3.473688208663535*^9, 3.473688241336108*^9}, {
   3.473688283134507*^9, 3.4736882888558903`*^9}, {3.473688351784359*^9, 
   3.473688408466402*^9}, {3.473688444382745*^9, 3.473688444780779*^9}, {
   3.473688572571904*^9, 3.473688612394655*^9}, 3.473688659329434*^9, {
   3.473689150607625*^9, 3.4736891507589083`*^9}, 3.473689240222789*^9, {
   3.4736893301566668`*^9, 3.4736893302012653`*^9}, {3.47368956163783*^9, 
   3.473689561690894*^9}, {3.473689699922001*^9, 3.4736898728568153`*^9}, 
   3.473689923715232*^9, 3.473690162060457*^9, {3.473697641550873*^9, 
   3.473697643003995*^9}, {3.4736977552060537`*^9, 3.4736977562274323`*^9}, {
   3.473697798608282*^9, 3.473697810928131*^9}, {3.4736978807033052`*^9, 
   3.473697911266173*^9}, {3.47369795089965*^9, 3.473697951801305*^9}, {
   3.473698002458313*^9, 3.473698003295258*^9}, {3.473698099423448*^9, 
   3.473698100518571*^9}, {3.473698209660244*^9, 3.473698210569022*^9}, {
   3.4737046360021267`*^9, 3.473704696807521*^9}, {3.473748494410234*^9, 
   3.4737484945583982`*^9}, {3.474186241362607*^9, 3.474186242827078*^9}, 
   3.474187042583283*^9, {3.474193632669855*^9, 3.474193632914021*^9}, {
   3.474193744609909*^9, 3.474193745691587*^9}, {3.4741938535157347`*^9, 
   3.474193853617614*^9}, {3.4741939874220047`*^9, 3.474193988527368*^9}, {
   3.4741981492771893`*^9, 3.474198150497963*^9}, {3.4741981893193817`*^9, 
   3.4741982095868893`*^9}, 3.474198250195887*^9, {3.474198381887238*^9, 
   3.47419838304599*^9}, 3.4741987018742228`*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Arpack error reported:\"\>"], "Print",
 CellChangeTimes->{3.4741992015430202`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "1399"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", 
   RowBox[{"-", "1399"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "1399"}], ",", 
   RowBox[{"-", "1399"}], ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   "0"}], "}"}]], "Print",
 CellChangeTimes->{3.47419920161122*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"497.902563`9.148689355348644", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "3.0227218425696125`"}], ",", 
     RowBox[{"-", "4.147529744932408`"}], ",", 
     RowBox[{"-", "5.119177077775211`"}], ",", 
     RowBox[{"-", "6.217508666082633`"}], ",", 
     RowBox[{"-", "7.220491028487435`"}], ",", 
     RowBox[{"-", "7.955893535423086`"}], ",", 
     RowBox[{"-", "9.15861106542513`"}], ",", 
     RowBox[{"-", "9.95383553337449`"}], ",", 
     RowBox[{"-", "10.748019377858883`"}], ",", 
     RowBox[{"-", "11.815576014435786`"}], ",", 
     RowBox[{"-", "13.105578618900223`"}], ",", 
     RowBox[{"-", "13.950816085676717`"}], ",", 
     RowBox[{"-", "14.86233388846422`"}], ",", 
     RowBox[{"-", "14.86233388846422`"}], ",", 
     RowBox[{"-", "16.84120456902329`"}], ",", 
     RowBox[{"-", "17.852729556992085`"}], ",", 
     RowBox[{"-", "18.903952669416196`"}], ",", 
     RowBox[{"-", "20.078597935165334`"}], ",", 
     RowBox[{"-", "21.3272664126849`"}], ",", 
     RowBox[{"-", "21.978798703925072`"}], ",", 
     RowBox[{"-", "21.978798703925072`"}], ",", 
     RowBox[{"-", "23.908385420072502`"}], ",", 
     RowBox[{"-", "25.07316395265178`"}], ",", 
     RowBox[{"-", "26.17285059772178`"}], ",", 
     RowBox[{"-", "26.99160829770181`"}], ",", 
     RowBox[{"-", "28.22332098825938`"}], ",", 
     RowBox[{"-", "28.99277709507851`"}], ",", 
     RowBox[{"-", "29.988220717370933`"}], ",", 
     RowBox[{"-", "30.935894849369504`"}], ",", 
     RowBox[{"-", "31.662624563197966`"}], ",", 
     RowBox[{"-", "32.748692324215426`"}], ",", 
     RowBox[{"-", "33.5764495685379`"}], ",", 
     RowBox[{"-", "34.75915117247058`"}], ",", 
     RowBox[{"-", "35.833706701753115`"}], ",", 
     RowBox[{"-", "36.856446220699084`"}], ",", 
     RowBox[{"-", "37.91965729225842`"}], ",", 
     RowBox[{"-", "39.05964090408081`"}], ",", 
     RowBox[{"-", "39.8743949803186`"}], ",", 
     RowBox[{"-", "40.99828812092007`"}], ",", 
     RowBox[{"-", "42.06113131834917`"}], ",", 
     RowBox[{"-", "43.246163218931834`"}], ",", 
     RowBox[{"-", "44.22011381073094`"}], ",", 
     RowBox[{"-", "45.12917586590919`"}], ",", 
     RowBox[{"-", "46.195397545107554`"}], ",", 
     RowBox[{"-", "47.15346191172389`"}], ",", 
     RowBox[{"-", "48.14900673505593`"}], ",", 
     RowBox[{"-", "49.290903764114006`"}], ",", 
     RowBox[{"-", "50.19495601438725`"}], ",", 
     RowBox[{"-", "51.20127016624639`"}], ",", 
     RowBox[{"-", "52.237827396914646`"}], ",", 
     RowBox[{"-", "53.20631820040174`"}], ",", 
     RowBox[{"-", "54.583781235900666`"}], ",", 
     RowBox[{"-", "55.88161530725018`"}], ",", 
     RowBox[{"-", "55.88161530725018`"}], ",", 
     RowBox[{"-", "55.88161530725018`"}], ",", 
     RowBox[{"-", "60.12018465992444`"}], ",", 
     RowBox[{"-", "60.1201846599241`"}], ",", 
     RowBox[{"-", "60.12018465992402`"}], ",", 
     RowBox[{"-", "60.12018465992407`"}], ",", 
     RowBox[{"-", "60.120184659924085`"}], ",", 
     RowBox[{"-", "60.12018465992408`"}], ",", 
     RowBox[{"-", "60.120184659924035`"}], ",", 
     RowBox[{"-", "60.120184659924035`"}], ",", 
     RowBox[{"-", "60.12018465992405`"}], ",", 
     RowBox[{"-", "60.1201846599241`"}], ",", 
     RowBox[{"-", "60.12038495105895`"}], ",", 
     RowBox[{"-", "60.120395482787664`"}], ",", 
     RowBox[{"-", "60.120397943113794`"}], ",", 
     RowBox[{"-", "60.12039995989197`"}], ",", 
     RowBox[{"-", "60.12040285607917`"}], ",", 
     RowBox[{"-", "60.120403844627965`"}], ",", 
     RowBox[{"-", "60.12040458502159`"}], ",", 
     RowBox[{"-", "60.12040582218034`"}], ",", 
     RowBox[{"-", "60.12040684012638`"}], ",", 
     RowBox[{"-", "60.12040755208865`"}], ",", 
     RowBox[{"-", "60.12040814669179`"}], ",", 
     RowBox[{"-", "60.12040870433094`"}], ",", 
     RowBox[{"-", "60.12040944957287`"}], ",", 
     RowBox[{"-", "60.12040999219485`"}], ",", 
     RowBox[{"-", "60.12041043775024`"}], ",", 
     RowBox[{"-", "60.12041128021479`"}], ",", 
     RowBox[{"-", "60.12041201758111`"}], ",", 
     RowBox[{"-", "60.120412693191405`"}], ",", 
     RowBox[{"-", "60.12041324383118`"}], ",", 
     RowBox[{"-", "60.12041403527576`"}], ",", 
     RowBox[{"-", "60.120414627495805`"}], ",", 
     RowBox[{"-", "60.12041543152754`"}], ",", 
     RowBox[{"-", "60.12041627330022`"}], ",", 
     RowBox[{"-", "60.120417749602375`"}], ",", 
     RowBox[{"-", "60.12041833041398`"}], ",", 
     RowBox[{"-", "60.1204190332303`"}], ",", 
     RowBox[{"-", "60.12041951254309`"}], ",", 
     RowBox[{"-", "60.12042017635845`"}], ",", 
     RowBox[{"-", "60.12042184175848`"}], ",", 
     RowBox[{"-", "60.120422042706764`"}], ",", 
     RowBox[{"-", "60.120422178590104`"}], ",", 
     RowBox[{"-", "60.120422282728974`"}], ",", 
     RowBox[{"-", "60.13457998692494`"}], ",", 
     RowBox[{"-", "60.13555851788167`"}], ",", 
     RowBox[{"-", "60.135560512160986`"}], ",", 
     RowBox[{"-", "60.13556140663017`"}], ",", 
     RowBox[{"-", "60.13556230253271`"}], ",", 
     RowBox[{"-", "60.13556467752697`"}], ",", 
     RowBox[{"-", "60.135564921858276`"}], ",", 
     RowBox[{"-", "60.13591593666975`"}], ",", 
     RowBox[{"-", "60.13602230986391`"}], ",", 
     RowBox[{"-", "60.13614229288356`"}], ",", 
     RowBox[{"-", "60.13617790865866`"}], ",", 
     RowBox[{"-", "60.136984291415814`"}], ",", 
     RowBox[{"-", "60.13894360870334`"}], ",", 
     RowBox[{"-", "60.13894842989531`"}], ",", 
     RowBox[{"-", "60.138951380543496`"}], ",", 
     RowBox[{"-", "60.13895362872754`"}], ",", 
     RowBox[{"-", "60.139419348968296`"}], ",", 
     RowBox[{"-", "60.139421020548404`"}], ",", 
     RowBox[{"-", "60.13942158124069`"}], ",", 
     RowBox[{"-", "60.139421581240235`"}], ",", 
     RowBox[{"-", "60.1394215812403`"}], ",", 
     RowBox[{"-", "60.139421581240285`"}], ",", 
     RowBox[{"-", "60.13942158124026`"}], ",", 
     RowBox[{"-", "60.13942158124027`"}], ",", 
     RowBox[{"-", "60.13942158124028`"}], ",", 
     RowBox[{"-", "60.13942158124034`"}], ",", 
     RowBox[{"-", "60.139421581240256`"}], ",", 
     RowBox[{"-", "60.13942158124037`"}], ",", 
     RowBox[{"-", "60.13942158218374`"}], ",", 
     RowBox[{"-", "60.13942158504189`"}], ",", 
     RowBox[{"-", "60.139421607066936`"}], ",", 
     RowBox[{"-", "60.139421617336296`"}], ",", 
     RowBox[{"-", "60.13942162315519`"}], ",", 
     RowBox[{"-", "60.139421626729636`"}], ",", 
     RowBox[{"-", "60.1394216910166`"}], ",", 
     RowBox[{"-", "60.13942173995599`"}], ",", 
     RowBox[{"-", "60.13942176974077`"}], ",", 
     RowBox[{"-", "60.13942180654334`"}], ",", 
     RowBox[{"-", "60.13942183623253`"}], ",", 
     RowBox[{"-", "60.13942187668836`"}], ",", 
     RowBox[{"-", "60.139421892283636`"}], ",", 
     RowBox[{"-", "60.13942189954105`"}], ",", 
     RowBox[{"-", "60.13942190908279`"}], ",", 
     RowBox[{"-", "60.13942191760523`"}], ",", 
     RowBox[{"-", "60.13942192524037`"}], ",", 
     RowBox[{"-", "60.139421949332316`"}], ",", 
     RowBox[{"-", "60.139422368043995`"}], ",", 
     RowBox[{"-", "60.1394224447098`"}], ",", 
     RowBox[{"-", "60.13942249263353`"}], ",", 
     RowBox[{"-", "60.139422500949806`"}], ",", 
     RowBox[{"-", "60.13942251517807`"}], ",", 
     RowBox[{"-", "60.13942252444513`"}], ",", 
     RowBox[{"-", "60.139422530275304`"}], ",", 
     RowBox[{"-", "60.13942253422332`"}], ",", 
     RowBox[{"-", "60.13942253803463`"}], ",", 
     RowBox[{"-", "60.13942253974436`"}], ",", 
     RowBox[{"-", "60.139422543240066`"}], ",", 
     RowBox[{"-", "60.139422546941724`"}], ",", 
     RowBox[{"-", "60.1394225497815`"}], ",", 
     RowBox[{"-", "60.13942255421415`"}], ",", 
     RowBox[{"-", "60.139422557785174`"}], ",", 
     RowBox[{"-", "60.13942256184637`"}], ",", 
     RowBox[{"-", "60.13942256569102`"}], ",", 
     RowBox[{"-", "60.1394225700642`"}], ",", 
     RowBox[{"-", "60.13942257492137`"}], ",", 
     RowBox[{"-", "60.13942258137028`"}], ",", 
     RowBox[{"-", "60.13942258967188`"}], ",", 
     RowBox[{"-", "60.13942259617955`"}], ",", 
     RowBox[{"-", "60.13942260574684`"}], ",", 
     RowBox[{"-", "60.13942261771543`"}], ",", 
     RowBox[{"-", "60.139422625172124`"}], ",", 
     RowBox[{"-", "60.13942263215717`"}], ",", 
     RowBox[{"-", "60.139422639660246`"}], ",", 
     RowBox[{"-", "60.13942264395453`"}], ",", 
     RowBox[{"-", "60.1394226520171`"}], ",", 
     RowBox[{"-", "60.13942266323698`"}], ",", 
     RowBox[{"-", "60.139422668948754`"}], ",", 
     RowBox[{"-", "60.139422677329954`"}], ",", 
     RowBox[{"-", "60.13942268054399`"}], ",", 
     RowBox[{"-", "60.13942268054395`"}], ",", 
     RowBox[{"-", "60.139422680543866`"}], ",", 
     RowBox[{"-", "60.139422680543916`"}], ",", 
     RowBox[{"-", "60.13942268054394`"}], ",", 
     RowBox[{"-", "60.13942268054393`"}], ",", 
     RowBox[{"-", "60.139422680543944`"}], ",", 
     RowBox[{"-", "60.139422680543895`"}], ",", 
     RowBox[{"-", "60.139422680543944`"}], ",", 
     RowBox[{"-", "60.13942268054389`"}], ",", 
     RowBox[{"-", "60.13942268127757`"}], ",", 
     RowBox[{"-", "60.13942268385812`"}], ",", 
     RowBox[{"-", "60.13942268449386`"}], ",", 
     RowBox[{"-", "60.139422686182876`"}], ",", 
     RowBox[{"-", "60.13942268847778`"}], ",", 
     RowBox[{"-", "60.13942268959207`"}], ",", 
     RowBox[{"-", "60.13942269301837`"}], ",", 
     RowBox[{"-", "60.13942269393103`"}], ",", 
     RowBox[{"-", "60.13942269758801`"}], ",", 
     RowBox[{"-", "60.13942269979079`"}], ",", 
     RowBox[{"-", "60.13942270231789`"}], ",", 
     RowBox[{"-", "60.13942270362835`"}], ",", 
     RowBox[{"-", "60.139422707009984`"}], ",", 
     RowBox[{"-", "60.13942270779763`"}], ",", 
     RowBox[{"-", "60.13942270932678`"}], ",", 
     RowBox[{"-", "60.139422709792264`"}], ",", 
     RowBox[{"-", "60.13942271042495`"}], ",", 
     RowBox[{"-", "60.13942271098349`"}], ",", 
     RowBox[{"-", "60.13942271171271`"}], ",", 
     RowBox[{"-", "60.13942271268429`"}], ",", 
     RowBox[{"-", "60.13942271332675`"}], ",", 
     RowBox[{"-", "60.13942271417012`"}], ",", 
     RowBox[{"-", "60.13942271471278`"}], ",", 
     RowBox[{"-", "60.13942271521686`"}], ",", 
     RowBox[{"-", "60.13942271564434`"}], ",", 
     RowBox[{"-", "60.13942271610136`"}], ",", 
     RowBox[{"-", "60.1394227169306`"}], ",", 
     RowBox[{"-", "60.1394227188471`"}], ",", 
     RowBox[{"-", "60.13942271977549`"}], ",", 
     RowBox[{"-", "60.13942272073072`"}], ",", 
     RowBox[{"-", "60.139422722823284`"}], ",", 
     RowBox[{"-", "60.1394227254125`"}], ",", 
     RowBox[{"-", "60.139422734773106`"}], ",", 
     RowBox[{"-", "60.13942273712111`"}], ",", 
     RowBox[{"-", "60.13942273860807`"}], ",", 
     RowBox[{"-", "60.13942274042603`"}], ",", 
     RowBox[{"-", "60.13942274195638`"}], ",", 
     RowBox[{"-", "60.13942274313459`"}], ",", 
     RowBox[{"-", "60.13942274429645`"}], ",", 
     RowBox[{"-", "60.13942274803233`"}], ",", 
     RowBox[{"-", "60.13942275080677`"}], ",", 
     RowBox[{"-", "60.13942275359408`"}], ",", 
     RowBox[{"-", "60.13942275659255`"}], ",", 
     RowBox[{"-", "60.13942275977085`"}], ",", 
     RowBox[{"-", "60.139422766098086`"}], ",", 
     RowBox[{"-", "60.13942276655408`"}], ",", 
     RowBox[{"-", "60.13942276801166`"}], ",", 
     RowBox[{"-", "60.13942277055622`"}], ",", 
     RowBox[{"-", "60.13942277261501`"}], ",", 
     RowBox[{"-", "60.13942277304017`"}], ",", 
     RowBox[{"-", "60.1394227733184`"}], ",", 
     RowBox[{"-", "60.13942277331842`"}], ",", 
     RowBox[{"-", "60.13942277331839`"}], ",", 
     RowBox[{"-", "60.13942277331843`"}], ",", 
     RowBox[{"-", "60.139422773318394`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4741992016381063`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bondtime", "=", 
  RowBox[{"Append", "[", 
   RowBox[{"bondtime", ",", 
    RowBox[{"{", 
     RowBox[{"bond", ",", "tim"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.474193791016028*^9, 3.4741938027922153`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "17.607605`7.697245280410385"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "29.095221`7.915366653829875"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "106.820542`8.480199770714675"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "245.828423`8.842177088638843"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "497.902563`9.148689355348644"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.4736883769748774`*^9, 3.473688405071871*^9}, 
   3.473688438907196*^9, 3.473688490329383*^9, {3.473688584461999*^9, 
   3.47368860763341*^9}, 3.473688652584025*^9, 3.4736887327408857`*^9, 
   3.4736889447488127`*^9, 3.4736892286754313`*^9, 3.4736893151582327`*^9, 
   3.473689445544383*^9, 3.473689666033122*^9, {3.473689792678359*^9, 
   3.473689865405635*^9}, 3.473689903821624*^9, 3.473689975677788*^9, 
   3.4736902411520844`*^9, 3.473697659229422*^9, 3.4736978398934917`*^9, {
   3.4736978738834133`*^9, 3.47369790256281*^9}, 3.473697940906103*^9, 
   3.4736979951519547`*^9, 3.473698063878854*^9, 3.4736982034041758`*^9, 
   3.4736983106716843`*^9, 3.473704674533036*^9, 3.47419373714145*^9, 
   3.474193846616287*^9, 3.4741939789389887`*^9, 3.4741944829493923`*^9, 
   3.4741981786781473`*^9, 3.474198239618936*^9, 3.474198376918702*^9, 
   3.474198633988842*^9, 3.474199201937212*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Linux (my desktop) timing", "Subsection",
 CellChangeTimes->{{3.474199277140231*^9, 3.474199283236293*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"{", 
   RowBox[{"bondtime", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"0.03", " ", 
         RowBox[{"x", "^", "3"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "5", ",", "30", ",", "1"}], "}"}]}], "]"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.474199238994172*^9, 3.474199261339813*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {Hue[0.67, 0.6, 0.6], 
    PointBox[{{1.6094379124341003`, 2.8683309109875306`}, {2.302585092994046, 
     3.3705739338866247`}, {2.70805020110221, 4.67115024885494}, {
     2.995732273553991, 5.50463382510909}, {3.2188758248682006`, 
     6.210404401254892}}]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], 
    PointBox[{{1.6094379124341003`, 1.3217558399823195`}, {1.791759469228055, 
     1.8687205103641833`}, {1.9459101490553132`, 2.331172549845958}, {
     2.0794415416798357`, 2.731766727719526}, {2.1972245773362196`, 
     3.0851158346886765`}, {2.302585092994046, 3.4011973816621555`}, {
     2.3978952727983707`, 3.6871279210751298`}, {2.4849066497880004`, 
     3.9481620520440193`}, {2.5649493574615367`, 4.188290175064629}, {
     2.6390573296152584`, 4.410614091525794}, {2.70805020110221, 
     4.617592705986649}, {2.772588722239781, 4.811208269399362}, {
     2.833213344056216, 4.993082134848667}, {2.8903717578961645`, 
     5.164557376368513}, {2.9444389791664403`, 5.32675904017934}, {
     2.995732273553991, 5.480638923341991}, {3.044522437723423, 
     5.627009415850288}, {3.091042453358316, 5.7665694627549655`}, {
     3.1354942159291497`, 5.899924750467467}, {3.1780538303479458`, 
     6.027603593723855}, {3.2188758248682006`, 6.15006957728462}, {
     3.258096538021482, 6.267731716744464}, {3.295836866004329, 
     6.380952700693006}, {3.332204510175204, 6.49005563320563}, {
     3.367295829986474, 6.59532959263944}, {3.4011973816621555`, 
     6.697034247666484}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{1.6094379124341003`, 1.3217558399823195`},
  FrameTicks->{{{{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["10", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["20", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["50", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["100", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["200", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["500", TraditionalForm]}, {
       NCache[
        Log[1000], 6.907755278982137], 
       FormBox["1000", TraditionalForm]}, {
       NCache[
        Log[2000], 7.600902459542082], 
       FormBox["2000", TraditionalForm]}, {
       NCache[
        Log[5000], 8.517193191416238], 
       FormBox["5000", TraditionalForm]}, {3.4011973816621555`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.6888794541139363`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.0943445622221, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.248495242049359, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.703782474656201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.991464547107982, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {6.396929655216146, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {6.551080335043404, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {6.684611727667927, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {6.802394763324311, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {8.006367567650246, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {8.294049640102028, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[1000], 6.907755278982137], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[2000], 7.600902459542082], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[5000], 8.517193191416238], 
       FormBox["\" \"", TraditionalForm]}, {3.4011973816621555`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.6888794541139363`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.0943445622221, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.248495242049359, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.703782474656201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.991464547107982, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {6.396929655216146, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {6.551080335043404, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {6.684611727667927, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {6.802394763324311, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {8.006367567650246, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {8.294049640102028, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}, {{{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["10", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["100", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["50", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["500", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["20", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["200", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["30", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["300", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["15", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["150", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["70", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["\" \"", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}},
  GridLines->{None, None},
  Method->{CoordinatesToolOptions -> {"DisplayFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{1.6094379124341003`, 3.4011973816621555`}, {
   1.3217558399823195`, 6.697034247666484}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]},
  Ticks->{{{
      NCache[
       Log[10], 2.302585092994046], 
      FormBox["10", TraditionalForm]}, {
      NCache[
       Log[100], 4.605170185988092], 
      FormBox["100", TraditionalForm]}, {
      NCache[
       Log[50], 3.912023005428146], 
      FormBox["50", TraditionalForm]}, {
      NCache[
       Log[500], 6.214608098422191], 
      FormBox["500", TraditionalForm]}, {
      NCache[
       Log[20], 2.995732273553991], 
      FormBox["20", TraditionalForm]}, {
      NCache[
       Log[200], 5.298317366548036], 
      FormBox["200", TraditionalForm]}, {
      NCache[
       Log[30], 3.4011973816621555`], 
      FormBox["30", TraditionalForm]}, {
      NCache[
       Log[300], 5.703782474656201], 
      FormBox["300", TraditionalForm]}, {
      NCache[
       Log[15], 2.70805020110221], 
      FormBox["15", TraditionalForm]}, {
      NCache[
       Log[150], 5.0106352940962555`], 
      FormBox["150", TraditionalForm]}, {
      NCache[
       Log[70], 4.248495242049359], 
      FormBox["70", TraditionalForm]}, {
      NCache[
       Log[700], 6.551080335043404], 
      FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.4849066497880004`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.5649493574615367`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.6390573296152584`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.772588722239781, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.833213344056216, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.8903717578961645`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.9444389791664403`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[40], 3.6888794541139363`], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[60], 4.0943445622221], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.382026634673881, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.499809670330265, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.700480365792417, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.787491742782046, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.867534450455582, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.941642422609304, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.075173815233827, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.135798437050262, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.19295685089021, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.247024072160486, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[400], 5.991464547107982], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[600], 6.396929655216146], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}}, {{
      NCache[
       Log[10], 2.302585092994046], 
      FormBox["10", TraditionalForm]}, {
      NCache[
       Log[20], 2.995732273553991], 
      FormBox["20", TraditionalForm]}, {
      NCache[
       Log[50], 3.912023005428146], 
      FormBox["50", TraditionalForm]}, {
      NCache[
       Log[100], 4.605170185988092], 
      FormBox["100", TraditionalForm]}, {
      NCache[
       Log[200], 5.298317366548036], 
      FormBox["200", TraditionalForm]}, {
      NCache[
       Log[500], 6.214608098422191], 
      FormBox["500", TraditionalForm]}, {
      NCache[
       Log[1000], 6.907755278982137], 
      FormBox["1000", TraditionalForm]}, {
      NCache[
       Log[2000], 7.600902459542082], 
      FormBox["2000", TraditionalForm]}, {
      NCache[
       Log[5000], 8.517193191416238], 
      FormBox["5000", TraditionalForm]}, {3.4011973816621555`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {3.6888794541139363`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.0943445622221, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.248495242049359, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.382026634673881, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.499809670330265, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.703782474656201, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.991464547107982, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {6.396929655216146, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {6.551080335043404, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {6.684611727667927, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {6.802394763324311, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {8.006367567650246, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {8.294049640102028, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}}}]], "Output",
 CellChangeTimes->{{3.474199231655895*^9, 3.4741992620320797`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Mac times", "Subsection",
 CellChangeTimes->{{3.474199228487988*^9, 3.474199230020261*^9}}],

Cell[CellGroupData[{

Cell[BoxData["sitetime"], "Input",
 CellChangeTimes->{{3.4736977696182337`*^9, 3.473697772379733*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"10", ",", "3.892148`7.041734339573597"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "21.105207`7.775934609570237"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "39.361383`8.04661534287714"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"40", ",", "60.98989`8.236802843570581"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "76.315801`8.334159460371547"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"60", ",", "73.439287`8.317473445274816"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"90", ",", "100.662244`8.45441160111834"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.4736977738752317`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["bondtime"], "Input",
 CellChangeTimes->{{3.473698110782342*^9, 3.473698114209223*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"5", ",", "5.463399`7.189007912328436"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "6.094608`7.2364907708971735"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"15", ",", "8.155772`7.36301006978232"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"20", ",", "12.289817`7.541090409622308"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"25", ",", "18.836275`7.726540015790688"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"30", ",", "26.206977`7.869961921045531"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"40", ",", "50.629215`8.155946187250358"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"50", ",", "77.3211`8.339843017338417"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.473698115508397*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["rangetime"], "Input",
 CellChangeTimes->{{3.473698124263338*^9, 3.47369812822572*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "12.31055`7.54182244989026"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "19.725801`7.746579641008192"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "28.016562`7.898959834080382"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "39.239307`8.045266322256536"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "57.504155`8.21124421954871"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "67.75259`8.28247089527427"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "94.54117`8.427165966133904"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.473698129313766*^9, 3.47369872039713*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"{", 
   RowBox[{"sitetime", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"1", " ", 
         RowBox[{"x", "^", "1"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "20", ",", "90", ",", "1"}], "}"}]}], "]"}]}], "}"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.473688498639333*^9, 3.473688510319192*^9}, {
  3.473698845646819*^9, 3.473698886348336*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {Hue[0.67, 0.6, 0.6], 
    PointBox[{{2.302585092994046, 1.3589611903222412`}, {2.995732273553991, 
     3.0495197872887085`}, {3.4011973816621555`, 3.6727852087618778`}, {
     3.6888794541139363`, 4.110708112732382}, {3.912023005428146, 
     4.334880007282651}, {4.0943445622221, 4.296459037659441}, {
     4.499809670330265, 4.611770793966809}}]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], PointBox[CompressedData["
1:eJxFxWlIkwEABuChxdI5neaRjii3os2m4syydOisrbJaywRxaQzhI6mVeSxN
C2oIamFsc/RDEzzCrOlEo9oclijzSCZMa0QYBROZ2rFwTZdX9aPv/fHwRBcU
ZRE+FArl+F//1jhKqzKWqen/7zUU6eIubCMfswjKy/qx67lt/XaYH7mXp731
RIET678tCwexNcq1oGP4k6urfY2f8zE786Fd1ol3bVgnkl24yU7zdiTRyGX7
NScmK/CVMePraRO2Gd+7P6xgD910dy0pgNyyFHReVox9dsf8punxwOiR7xwH
7hQOW0Yi6eR2em2hV4LpJfyUaRWWdD0QES9wrCAu+80cDv4aGu4KDyQ/mr12
cKsYPx5vv0Erw4oM9UBgK37pUsdHWbHSLE1NXsE5Mr6hhBVE3sPsejV1Cm9S
zm3Ky/DJp4Znex9hfSqrkDOMA7YPlV+fx0sb/bkqKoNcqoiZ+BWJcxu7W8N4
+Ix4xDIrwDe5o17iLL7PJ2aa5JiuCFmsLcaLM/uq41WYucPh1GhxqT4lra8N
K7m6Bm0f7mBnfjwwhGODOT8bbfjwpLll5As2R+maTT9wtPBSnXIDj9v3uFcD
gsnTctx5Eiaei2clXuPinfo1e94hnEdta2SKcIhzcEifhVP5p2sC5ZgrYYeK
ruLS3p46aSU+dqdiPaEG03y7KxcaMNHc4VPVglWzBfWzXfgd4fHjmLB/+8pF
sQWLB+Yvp9vwVJp2S8QnLC/OX33rxJ57hoh8N2bwEpiTm/gPR6faKA==
     "]]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{2.302585092994046, 1.3589611903222412`},
  FrameTicks->{{{{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["10", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["100", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["50", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["500", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["20", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["200", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["30", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["300", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["15", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["150", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["70", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["\" \"", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}, {{{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["10", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["100", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["50", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["500", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["20", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["200", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["30", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["300", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["15", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["150", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["70", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["\" \"", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}},
  GridLines->{None, None},
  Method->{CoordinatesToolOptions -> {"DisplayFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{2.302585092994046, 4.499809670330265}, {1.3589611903222412`, 
   4.611770793966809}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]},
  Ticks->{{{
      NCache[
       Log[10], 2.302585092994046], 
      FormBox["10", TraditionalForm]}, {
      NCache[
       Log[100], 4.605170185988092], 
      FormBox["100", TraditionalForm]}, {
      NCache[
       Log[50], 3.912023005428146], 
      FormBox["50", TraditionalForm]}, {
      NCache[
       Log[500], 6.214608098422191], 
      FormBox["500", TraditionalForm]}, {
      NCache[
       Log[20], 2.995732273553991], 
      FormBox["20", TraditionalForm]}, {
      NCache[
       Log[200], 5.298317366548036], 
      FormBox["200", TraditionalForm]}, {
      NCache[
       Log[30], 3.4011973816621555`], 
      FormBox["30", TraditionalForm]}, {
      NCache[
       Log[300], 5.703782474656201], 
      FormBox["300", TraditionalForm]}, {
      NCache[
       Log[15], 2.70805020110221], 
      FormBox["15", TraditionalForm]}, {
      NCache[
       Log[150], 5.0106352940962555`], 
      FormBox["150", TraditionalForm]}, {
      NCache[
       Log[70], 4.248495242049359], 
      FormBox["70", TraditionalForm]}, {
      NCache[
       Log[700], 6.551080335043404], 
      FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.4849066497880004`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.5649493574615367`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.6390573296152584`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.772588722239781, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.833213344056216, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.8903717578961645`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.9444389791664403`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[40], 3.6888794541139363`], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[60], 4.0943445622221], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.382026634673881, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.499809670330265, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.700480365792417, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.787491742782046, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.867534450455582, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.941642422609304, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.075173815233827, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.135798437050262, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.19295685089021, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.247024072160486, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[400], 5.991464547107982], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[600], 6.396929655216146], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}}, {{
      NCache[
       Log[10], 2.302585092994046], 
      FormBox["10", TraditionalForm]}, {
      NCache[
       Log[100], 4.605170185988092], 
      FormBox["100", TraditionalForm]}, {
      NCache[
       Log[50], 3.912023005428146], 
      FormBox["50", TraditionalForm]}, {
      NCache[
       Log[500], 6.214608098422191], 
      FormBox["500", TraditionalForm]}, {
      NCache[
       Log[20], 2.995732273553991], 
      FormBox["20", TraditionalForm]}, {
      NCache[
       Log[200], 5.298317366548036], 
      FormBox["200", TraditionalForm]}, {
      NCache[
       Log[30], 3.4011973816621555`], 
      FormBox["30", TraditionalForm]}, {
      NCache[
       Log[300], 5.703782474656201], 
      FormBox["300", TraditionalForm]}, {
      NCache[
       Log[15], 2.70805020110221], 
      FormBox["15", TraditionalForm]}, {
      NCache[
       Log[150], 5.0106352940962555`], 
      FormBox["150", TraditionalForm]}, {
      NCache[
       Log[70], 4.248495242049359], 
      FormBox["70", TraditionalForm]}, {
      NCache[
       Log[700], 6.551080335043404], 
      FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.4849066497880004`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.5649493574615367`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.6390573296152584`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.772588722239781, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.833213344056216, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.8903717578961645`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.9444389791664403`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[40], 3.6888794541139363`], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[60], 4.0943445622221], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.382026634673881, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.499809670330265, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.700480365792417, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.787491742782046, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.867534450455582, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.941642422609304, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.075173815233827, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.135798437050262, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.19295685089021, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.247024072160486, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[400], 5.991464547107982], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[600], 6.396929655216146], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}}}]], "Output",
 CellChangeTimes->{
  3.473688512696578*^9, 3.473688607894437*^9, 3.473688652742248*^9, 
   3.4736887328885717`*^9, 3.4736896757888737`*^9, {3.473698863109199*^9, 
   3.4736988871943007`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"{", 
   RowBox[{"bondtime", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"0.03", " ", 
         RowBox[{"x", "^", "2"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "20", ",", "60", ",", "1"}], "}"}]}], "]"}]}], "}"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.473689910887167*^9, 3.473689911812706*^9}, {
  3.473689993859446*^9, 3.473690076266704*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {Hue[0.67, 0.6, 0.6], 
    PointBox[{{1.6094379124341003`, 1.6980711235394947`}, {2.302585092994046, 
     1.8074044458526306`}, {2.70805020110221, 2.098725897441621}, {
     2.995732273553991, 2.508771033312487}, {3.2188758248682006`, 
     2.9357845319774305`}, {3.4011973816621555`, 3.266025673026033}, {
     3.6888794541139363`, 3.924528781220103}, {3.912023005428146, 
     4.347966880829724}}]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], 
    PointBox[{{2.995732273553991, 2.4849066497880004`}, {3.044522437723423, 
     2.5824869781268642`}, {3.091042453358316, 2.67552700939665}, {
     3.1354942159291497`, 2.7644305345383176`}, {3.1780538303479458`, 
     2.8495497633759097`}, {3.2188758248682006`, 2.9311937524164198`}, {
     3.258096538021482, 3.0096351787229825`}, {3.295836866004329, 
     3.0851158346886765`}, {3.332204510175204, 3.1578511230304263`}, {
     3.367295829986474, 3.2280337626529665`}, {3.4011973816621555`, 
     3.295836866004329}, {3.4339872044851463`, 3.3614165116503107`}, {
     3.4657359027997265`, 3.4249139082794713`}, {3.4965075614664802`, 
     3.4864572256129787`}, {3.5263605246161616`, 3.546163151912341}, {
     3.5553480614894135`, 3.6041382256588457`}, {3.58351893845611, 
     3.660479979592238}, {3.6109179126442243`, 3.7152779279684673`}, {
     3.6375861597263857`, 3.76861442213279}, {3.6635616461296463`, 
     3.8205653949393112`}, {3.6888794541139363`, 3.871201010907891}, {
     3.713572066704308, 3.920586236088634}, {3.7376696182833684`, 
     3.968781339246755}, {3.7612001156935624`, 4.015842334067143}, {
     3.784189633918261, 4.06182137051654}, {3.8066624897703196`, 
     4.1067670822206574`}, {3.828641396489095, 4.150724895658208}, {
     3.8501476017100584`, 4.193737306100135}, {3.871201010907891, 
     4.2358441244958005`}, {3.8918202981106265`, 4.277082698901271}, {
     3.912023005428146, 4.31748811353631}, {3.9318256327243257`, 
     4.35709336812867}, {3.9512437185814275`, 4.395929539842873}, {
     3.970291913552122, 4.434025929784262}, {3.9889840465642745`, 
     4.471410195808567}, {4.007333185232471, 4.5081084731449605`}, {
     4.02535169073515, 4.544145484150317}, {4.04305126783455, 
     4.579544638349119}, {4.060443010546419, 4.614328123772857}, {
     4.07753744390572, 4.648516990491457}, {4.0943445622221, 
     4.68213122712422}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{1.6094379124341003`, 1.6980711235394947`},
  FrameTicks->{{{{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["10", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["100", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["50", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["500", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["20", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["200", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["30", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["300", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["15", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["150", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["70", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["\" \"", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}, {{{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["10", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["100", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["50", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["500", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["20", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["200", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["30", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["300", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["15", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["150", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["70", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["\" \"", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}},
  GridLines->{None, None},
  Method->{CoordinatesToolOptions -> {"DisplayFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{1.6094379124341003`, 4.0943445622221}, {1.6980711235394947`, 
   4.68213122712422}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]},
  Ticks->{{{
      NCache[
       Log[10], 2.302585092994046], 
      FormBox["10", TraditionalForm]}, {
      NCache[
       Log[100], 4.605170185988092], 
      FormBox["100", TraditionalForm]}, {
      NCache[
       Log[50], 3.912023005428146], 
      FormBox["50", TraditionalForm]}, {
      NCache[
       Log[500], 6.214608098422191], 
      FormBox["500", TraditionalForm]}, {
      NCache[
       Log[20], 2.995732273553991], 
      FormBox["20", TraditionalForm]}, {
      NCache[
       Log[200], 5.298317366548036], 
      FormBox["200", TraditionalForm]}, {
      NCache[
       Log[30], 3.4011973816621555`], 
      FormBox["30", TraditionalForm]}, {
      NCache[
       Log[300], 5.703782474656201], 
      FormBox["300", TraditionalForm]}, {
      NCache[
       Log[15], 2.70805020110221], 
      FormBox["15", TraditionalForm]}, {
      NCache[
       Log[150], 5.0106352940962555`], 
      FormBox["150", TraditionalForm]}, {
      NCache[
       Log[70], 4.248495242049359], 
      FormBox["70", TraditionalForm]}, {
      NCache[
       Log[700], 6.551080335043404], 
      FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.4849066497880004`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.5649493574615367`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.6390573296152584`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.772588722239781, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.833213344056216, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.8903717578961645`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.9444389791664403`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[40], 3.6888794541139363`], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[60], 4.0943445622221], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.382026634673881, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.499809670330265, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.700480365792417, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.787491742782046, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.867534450455582, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.941642422609304, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.075173815233827, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.135798437050262, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.19295685089021, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.247024072160486, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[400], 5.991464547107982], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[600], 6.396929655216146], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}}, {{
      NCache[
       Log[10], 2.302585092994046], 
      FormBox["10", TraditionalForm]}, {
      NCache[
       Log[100], 4.605170185988092], 
      FormBox["100", TraditionalForm]}, {
      NCache[
       Log[50], 3.912023005428146], 
      FormBox["50", TraditionalForm]}, {
      NCache[
       Log[500], 6.214608098422191], 
      FormBox["500", TraditionalForm]}, {
      NCache[
       Log[20], 2.995732273553991], 
      FormBox["20", TraditionalForm]}, {
      NCache[
       Log[200], 5.298317366548036], 
      FormBox["200", TraditionalForm]}, {
      NCache[
       Log[30], 3.4011973816621555`], 
      FormBox["30", TraditionalForm]}, {
      NCache[
       Log[300], 5.703782474656201], 
      FormBox["300", TraditionalForm]}, {
      NCache[
       Log[15], 2.70805020110221], 
      FormBox["15", TraditionalForm]}, {
      NCache[
       Log[150], 5.0106352940962555`], 
      FormBox["150", TraditionalForm]}, {
      NCache[
       Log[70], 4.248495242049359], 
      FormBox["70", TraditionalForm]}, {
      NCache[
       Log[700], 6.551080335043404], 
      FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.4849066497880004`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.5649493574615367`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.6390573296152584`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.772588722239781, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.833213344056216, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.8903717578961645`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.9444389791664403`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[40], 3.6888794541139363`], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[60], 4.0943445622221], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.382026634673881, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.499809670330265, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.700480365792417, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.787491742782046, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.867534450455582, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.941642422609304, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.075173815233827, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.135798437050262, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.19295685089021, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.247024072160486, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[400], 5.991464547107982], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[600], 6.396929655216146], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}}}]], "Output",
 CellChangeTimes->{
  3.473689913015164*^9, 3.4736899801537943`*^9, {3.473690023576017*^9, 
   3.473690076822403*^9}, 3.473690246051834*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"{", 
   RowBox[{"rangetime", ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", " ", 
        RowBox[{"5", " ", 
         RowBox[{"x", "^", "1.5"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "1", ",", "7", ",", "0.2"}], "}"}]}], "]"}]}], "}"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.4728153801315193`*^9, 3.4728153866524153`*^9}, {
   3.473056322570342*^9, 3.473056342917746*^9}, {3.4730802276210327`*^9, 
   3.473080237636395*^9}, {3.473665585785161*^9, 3.47366559583848*^9}, {
   3.473665921782916*^9, 3.473665926478747*^9}, {3.473665962843997*^9, 
   3.47366596711484*^9}, {3.4736727224549417`*^9, 3.473672750267853*^9}, {
   3.473673787919228*^9, 3.473673809460073*^9}, {3.473684090915416*^9, 
   3.473684095805015*^9}, {3.473684215508519*^9, 3.473684221169491*^9}, {
   3.473684296256783*^9, 3.47368439662292*^9}, 3.473684475300054*^9, {
   3.473698753377645*^9, 3.473698821142612*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {Hue[0.67, 0.6, 0.6], 
    PointBox[{{0., 2.5104566183209442`}, {0.6931471805599453, 
     2.9819274742724597`}, {1.0986122886681098`, 3.3327958353080316`}, {
     1.3862943611198906`, 3.669678973990754}, {1.6094379124341003`, 
     4.051857206062179}, {1.791759469228055, 4.215862687811397}, {
     1.9459101490553132`, 4.549035401002495}}]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], 
    PointBox[{{0., 1.6094379124341003`}, {0.1823215567939546, 
     1.8829202476250322`}, {0.3364722366212129, 2.11414626736592}, {
     0.47000362924573563`, 2.314443356302704}, {0.5877866649021191, 
     2.491117909787279}, {0.6931471805599453, 2.649158683274018}, {
     0.7884573603642703, 2.7921239529805058`}, {0.8754687373539001, 
     2.9226410184649505`}, {0.9555114450274363, 3.042705079975255}, {
     1.0296194171811581`, 3.1538670382058376`}, {1.0986122886681098`, 
     3.257356345436265}, {1.1631508098056809`, 3.3541641271426217`}, {
     1.2237754316221159`, 3.445101059867274}, {1.2809338454620642`, 
     3.530838680627197}, {1.3350010667323402`, 3.6119395125326106`}, {
     1.3862943611198906`, 3.6888794541139363`}, {1.4350845252893227`, 
     3.7620647003680845`}, {1.4816045409242156`, 3.831844723820424}, {
     1.5260563034950492`, 3.8985223676766743`}, {1.5686159179138455`, 
     3.9623617893048686`}, {1.6094379124341003`, 4.023594781085251}, {
     1.6486586255873816`, 4.082425850815173}, {1.6863989535702288`, 
     4.139036342789444}, {1.7227665977411037`, 4.193587809045756}, {
     1.7578579175523739`, 4.246224788762661}, {1.791759469228055, 
     4.297077116276183}, {1.824549292051046, 4.346261850510669}, {
     1.8562979903656263`, 4.39388489798254}, {1.88706964903238, 
     4.44004238598267}, {1.916922612182061, 4.484821830707192}, {
     1.9459101490553132`, 4.528303136017071}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0., 1.6094379124341003`},
  FrameTicks->{{{{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["10", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["100", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["50", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["500", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["20", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["200", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["30", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["300", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["15", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["150", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["70", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["\" \"", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}, {{{0., 
       FormBox[
        TagBox[
         InterpretationBox["\"1.0\"", 1., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {2.302585092994046, 
       FormBox[
        TagBox[
         InterpretationBox["\"10.0\"", 10., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {1.6094379124341003`, 
       FormBox[
        TagBox[
         InterpretationBox["\"5.0\"", 5., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {3.912023005428146, 
       FormBox[
        TagBox[
         InterpretationBox["\"50.0\"", 50., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {0.6931471805599453, 
       FormBox[
        TagBox[
         InterpretationBox["\"2.0\"", 2., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {2.995732273553991, 
       FormBox[
        TagBox[
         InterpretationBox["\"20.0\"", 20., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {1.0986122886681098`, 
       FormBox[
        TagBox[
         InterpretationBox["\"3.0\"", 3., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {3.4011973816621555`, 
       FormBox[
        TagBox[
         InterpretationBox["\"30.0\"", 30., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {0.4054651081081644, 
       FormBox[
        TagBox[
         InterpretationBox["\"1.5\"", 1.5, AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {2.70805020110221, 
       FormBox[
        TagBox[
         InterpretationBox["\"15.0\"", 15., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {1.9459101490553132`, 
       FormBox[
        TagBox[
         InterpretationBox["\"7.0\"", 7., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {4.248495242049359, 
       FormBox[
        TagBox[
         InterpretationBox["\"70.0\"", 70., AutoDelete -> True], 
         NumberForm[#, {
           DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
        TraditionalForm]}, {0.09531017980432493, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.1823215567939548, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.26236426446749106`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.336472236621213, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.47000362924573563`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.5306282510621705, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.5877866649021191, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.6418538861723948, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[4], 1.3862943611198906`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[6], 1.791759469228055], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.0794415416798357`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.1972245773362196`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{0., 
       FormBox["\" \"", TraditionalForm]}, {2.302585092994046, 
       FormBox["\" \"", TraditionalForm]}, {1.6094379124341003`, 
       FormBox["\" \"", TraditionalForm]}, {3.912023005428146, 
       FormBox["\" \"", TraditionalForm]}, {0.6931471805599453, 
       FormBox["\" \"", TraditionalForm]}, {2.995732273553991, 
       FormBox["\" \"", TraditionalForm]}, {1.0986122886681098`, 
       FormBox["\" \"", TraditionalForm]}, {3.4011973816621555`, 
       FormBox["\" \"", TraditionalForm]}, {0.4054651081081644, 
       FormBox["\" \"", TraditionalForm]}, {2.70805020110221, 
       FormBox["\" \"", TraditionalForm]}, {1.9459101490553132`, 
       FormBox["\" \"", TraditionalForm]}, {4.248495242049359, 
       FormBox["\" \"", TraditionalForm]}, {0.09531017980432493, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.1823215567939548, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.26236426446749106`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.336472236621213, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.47000362924573563`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.5306282510621705, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.5877866649021191, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {0.6418538861723948, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[4], 1.3862943611198906`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[6], 1.791759469228055], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.0794415416798357`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.1972245773362196`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}},
  GridLines->{None, None},
  Method->{CoordinatesToolOptions -> {"DisplayFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 1.9459101490553132`}, {1.6094379124341003`, 
   4.549035401002495}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]},
  Ticks->{{{0., 
      FormBox[
       TagBox[
        InterpretationBox["\"1.0\"", 1., AutoDelete -> True], NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {2.302585092994046, 
      FormBox[
       TagBox[
        InterpretationBox["\"10.0\"", 10., AutoDelete -> True], 
        NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {1.6094379124341003`, 
      FormBox[
       TagBox[
        InterpretationBox["\"5.0\"", 5., AutoDelete -> True], NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {3.912023005428146, 
      FormBox[
       TagBox[
        InterpretationBox["\"50.0\"", 50., AutoDelete -> True], 
        NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {0.6931471805599453, 
      FormBox[
       TagBox[
        InterpretationBox["\"2.0\"", 2., AutoDelete -> True], NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {2.995732273553991, 
      FormBox[
       TagBox[
        InterpretationBox["\"20.0\"", 20., AutoDelete -> True], 
        NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {1.0986122886681098`, 
      FormBox[
       TagBox[
        InterpretationBox["\"3.0\"", 3., AutoDelete -> True], NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {3.4011973816621555`, 
      FormBox[
       TagBox[
        InterpretationBox["\"30.0\"", 30., AutoDelete -> True], 
        NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {0.4054651081081644, 
      FormBox[
       TagBox[
        InterpretationBox["\"1.5\"", 1.5, AutoDelete -> True], 
        NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {2.70805020110221, 
      FormBox[
       TagBox[
        InterpretationBox["\"15.0\"", 15., AutoDelete -> True], 
        NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {1.9459101490553132`, 
      FormBox[
       TagBox[
        InterpretationBox["\"7.0\"", 7., AutoDelete -> True], NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {4.248495242049359, 
      FormBox[
       TagBox[
        InterpretationBox["\"70.0\"", 70., AutoDelete -> True], 
        NumberForm[#, {
          DirectedInfinity[1], 1}, NumberPadding -> {"", "0"}]& ], 
       TraditionalForm]}, {0.09531017980432493, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {0.1823215567939548, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {0.26236426446749106`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {0.336472236621213, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {0.47000362924573563`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {0.5306282510621705, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {0.5877866649021191, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {0.6418538861723948, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[4], 1.3862943611198906`], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[6], 1.791759469228055], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.0794415416798357`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.1972245773362196`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.3978952727983707`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.4849066497880004`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.5649493574615367`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.6390573296152584`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.772588722239781, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.833213344056216, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.8903717578961645`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.9444389791664403`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[40], 3.6888794541139363`], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[60], 4.0943445622221], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}}, {{
      NCache[
       Log[10], 2.302585092994046], 
      FormBox["10", TraditionalForm]}, {
      NCache[
       Log[100], 4.605170185988092], 
      FormBox["100", TraditionalForm]}, {
      NCache[
       Log[50], 3.912023005428146], 
      FormBox["50", TraditionalForm]}, {
      NCache[
       Log[500], 6.214608098422191], 
      FormBox["500", TraditionalForm]}, {
      NCache[
       Log[20], 2.995732273553991], 
      FormBox["20", TraditionalForm]}, {
      NCache[
       Log[200], 5.298317366548036], 
      FormBox["200", TraditionalForm]}, {
      NCache[
       Log[30], 3.4011973816621555`], 
      FormBox["30", TraditionalForm]}, {
      NCache[
       Log[300], 5.703782474656201], 
      FormBox["300", TraditionalForm]}, {
      NCache[
       Log[15], 2.70805020110221], 
      FormBox["15", TraditionalForm]}, {
      NCache[
       Log[150], 5.0106352940962555`], 
      FormBox["150", TraditionalForm]}, {
      NCache[
       Log[70], 4.248495242049359], 
      FormBox["70", TraditionalForm]}, {
      NCache[
       Log[700], 6.551080335043404], 
      FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.4849066497880004`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.5649493574615367`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.6390573296152584`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.772588722239781, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.833213344056216, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.8903717578961645`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.9444389791664403`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[40], 3.6888794541139363`], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[60], 4.0943445622221], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.382026634673881, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.499809670330265, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.700480365792417, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.787491742782046, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.867534450455582, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.941642422609304, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.075173815233827, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.135798437050262, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.19295685089021, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.247024072160486, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[400], 5.991464547107982], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[600], 6.396929655216146], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}}}]], "Output",
 CellChangeTimes->{{3.473665926753293*^9, 3.473665967597681*^9}, 
   3.473666022821186*^9, 3.473666063944489*^9, 3.4736661963595753`*^9, 
   3.473666495900382*^9, 3.473669928953808*^9, 3.473670035684579*^9, 
   3.473672109354681*^9, 3.4736722124294987`*^9, {3.473672306272559*^9, 
   3.4736723105537653`*^9}, 3.473672539402351*^9, 3.47367264503339*^9, {
   3.473672710739794*^9, 3.473672750889018*^9}, 3.47367311752007*^9, {
   3.473673782113449*^9, 3.473673810057729*^9}, 3.4736840964700737`*^9, 
   3.473684221796041*^9, {3.4736843008769093`*^9, 3.473684397441234*^9}, 
   3.473684475590918*^9, 3.473685386463963*^9, 3.4736858408425303`*^9, 
   3.473688733110826*^9, {3.473698746219401*^9, 3.473698821895994*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"energ", "[", 
        RowBox[{"[", 
         RowBox[{"n", "+", "1"}], "]"}], "]"}], "-", 
       RowBox[{"energ", "[", 
        RowBox[{"[", "n", "]"}], "]"}]}], ")"}], "/", 
     RowBox[{"energ", "[", 
      RowBox[{"[", "n", "]"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "1", ",", 
      RowBox[{
       RowBox[{"Length", "[", "energ", "]"}], "-", "1"}]}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.473056293887156*^9, 3.473056296774456*^9}, {
  3.473056394841578*^9, 3.47305645890702*^9}, {3.473080312951886*^9, 
  3.4730803170549793`*^9}, {3.473138399596768*^9, 3.4731384100569067`*^9}, {
  3.473684429294532*^9, 3.473684432635769*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {Hue[0.67, 0.6, 0.6], 
    PointBox[{{0., -1.144125462910716}, {
     0.6931471805599453, -1.178010983773374}, {
     1.0986122886681098`, -1.4949241744935335`}, {
     1.3862943611198906`, -1.8858470565068999`}, {
     1.6094379124341003`, -1.8735634282269504`}, {
     1.791759469228055, -2.0621492251234104`}, {
     1.9459101490553132`, -2.2474489148240577`}, {
     2.0794415416798357`, -2.3106283680487376`}, {
     2.1972245773362196`, -2.1226286063588575`}, {
     2.302585092994046, -2.2347466902059416`}, {
     2.3978952727983707`, -2.0831713077407787`}, {
     2.4849066497880004`, -2.5391375789776345`}, {
     2.5649493574615367`, -2.1792155934555093`}, {
     2.6390573296152584`, -3.3491398869929747`}, {
     2.772588722239781, -34.36228829946043}, {
     2.833213344056216, -36.308198448515746`}, {
     2.8903717578961645`, -34.51643897928769}, {
     2.9444389791664403`, -36.308198448515746`}, {
     3.258096538021482, -13.043606771979793`}, {
     3.295836866004329, -12.424247222471859`}, {
     3.332204510175204, -13.037275835385486`}, {
     3.367295829986474, -14.603501796642897`}, {
     3.4011973816621555`, -19.140493264996124`}, {
     3.4339872044851463`, -16.82833560862407}, {
     3.4657359027997265`, -20.187203002027513`}, {
     3.4965075614664802`, -22.467264910977214`}, {
     3.5263605246161616`, -26.165899737362047`}, {
     3.5553480614894135`, -34.36229717154641}, {
     3.6109179126442243`, -36.30820732060172}, {
     3.6375861597263857`, -36.30820732060172}, {
     3.713572066704308, -35.61506014004178}, {
     3.784189633918261, -34.51644785137366}, {
     3.8501476017100584`, -33.74325796314018}, {
     3.871201010907891, -34.22876577892188}, {
     3.8918202981106265`, -32.300874135369256`}, {
     3.912023005428146, -33.53561859836195}, {
     3.9318256327243257`, -32.18107293555664}, {
     3.9512437185814275`, -31.10420063352495}, {
     3.970291913552122, -32.501544830831456`}, {
     3.9889840465642745`, -35.209595031933674`}, {
     4.007333185232471, -34.698769408167685`}, {
     4.02535169073515, -36.30820732060179}, {
     4.04305126783455, -35.61506014004184}, {
     4.07753744390572, -35.61506014004184}, {
     4.127134385045092, -36.30820732060179}, {
     4.219507705176107, -34.51644785137373}, {
     4.248495242049359, -34.110982743265566`}, {
     4.2626798770413155`, -36.30820732060178}, {
     4.30406509320417, -36.30820732060178}, {
     4.330733340286331, -35.61506014004184}, {
     4.343805421853684, -34.921912959481894`}, {
     4.356708826689592, -36.30820732060179}, {
     4.3694478524670215`, -35.61506014004184}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0., -36.30820732060179},
  FrameTicks->{{{{-36.841361487904734`, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "16"}], Power, Editable -> True, Selectable -> True]],
          
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-29.933606208922594`, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "13"}], Power, Editable -> True, Selectable -> True]],
          
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-23.025850929940457`, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "10"}], Power, Editable -> True, Selectable -> True]],
          
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-16.11809565095832, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "7"}], Power, Editable -> True, Selectable -> True]], 
         
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-9.210340371976182, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "4"}], Power, Editable -> True, Selectable -> True]], 
         
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-2.3025850929940455`, 
       FormBox["0.1`", TraditionalForm]}, {-32.12286261660964, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-31.434189716444614`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-31.03022049492803, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.74328720573849, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.52059319365415, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.338571441989107`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.18463496372634, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.051264252390826`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-25.2151073376275, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-24.526434437462473`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-24.122465215945894`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.835531926756353`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.61283791467201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.43081616300697, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.276879684744202`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.14350897340869, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-18.307352058645364`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-17.618679158480337`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-17.214709936963757`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.927776647774216`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.705082635689873`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.523060884024833`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.369124405762065`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.235753694426553`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-11.399596779663225`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.710923879498202`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.306954657981619`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.02002136879208, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.797327356707738, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.615305605042696, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.461369126779928, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.327998415444416, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-4.491841500681089, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.803168600516064, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.3991993789994823`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.1122660898099426`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.8895720777256004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.707550326060559, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.553613847797791, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.420243136462278, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{-36.841361487904734`, 
       FormBox["\" \"", TraditionalForm]}, {-29.933606208922594`, 
       FormBox["\" \"", TraditionalForm]}, {-23.025850929940457`, 
       FormBox["\" \"", TraditionalForm]}, {-16.11809565095832, 
       FormBox["\" \"", TraditionalForm]}, {-9.210340371976182, 
       FormBox["\" \"", TraditionalForm]}, {-2.3025850929940455`, 
       FormBox["\" \"", TraditionalForm]}, {-32.12286261660964, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-31.434189716444614`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-31.03022049492803, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.74328720573849, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.52059319365415, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.338571441989107`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.18463496372634, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.051264252390826`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-25.2151073376275, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-24.526434437462473`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-24.122465215945894`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.835531926756353`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.61283791467201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.43081616300697, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.276879684744202`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.14350897340869, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-18.307352058645364`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-17.618679158480337`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-17.214709936963757`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.927776647774216`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.705082635689873`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.523060884024833`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.369124405762065`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.235753694426553`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-11.399596779663225`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.710923879498202`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.306954657981619`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.02002136879208, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.797327356707738, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.615305605042696, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.461369126779928, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.327998415444416, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-4.491841500681089, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.803168600516064, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.3991993789994823`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.1122660898099426`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.8895720777256004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.707550326060559, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.553613847797791, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.420243136462278, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}, {{{0, 
       FormBox["1", TraditionalForm]}, {
       NCache[
        Log[2], 0.6931471805599453], 
       FormBox["2", TraditionalForm]}, {
       NCache[
        Log[5], 1.6094379124341003`], 
       FormBox["5", TraditionalForm]}, {
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["10", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["20", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["50", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["100", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["200", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["500", TraditionalForm]}, {1.0986122886681098`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.3862943611198906`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.791759469228055, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.9459101490553132`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.0794415416798357`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.1972245773362196`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.4011973816621555`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.6888794541139363`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.0943445622221, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.248495242049359, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.703782474656201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.991464547107982, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{0, 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[2], 0.6931471805599453], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[5], 1.6094379124341003`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["\" \"", TraditionalForm]}, {1.0986122886681098`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.3862943611198906`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.791759469228055, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.9459101490553132`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.0794415416798357`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.1972245773362196`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.4011973816621555`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.6888794541139363`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.0943445622221, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.248495242049359, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.703782474656201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.991464547107982, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}},
  GridLines->{None, None},
  Method->{CoordinatesToolOptions -> {"DisplayFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 4.3694478524670215`}, {-36.30820732060179, 0.}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]},
  Ticks->FrontEndValueCache[{{{0., 
       FormBox["1", TraditionalForm]}, {0.6931471805599453, 
       FormBox["2", TraditionalForm]}, {1.6094379124341003`, 
       FormBox["5", TraditionalForm]}, {2.302585092994046, 
       FormBox["10", TraditionalForm]}, {2.995732273553991, 
       FormBox["20", TraditionalForm]}, {3.912023005428146, 
       FormBox["50", TraditionalForm]}, {4.605170185988092, 
       FormBox["100", TraditionalForm]}, {5.298317366548036, 
       FormBox["200", TraditionalForm]}, {6.214608098422191, 
       FormBox["500", TraditionalForm]}, {1.0986122886681098`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.3862943611198906`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.791759469228055, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.9459101490553132`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.0794415416798357`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.1972245773362196`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.4011973816621555`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.6888794541139363`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.0943445622221, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.248495242049359, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.703782474656201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.991464547107982, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{-36.841361487904734`, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "16"}], Power, Editable -> True, Selectable -> True]],
          
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-29.933606208922594`, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "13"}], Power, Editable -> True, Selectable -> True]],
          
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-23.025850929940457`, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "10"}], Power, Editable -> True, Selectable -> True]],
          
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-16.11809565095832, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "7"}], Power, Editable -> True, Selectable -> True]], 
         
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-9.210340371976182, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "4"}], Power, Editable -> True, Selectable -> True]], 
         
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-2.3025850929940455`, 
       FormBox["0.1`", TraditionalForm]}, {-32.12286261660964, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-31.434189716444614`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-31.03022049492803, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.74328720573849, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.52059319365415, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.338571441989107`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.18463496372634, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.051264252390826`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-25.2151073376275, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-24.526434437462473`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-24.122465215945894`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.835531926756353`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.61283791467201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.43081616300697, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.276879684744202`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.14350897340869, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-18.307352058645364`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-17.618679158480337`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-17.214709936963757`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.927776647774216`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.705082635689873`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.523060884024833`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.369124405762065`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.235753694426553`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-11.399596779663225`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.710923879498202`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.306954657981619`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.02002136879208, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.797327356707738, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.615305605042696, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.461369126779928, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.327998415444416, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-4.491841500681089, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.803168600516064, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.3991993789994823`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.1122660898099426`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.8895720777256004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.707550326060559, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.553613847797791, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.420243136462278, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}, {{{0., 
       FormBox["1", TraditionalForm]}, {0.6931471805599453, 
       FormBox["2", TraditionalForm]}, {1.6094379124341003`, 
       FormBox["5", TraditionalForm]}, {2.302585092994046, 
       FormBox["10", TraditionalForm]}, {2.995732273553991, 
       FormBox["20", TraditionalForm]}, {3.912023005428146, 
       FormBox["50", TraditionalForm]}, {4.605170185988092, 
       FormBox["100", TraditionalForm]}, {5.298317366548036, 
       FormBox["200", TraditionalForm]}, {6.214608098422191, 
       FormBox["500", TraditionalForm]}, {1.0986122886681098`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.3862943611198906`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.791759469228055, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {1.9459101490553132`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.0794415416798357`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.1972245773362196`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.4011973816621555`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {3.6888794541139363`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.0943445622221, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.248495242049359, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.703782474656201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.991464547107982, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{-36.841361487904734`, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "16"}], Power, Editable -> True, Selectable -> True]],
          
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-29.933606208922594`, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "13"}], Power, Editable -> True, Selectable -> True]],
          
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-23.025850929940457`, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "10"}], Power, Editable -> True, Selectable -> True]],
          
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-16.11809565095832, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "7"}], Power, Editable -> True, Selectable -> True]], 
         
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-9.210340371976182, 
       FormBox[
        TagBox[
         SuperscriptBox[
          TagBox["10", Power, Editable -> True, Selectable -> True], 
          TagBox[
           RowBox[{"-", "4"}], Power, Editable -> True, Selectable -> True]], 
         
         InterpretTemplate[Superscript[#, #2]& ], Editable -> False, 
         Selectable -> False], TraditionalForm]}, {-2.3025850929940455`, 
       FormBox["0.1`", TraditionalForm]}, {-32.12286261660964, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-31.434189716444614`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-31.03022049492803, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.74328720573849, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.52059319365415, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.338571441989107`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.18463496372634, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-30.051264252390826`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-25.2151073376275, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-24.526434437462473`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-24.122465215945894`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.835531926756353`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.61283791467201, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.43081616300697, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.276879684744202`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-23.14350897340869, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-18.307352058645364`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-17.618679158480337`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-17.214709936963757`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.927776647774216`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.705082635689873`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.523060884024833`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.369124405762065`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-16.235753694426553`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-11.399596779663225`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.710923879498202`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.306954657981619`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-10.02002136879208, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.797327356707738, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.615305605042696, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.461369126779928, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-9.327998415444416, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-4.491841500681089, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.803168600516064, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.3991993789994823`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-3.1122660898099426`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.8895720777256004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.707550326060559, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.553613847797791, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {-2.420243136462278, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}]]], "Output",
 CellChangeTimes->{
  3.4730562972224407`*^9, {3.4730564374442*^9, 3.473056459619141*^9}, {
   3.473138405818574*^9, 3.4731384104820223`*^9}, 3.4731444545140743`*^9, 
   3.473661957436064*^9, 3.4736620703749247`*^9, {3.473684404143838*^9, 
   3.47368443351276*^9}, 3.47368584579375*^9, 3.473690380033053*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsLinkActive", "[", "]"}]], "Input",
 CellChangeTimes->{{3.4728195681209793`*^9, 3.47281957639885*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.4728195768134823`*^9, {3.472819667331148*^9, 3.472819682911303*^9}, 
   3.472975279034401*^9, 3.4729871917641973`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Time and convergence testing", "Section",
 CellChangeTimes->{{3.472533194200151*^9, 3.472533196577317*^9}, {
  3.472533562898365*^9, 3.47253356472183*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsLinkActive", "[", "]"}]], "Input",
 CellChangeTimes->{{3.4731403688256598`*^9, 3.473140371632908*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.473140372120056*^9, 3.4736167908645887`*^9, 3.473656296145355*^9, 
   3.473656913209631*^9, 3.473657742197822*^9, 3.473685852587248*^9, 
   3.473686152076408*^9, 3.4736865386646643`*^9, {3.473687005240094*^9, 
   3.473687007138276*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tensors", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntRange", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bondtiming", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"MemoryConstrained", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"bond", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tiempo", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"mps", "=", 
                RowBox[{"MPSProductState", "[", 
                 RowBox[{"tensors", ",", 
                  RowBox[{"BondDimension", "\[Rule]", "bond"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"MPSCanonize", "[", "mps", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"HMatrix", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Piecewise", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.0", ",", 
                    RowBox[{"n", "\[Equal]", "m"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "\[Equal]", "3"}], ",", "1.0", ",", 
                    RowBox[{"-", "0.3"}]}], "]"}], "/", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"n", "-", "m"}], "]"}], "^", "3"}]}], ",", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"n", "-", "m"}], "]"}], "\[LessEqual]", 
                    "IntRange"}]}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "1", ",", "numTensors"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", "numTensors"}], "}"}]}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"tiempo", "+=", 
                RowBox[{
                 RowBox[{"AbsoluteTiming", "[", 
                  RowBox[{"MPSMinimizeEnergy", "[", 
                   RowBox[{"mps", ",", "HMatrix", ",", 
                    RowBox[{"InteractionRange", "\[Rule]", "IntRange"}]}], 
                   "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}], ";"}], 
              "\[IndentingNewLine]", ",", 
              RowBox[{"{", 
               RowBox[{"tt", ",", "1", ",", "10"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tiempo", "/", "10"}]}]}], "\[IndentingNewLine]", "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"bond", ",", "5", ",", "12", ",", "1"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"1024", " ", "1024", " ", "1024"}]}], "]"}], ",", 
     RowBox[{"\"\<Bond dimension: \>\"", "<>", 
      RowBox[{"ToString", "[", "bond", "]"}], "<>", "\"\<, mem: \>\"", "<>", 
      RowBox[{"ToString", "[", 
       RowBox[{
        RowBox[{"MemoryInUse", "[", "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"1024.", " ", "1024"}], ")"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.472533206361817*^9, 3.472533310599462*^9}, {
   3.47253357335925*^9, 3.472533632412365*^9}, {3.472815475457052*^9, 
   3.472815505646517*^9}, {3.472816834919277*^9, 3.472816834987876*^9}, {
   3.473140289989777*^9, 3.473140325016049*^9}, {3.473140378563417*^9, 
   3.473140430544751*^9}, {3.4731405939203463`*^9, 3.4731405976233883`*^9}, {
   3.473140638772966*^9, 3.473140655251041*^9}, {3.473143928797657*^9, 
   3.4731439290993137`*^9}, 3.473144502395974*^9, {3.473144542492743*^9, 
   3.473144546389288*^9}, {3.473656319409913*^9, 3.473656351966585*^9}, {
   3.473657691082411*^9, 3.473657691148744*^9}, {3.473657798797962*^9, 
   3.473657826154717*^9}, {3.473657948679031*^9, 3.473657953031942*^9}, {
   3.473685888908979*^9, 3.473685906772355*^9}, 3.473685946527021*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Unable to write data to closed link \
\\!\\(LinkObject[\\(\\(\\\"/Users/fercook/Mathematica/MPS/arpackformps\\\", \
11452, 8\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkw\\\", ButtonNote -> \
\\\"LinkObject::linkw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473686029318755*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({energy$25125, new$25125, info$25125}\\) and \
\\!\\($Failed\\) are not the same shape. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4736860293446627`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Unable to write data to closed link \
\\!\\(LinkObject[\\(\\(\\\"/Users/fercook/Mathematica/MPS/arpackformps\\\", \
11452, 8\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkw\\\", ButtonNote -> \
\\\"LinkObject::linkw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4736860293806057`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({energy$25125, new$25125, info$25125}\\) and \
\\!\\($Failed\\) are not the same shape. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473686029384761*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Unable to write data to closed link \
\\!\\(LinkObject[\\(\\(\\\"/Users/fercook/Mathematica/MPS/arpackformps\\\", \
11452, 8\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkw\\\", ButtonNote -> \
\\\"LinkObject::linkw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473686029388093*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(LinkObject :: \\\"linkw\\\"\\) \
will be suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4736860293913717`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({energy$25125, new$25125, info$25125}\\) and \
\\!\\($Failed\\) are not the same shape. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473686029394524*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Set :: \\\"shape\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4736860293988256`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \
\\!\\({\\(\\({\\(\\(\\(\\(-0.6854450170566991`\\)\\) - \
\\(\\(4.23598080331127`*^-22\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\
\[LeftSkeleton] 6 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(-2.6963868441830884`*^-8\\)\\) + \
\\(\\(1.4092542144715643`*^-6\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\(\
\[LeftSkeleton] 6 \[RightSkeleton]\\)\\), \\(\\({\\(\\(\\(\\(\[LeftSkeleton] \
23 \[RightSkeleton]\\)\\) + \\(\\(\\(\\(\[LeftSkeleton] 22 \
\[RightSkeleton]\\)\\)\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\), \\(\\(\\(\\(\\(\[LeftSkeleton] 21 \[RightSkeleton]\\) \
\[InvisibleSpace]\\)\\) + \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)\\)\\)}\\)\\)}\\) and \
\\!\\({\\(\\({\\(\\(\\(\\(-0.006988651871038254`\\)\\) - \
\\(\\(0.0005412787421613406`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(0.6677268687709503` \[InvisibleSpace]\\)\\) + \
\\(\\(0.22921726315331184`\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\(\
\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \
\\(\\({\\(\\(\\(\\(0.0011258000722253133` \[InvisibleSpace]\\)\\) + \\(\\(\\(\
\\(\[LeftSkeleton] 22 \[RightSkeleton]\\)\\)\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\)}\\) have incompatible \
shapes. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473686029432859*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \
\\!\\({\\(\\({\\(\\(\\(\\(-0.6854450170566991`\\)\\) - \
\\(\\(4.23598080331127`*^-22\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\
\[LeftSkeleton] 6 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(-2.6963868441830884`*^-8\\)\\) + \
\\(\\(1.4092542144715643`*^-6\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\(\
\[LeftSkeleton] 6 \[RightSkeleton]\\)\\), \\(\\({\\(\\(\\(\\(\[LeftSkeleton] \
23 \[RightSkeleton]\\)\\) + \\(\\(\\(\\(\[LeftSkeleton] 22 \
\[RightSkeleton]\\)\\)\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\), \\(\\(\\(\\(\\(\[LeftSkeleton] 21 \[RightSkeleton]\\) \
\[InvisibleSpace]\\)\\) + \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)\\)\\)}\\)\\)}\\) and \
\\!\\({\\(\\({\\(\\(\\(\\(-0.19864682136207754`\\)\\) - \
\\(\\(0.6797363506411279`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.00021445675928797813`\\)\\) - \\(\\(0.007002052864631421`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\
\\), \\(\\({\\(\\(\\(\\(0.0019978889585527838` \[InvisibleSpace]\\)\\) - \
\\(\\(\\(\\(\[LeftSkeleton] 21 \[RightSkeleton]\\)\\)\\\\ \[ImaginaryI]\\)\\)\
\\)\\), \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\)}\\) have \
incompatible shapes. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4736860294627333`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \
\\!\\({\\(\\({\\(\\(\\(\\(-0.6854450170566991`\\)\\) - \
\\(\\(4.23598080331127`*^-22\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\
\[LeftSkeleton] 6 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(-2.6963868441830884`*^-8\\)\\) + \
\\(\\(1.4092542144715643`*^-6\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\(\
\[LeftSkeleton] 6 \[RightSkeleton]\\)\\), \\(\\({\\(\\(\\(\\(\[LeftSkeleton] \
23 \[RightSkeleton]\\)\\) + \\(\\(\\(\\(\[LeftSkeleton] 22 \
\[RightSkeleton]\\)\\)\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 6 \
\[RightSkeleton]\\)\\), \\(\\(\\(\\(\\(\[LeftSkeleton] 21 \[RightSkeleton]\\) \
\[InvisibleSpace]\\)\\) + \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)\\)\\)}\\)\\)}\\) and \
\\!\\({\\(\\({\\(\\(-0.6503908024470819`\\)\\) - \
\\(\\(0.7595351122405158`\\\\ \[ImaginaryI]\\)\\)}\\)\\), \
\\(\\({\\(\\(-0.008127487317186561`\\)\\) - \\(\\(0.005671094774110765`\\\\ \
\[ImaginaryI]\\)\\)}\\)\\)}\\) have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473686029495678*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Dot :: \\\"dotsh\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4736860295311813`*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.473657720661592*^9, 3.4736580837799664`*^9, 
  3.4736859316682997`*^9, 3.473686033403667*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"bond", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"IntRange", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Ntiming", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"MemoryConstrained", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tensors", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"mps", "=", 
             RowBox[{"MPSProductState", "[", 
              RowBox[{"tensors", ",", 
               RowBox[{"BondDimension", "\[Rule]", "bond"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"MPSCanonize", "[", "mps", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"HMatrix", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Piecewise", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.2"}], ",", 
                    RowBox[{"n", "\[Equal]", "m"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"\[Alpha]", "\[Equal]", "3"}], ",", "1.0", ",", 
                    RowBox[{"-", "0.3"}]}], "]"}], "/", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"n", "-", "m"}], "]"}], "^", "3"}]}], ",", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"n", "-", "m"}], "]"}], "\[LessEqual]", 
                    "IntRange"}]}], "}"}]}], "}"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"n", ",", "1", ",", "tensors"}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "1", ",", "tensors"}], "}"}]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"AbsoluteTiming", "[", 
             RowBox[{"MPSMinimizeEnergy", "[", 
              RowBox[{"mps", ",", "HMatrix", ",", 
               RowBox[{"InteractionRange", "\[Rule]", "IntRange"}]}], "]"}], 
             "]"}]}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"tensors", ",", "50", ",", "100", ",", "5"}], "}"}]}], 
        "]"}], ",", 
       RowBox[{"1024", " ", "1024", " ", "1024"}]}], "]"}], ",", 
     RowBox[{"\"\<Chain Length: \>\"", "<>", 
      RowBox[{"ToString", "[", "tensors", "]"}]}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.47314455796456*^9, 3.473144595970148*^9}, {
  3.473686112040053*^9, 3.4736861381310043`*^9}, {3.4736861741221333`*^9, 
  3.473686182453721*^9}, {3.4736866419736853`*^9, 3.473686642532386*^9}, {
  3.4736868426732807`*^9, 3.473686843942771*^9}, {3.473687002247925*^9, 
  3.473687002310481*^9}, {3.473687429877346*^9, 3.473687433276894*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLogLogPlot", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"#", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{"#", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
     "Ntiming"}], ",", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"0.01", " ", 
         RowBox[{"x", "^", "1.5"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "50", ",", "100", ",", "2"}], "}"}]}], "]"}]}], 
   "}"}], "]"}]], "Input",
 CellChangeTimes->{
  3.473158278540865*^9, {3.473158385217073*^9, 3.473158457938088*^9}, {
   3.473687090158071*^9, 3.4736871130027027`*^9}, {3.473687608574464*^9, 
   3.473687634026523*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, 
   {Hue[0.67, 0.6, 0.6], 
    PointBox[{{3.912023005428146, 2.2966471985406702`}, {4.007333185232471, 
     2.161570226036591}, {4.0943445622221, 2.545509938043543}, {
     4.174387269895637, 2.2968899061611054`}, {4.248495242049359, 
     2.7013218162022175`}, {4.31748811353631, 2.4357719887863483`}, {
     4.382026634673881, 2.7979526947834716`}, {4.442651256490317, 
     2.566548386025973}, {4.499809670330265, 3.021113283291008}, {
     4.553876891600541, 2.69004602761804}, {4.605170185988092, 
     2.99800429056751}}]}, 
   {Hue[0.9060679774997897, 0.6, 0.6], 
    PointBox[{{3.912023005428146, 1.2628643221541278`}, {3.9512437185814275`, 
     1.3216953918840497`}, {3.9889840465642745`, 1.3783058838583202`}, {
     4.02535169073515, 1.4328573501146324`}, {4.060443010546419, 
     1.4854943298315377`}, {4.0943445622221, 1.5363466573450597`}, {
     4.127134385045092, 1.585531391579546}, {4.1588830833596715`, 
     1.6331544390514163`}, {4.189654742026425, 1.6793119270515469`}, {
     4.219507705176107, 1.7240913717760686`}, {4.248495242049359, 
     1.767572677085947}, {4.276666119016055, 1.8098289925359916`}, {
     4.30406509320417, 1.8509274538181633`}, {4.330733340286331, 
     1.8909298244414052`}, {4.356708826689592, 1.9298930540462962`}, {
     4.382026634673881, 1.9678697660227311`}, {4.406719247264253, 
     2.004908684908288}, {4.430816798843313, 2.041055012276879}, {
     4.454347296253507, 2.0763507583921705`}, {4.477336814478207, 
     2.1108350357292185`}, {4.499809670330265, 2.144544319507306}, {
     4.5217885770490405`, 2.1775126795854693`}, {4.543294782270004, 
     2.2097719874169144`}, {4.564348191467836, 2.241352101213663}, {
     4.584967478670572, 2.2722810320177667`}, {4.605170185988092, 
     2.302585092994046}}]}, {}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{3.912023005428146, 1.2628643221541278`},
  FrameTicks->{{{{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["10", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["100", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["50", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["500", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["20", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["200", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["30", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["300", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["15", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["150", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["70", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}, {{
       NCache[
        Log[10], 2.302585092994046], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[100], 4.605170185988092], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[50], 3.912023005428146], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[500], 6.214608098422191], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[20], 2.995732273553991], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[200], 5.298317366548036], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[30], 3.4011973816621555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[300], 5.703782474656201], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[15], 2.70805020110221], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[150], 5.0106352940962555`], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[70], 4.248495242049359], 
       FormBox["\" \"", TraditionalForm]}, {
       NCache[
        Log[700], 6.551080335043404], 
       FormBox["\" \"", TraditionalForm]}, {2.3978952727983707`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.4849066497880004`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.5649493574615367`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.6390573296152584`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.772588722239781, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.833213344056216, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.8903717578961645`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {2.9444389791664403`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[40], 3.6888794541139363`], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[60], 4.0943445622221], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.700480365792417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.787491742782046, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.867534450455582, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {4.941642422609304, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.075173815233827, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.135798437050262, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.19295685089021, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {5.247024072160486, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[400], 5.991464547107982], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}, {
       NCache[
        Log[600], 6.396929655216146], 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        Thickness[0.001]}}}}, {{{3.912023005428146, 
       FormBox["50.`", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.0943445622221, 
       FormBox["60.`", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.248495242049359, 
       FormBox["70.`", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.382026634673881, 
       FormBox["80.`", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.499809670330265, 
       FormBox["90.`", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.605170185988092, 
       FormBox["100.`", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {3.9512437185814275`, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {3.9889840465642745`, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.02535169073515, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.060443010546419, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.127134385045092, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.1588830833596715`, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.189654742026425, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.219507705176107, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.276666119016055, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.30406509320417, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.330733340286331, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.356708826689592, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.406719247264253, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.430816798843313, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.454347296253507, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.477336814478207, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.5217885770490405`, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.543294782270004, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.564348191467836, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.584967478670572, 
       FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}}, {{3.912023005428146, 
       FormBox["\" \"", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.0943445622221, 
       FormBox["\" \"", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.248495242049359, 
       FormBox["\" \"", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.382026634673881, 
       FormBox["\" \"", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.499809670330265, 
       FormBox["\" \"", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {4.605170185988092, 
       FormBox["\" \"", TraditionalForm], {0.00625, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.25]}}, {3.9512437185814275`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {3.9889840465642745`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.02535169073515, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.060443010546419, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.127134385045092, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.1588830833596715`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.189654742026425, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.219507705176107, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.276666119016055, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.30406509320417, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.330733340286331, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.356708826689592, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.406719247264253, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.430816798843313, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.454347296253507, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.477336814478207, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.5217885770490405`, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.543294782270004, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.564348191467836, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}, {4.584967478670572, 
       FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
        GrayLevel[0.], 
        AbsoluteThickness[0.125]}}}}},
  GridLines->{None, None},
  Method->{CoordinatesToolOptions -> {"DisplayFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Exp[
         Part[#, 1]], 
        Exp[
         Part[#, 2]]}& )}},
  PlotRange->{{3.912023005428146, 4.605170185988092}, {1.2628643221541278`, 
   3.021113283291008}},
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]},
  Ticks->{{{3.912023005428146, 
      FormBox["50.`", TraditionalForm], {0.00625, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.25]}}, {4.0943445622221, 
      FormBox["60.`", TraditionalForm], {0.00625, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.25]}}, {4.248495242049359, 
      FormBox["70.`", TraditionalForm], {0.00625, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.25]}}, {4.382026634673881, 
      FormBox["80.`", TraditionalForm], {0.00625, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.25]}}, {4.499809670330265, 
      FormBox["90.`", TraditionalForm], {0.00625, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.25]}}, {4.605170185988092, 
      FormBox["100.`", TraditionalForm], {0.00625, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.25]}}, {3.9512437185814275`, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {3.9889840465642745`, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.02535169073515, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.060443010546419, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.127134385045092, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.1588830833596715`, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.189654742026425, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.219507705176107, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.276666119016055, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.30406509320417, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.330733340286331, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.356708826689592, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.406719247264253, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.430816798843313, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.454347296253507, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.477336814478207, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.5217885770490405`, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.543294782270004, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.564348191467836, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}, {4.584967478670572, 
      FormBox["\"\"", TraditionalForm], {0.00375, 0.}, {
       GrayLevel[0.], 
       AbsoluteThickness[0.125]}}}, {{
      NCache[
       Log[10], 2.302585092994046], 
      FormBox["10", TraditionalForm]}, {
      NCache[
       Log[100], 4.605170185988092], 
      FormBox["100", TraditionalForm]}, {
      NCache[
       Log[50], 3.912023005428146], 
      FormBox["50", TraditionalForm]}, {
      NCache[
       Log[500], 6.214608098422191], 
      FormBox["500", TraditionalForm]}, {
      NCache[
       Log[20], 2.995732273553991], 
      FormBox["20", TraditionalForm]}, {
      NCache[
       Log[200], 5.298317366548036], 
      FormBox["200", TraditionalForm]}, {
      NCache[
       Log[30], 3.4011973816621555`], 
      FormBox["30", TraditionalForm]}, {
      NCache[
       Log[300], 5.703782474656201], 
      FormBox["300", TraditionalForm]}, {
      NCache[
       Log[15], 2.70805020110221], 
      FormBox["15", TraditionalForm]}, {
      NCache[
       Log[150], 5.0106352940962555`], 
      FormBox["150", TraditionalForm]}, {
      NCache[
       Log[70], 4.248495242049359], 
      FormBox["70", TraditionalForm]}, {
      NCache[
       Log[700], 6.551080335043404], 
      FormBox["700", TraditionalForm]}, {2.3978952727983707`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.4849066497880004`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.5649493574615367`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.6390573296152584`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.772588722239781, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.833213344056216, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.8903717578961645`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {2.9444389791664403`, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[40], 3.6888794541139363`], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[60], 4.0943445622221], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.382026634673881, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.499809670330265, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.700480365792417, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.787491742782046, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.867534450455582, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {4.941642422609304, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.075173815233827, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.135798437050262, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.19295685089021, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {5.247024072160486, 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[400], 5.991464547107982], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}, {
      NCache[
       Log[600], 6.396929655216146], 
      FormBox["\" \"", TraditionalForm], {0.00375, 0.}, {
       Thickness[0.001]}}}}]], "Output",
 CellChangeTimes->{
  3.473158285147273*^9, 3.473158387285335*^9, {3.4731584329025993`*^9, 
   3.473158458494359*^9}, {3.473687080459532*^9, 3.473687113932084*^9}, {
   3.473687595844878*^9, 3.473687634790358*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"tensors", "=", "20"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bond", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Rangetiming", "=", 
   RowBox[{"Monitor", "[", 
    RowBox[{
     RowBox[{"MemoryConstrained", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"IntRange", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"tiempo", "=", "0"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Do", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"mps", "=", 
                RowBox[{"MPSProductState", "[", 
                 RowBox[{"tensors", ",", 
                  RowBox[{"BondDimension", "\[Rule]", "bond"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"MPSCanonize", "[", "mps", "]"}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"HMatrix", "=", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Piecewise", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "0.5"}], ",", 
                    RowBox[{"n", "\[Equal]", "m"}]}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"1.0", "/", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"n", "-", "m"}], "]"}], "^", "3"}]}], ",", 
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{"n", "-", "m"}], "]"}], "\[LessEqual]", 
                    "IntRange"}]}], "}"}]}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", "1", ",", "tensors"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"m", ",", "1", ",", "tensors"}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"tiempo", "+=", 
                RowBox[{
                 RowBox[{"AbsoluteTiming", "[", 
                  RowBox[{"MPSMinimizeEnergy", "[", 
                   RowBox[{"mps", ",", "HMatrix", ",", 
                    RowBox[{"InteractionRange", "\[Rule]", "IntRange"}]}], 
                   "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
              ",", 
              RowBox[{"{", 
               RowBox[{"tt", ",", "1", ",", "10"}], "}"}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"tiempo", "/", "10"}]}]}], "\[IndentingNewLine]", "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"IntRange", ",", "1", ",", "8", ",", "1"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"1024", " ", "1024", " ", "1024"}]}], "]"}], ",", 
     RowBox[{"\"\<Chain Length: \>\"", "<>", 
      RowBox[{"ToString", "[", "IntRange", "]"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.47314608176173*^9, 3.473146221267426*^9}, {
  3.4731585387517443`*^9, 3.4731585541448097`*^9}, {3.4736499226029043`*^9, 
  3.473649925231048*^9}, {3.47365622066826*^9, 3.473656280441625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Unable to write data to closed link \
\\!\\(LinkObject[\\(\\(\\\"/Users/fercook/Mathematica/MPS/arpackformps\\\", \
23523, 5\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkw\\\", ButtonNote -> \
\\\"LinkObject::linkw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473687700607462*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({energy$18948, new$18948, info$18948}\\) and \
\\!\\($Failed\\) are not the same shape. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473687700610722*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Unable to write data to closed link \
\\!\\(LinkObject[\\(\\(\\\"/Users/fercook/Mathematica/MPS/arpackformps\\\", \
23523, 5\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkw\\\", ButtonNote -> \
\\\"LinkObject::linkw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473687700615399*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({energy$18948, new$18948, info$18948}\\) and \
\\!\\($Failed\\) are not the same shape. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473687700619084*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Unable to write data to closed link \
\\!\\(LinkObject[\\(\\(\\\"/Users/fercook/Mathematica/MPS/arpackformps\\\", \
23523, 5\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/LinkObject/linkw\\\", ButtonNote -> \
\\\"LinkObject::linkw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.47368770072843*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(LinkObject :: \\\"linkw\\\"\\) \
will be suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.47368770075213*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({energy$18948, new$18948, info$18948}\\) and \
\\!\\($Failed\\) are not the same shape. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473687700784885*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Set :: \\\"shape\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.47368770080612*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \
\\!\\({\\(\\({\\(\\({\\(\\(\\(\\(-0.7260720854229618`\\)\\) + \\(\\(0.`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5812114038632145` \
\[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\
\[LeftSkeleton] 4 \[RightSkeleton]\\)\\), \\(\\(\\(\\(-0.0932085887578838`\\)\
\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(0.03434670112298538` \[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\), \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\), \
\\(\\({\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)}\\)\\)}\\)\\), \\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\) and \
\\!\\({\\(\\({\\(\\(\\(\\(0.8960668369088788` \[InvisibleSpace]\\)\\) + \
\\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.02321150495185639` \
\[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\
\[LeftSkeleton] 6 \[RightSkeleton]\\)\\), \\(\\(1.6260638590692067`*^-6 + \\(\
\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-7.145738958598417`*^-7\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\
\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 8 \[RightSkeleton]\\)\\), \\(\\({\\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\)}\\)\\)}\\) have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473687700849244*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \
\\!\\({\\(\\({\\(\\({\\(\\(\\(\\(0.709298825954026` \[InvisibleSpace]\\)\\) + \
\\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5791015201043717` \
\[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.35119723567587124`\\)\\) + \\(\\(0.`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.19544080067036326` \[InvisibleSpace]\
\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\), \\(\\({\\(\\(\\(\\(-\
\\(\\(\[LeftSkeleton] 20 \[RightSkeleton]\\)\\)\\)\\) - \\(\\(\[LeftSkeleton] \
1 \[RightSkeleton]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)}\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\)}\\) and \\!\\({\\(\\({\\(\\(\\(\\(0.8960668369088788` \
\[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(0.02321150495185639` \[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\), \
\\(\\(1.6260638590692067`*^-6 + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-7.145738958598417`*^-7\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\
\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 8 \[RightSkeleton]\\)\\), \\(\\({\\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\)}\\)\\)}\\) have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473687700876397*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\({\\(\\({\\({\\(\\(\\(\\(-0.4747898853336035`\
\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.8800991789479774`\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\
\\)}\\)}\\)\\), \\(\\({\\({\\(\\(\\(\\(-0.8215558846451686`\\)\\) + \
\\(\\(0.315627142669635`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(0.4432073493490711` \[InvisibleSpace]\\)\\) - \\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)\\)\\)}\\)}\\)\\)}\\) and \
\\!\\({\\(\\({\\(\\(\\(\\(0.8960668369088788` \[InvisibleSpace]\\)\\) + \
\\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.02321150495185639` \
\[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\
\[LeftSkeleton] 6 \[RightSkeleton]\\)\\), \\(\\(1.6260638590692067`*^-6 + \\(\
\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-7.145738958598417`*^-7\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\
\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 8 \[RightSkeleton]\\)\\), \\(\\({\\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\)}\\)\\)}\\) have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473687700912669*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Dot :: \\\"dotsh\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473687700948991*^9}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.47368773730523*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"#", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], "&"}], "/@", 
    "Rangetiming"}], ",", 
   RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.473158307744254*^9, 3.473158308281493*^9}, {
  3.473656202171974*^9, 3.473656207943564*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], 
   LineBox[{{1., 2.386922}, {2., 7.671219}, {3., 16.236218}, {4., 
    22.288859}, {5., 29.582275}, {6., 8.165371}, {7., 50.57047}, {8., 
    22.44101}, {9., 21.806924}, {10., 31.694845}}]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{3.473158309003456*^9, 3.473656159243023*^9, 
  3.473656208285791*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Further testing inside routines", "Section",
 CellChangeTimes->{{3.472469181699139*^9, 3.472469187984748*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsLinkActive", "[", "]"}]], "Input"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.472987582245181*^9, 3.472988929696453*^9, 3.473054310198888*^9, 
   3.4730611490270452`*^9, 3.473061526789939*^9, 3.473063375192698*^9, 
   3.4730637086320753`*^9, {3.473071604470055*^9, 3.473071612928542*^9}, 
   3.473071930118333*^9, 3.4730721828973637`*^9, 3.4730722168166237`*^9, 
   3.4730727057722063`*^9, 3.473075572833397*^9, 3.473079271194461*^9, 
   3.4730795040266333`*^9, 3.4730799908183603`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mps", "=", 
   RowBox[{"MPSProductState", "[", 
    RowBox[{"10", ",", 
     RowBox[{"BondDimension", "\[Rule]", "10"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MPSCanonize", "[", "mps", "]"}], "\[IndentingNewLine]", 
 RowBox[{"numTensors", "=", 
  RowBox[{"Length", "[", "mps", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"chi", "=."}], "\n", 
 RowBox[{
  RowBox[{"IntRange", "=", "1"}], ";", 
  RowBox[{"HMatrix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", 
            RowBox[{"n", "\[Equal]", "m"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.0", ",", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"n", "-", "m"}], "]"}], "\[LessEqual]", "IntRange"}]}], 
           "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.472968243599131*^9, 3.472968253753728*^9}, {
   3.472968313329651*^9, 3.4729683198566513`*^9}, 3.47297439164145*^9, 
   3.473159119226261*^9, 3.473423622407324*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.472968257311213*^9, 3.472968321262155*^9, 
  3.472973986847808*^9, 3.4729741562778473`*^9, 3.472974392177123*^9, 
  3.472975139755508*^9, 3.4729752825287943`*^9, 3.472976094116508*^9, 
  3.472977217278811*^9, 3.472987194844617*^9, 3.472987583408063*^9, 
  3.472988018159918*^9, 3.472988375104816*^9, 3.4729885856040373`*^9, 
  3.472988930986105*^9, 3.4730543121900177`*^9, 3.473061151099291*^9, 
  3.4730614889058847`*^9, 3.4730615277355337`*^9, 3.473061991595686*^9, 
  3.473063376897602*^9, 3.4730637101538353`*^9, 3.4730716142083387`*^9, 
  3.473071931276659*^9, 3.473072183635601*^9, 3.473072217542205*^9, 
  3.473072706523048*^9, 3.4730755737159224`*^9, 3.473079272171134*^9, 
  3.473079504716716*^9, 3.4730799918728647`*^9, 3.473080392746529*^9, 
  3.4731591246530848`*^9, 3.4731592289109697`*^9, 3.4731600211594563`*^9, 
  3.4731601388622627`*^9, 3.473160308475205*^9, 3.473163804656851*^9, 
  3.473163941492214*^9, 3.4731640397896757`*^9, 3.4731642819626427`*^9, 
  3.4734236243114758`*^9}],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{3.472968257311213*^9, 3.472968321262155*^9, 
  3.472973986847808*^9, 3.4729741562778473`*^9, 3.472974392177123*^9, 
  3.472975139755508*^9, 3.4729752825287943`*^9, 3.472976094116508*^9, 
  3.472977217278811*^9, 3.472987194844617*^9, 3.472987583408063*^9, 
  3.472988018159918*^9, 3.472988375104816*^9, 3.4729885856040373`*^9, 
  3.472988930986105*^9, 3.4730543121900177`*^9, 3.473061151099291*^9, 
  3.4730614889058847`*^9, 3.4730615277355337`*^9, 3.473061991595686*^9, 
  3.473063376897602*^9, 3.4730637101538353`*^9, 3.4730716142083387`*^9, 
  3.473071931276659*^9, 3.473072183635601*^9, 3.473072217542205*^9, 
  3.473072706523048*^9, 3.4730755737159224`*^9, 3.473079272171134*^9, 
  3.473079504716716*^9, 3.4730799918728647`*^9, 3.473080392746529*^9, 
  3.4731591246530848`*^9, 3.4731592289109697`*^9, 3.4731600211594563`*^9, 
  3.4731601388622627`*^9, 3.473160308475205*^9, 3.473163804656851*^9, 
  3.473163941492214*^9, 3.4731640397896757`*^9, 3.4731642819626427`*^9, 
  3.473423624321306*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"defineRight", "[", "temp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "fer", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAll", "[", 
       RowBox[{"R", ",", "fieldR", ",", "operatorsR", ",", "interactionsR"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"R", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"R", "[", "n", "]"}], "=", 
        RowBox[{"RProduct", "[", 
         RowBox[{
          RowBox[{"mps", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"mps", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"R", "[", 
           RowBox[{"n", "+", "1"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fieldR", "[", 
        RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fieldR", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"fieldR", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"RProduct", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"fieldR", "[", 
               RowBox[{"n", "+", "1"}], "]"}], "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"HMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"\[Alpha]", ",", "n", ",", "n"}], "]"}], "]"}], 
            RowBox[{"RProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"mps", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"R", "[", 
               RowBox[{"n", "+", "1"}], "]"}]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsR", "[", 
        RowBox[{"numTensors", "+", "2"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsR", "[", 
        RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsR", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"operatorsR", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"RProduct", "[", 
               RowBox[{
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
              
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"operatorsR", "[", 
                 RowBox[{"n", "+", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"IntRange", "-", "1"}], ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"operatorsR", "[", 
                    RowBox[{"n", "+", "1"}], "]"}], "[", 
                   RowBox[{"[", "\[Alpha]", "]"}], "]"}], "]"}]}], "]"}]}], 
              "]"}]}], ",", 
            RowBox[{"RProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"mps", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"R", "[", 
               RowBox[{"n", "+", "1"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interactionsR", "[", 
        RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interactionsR", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"interactionsR", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"RProduct", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"interactionsR", "[", 
               RowBox[{"n", "+", "1"}], "]"}], "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"HMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"\[Alpha]", ",", "n", ",", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ";;", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"n", "+", "IntRange"}], ",", "numTensors"}], 
                  "]"}]}]}], "]"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"RProduct", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                   RowBox[{"mps", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                  RowBox[{"mps", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
                
               RowBox[{
                RowBox[{"operatorsR", "[", 
                 RowBox[{"n", "+", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], ")"}]}], ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"defineLeft", "[", "temp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "fer", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAll", "[", 
       RowBox[{"L", ",", "fieldL", ",", "operatorsL", ",", "interactionsL"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "[", "0", "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"L", "[", "n", "]"}], "=", 
        RowBox[{"LProduct", "[", 
         RowBox[{
          RowBox[{"mps", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"mps", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"L", "[", 
           RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fieldL", "[", "0", "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fieldL", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"fieldL", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"LProduct", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"fieldL", "[", 
               RowBox[{"n", "-", "1"}], "]"}], "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"HMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"\[Alpha]", ",", "n", ",", "n"}], "]"}], "]"}], 
            RowBox[{"LProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"mps", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"L", "[", 
               RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsL", "[", 
        RowBox[{"-", "1"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsL", "[", "0", "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsL", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"operatorsL", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"LProduct", "[", 
               RowBox[{
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
              
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"operatorsL", "[", 
                 RowBox[{"n", "-", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"IntRange", "-", "1"}], ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"operatorsL", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], "]"}]}], "]"}]}]}],
               "]"}]}], ",", 
            RowBox[{"LProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"mps", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"L", "[", 
               RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interactionsL", "[", "0", "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interactionsL", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"interactionsL", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"LProduct", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"interactionsL", "[", 
               RowBox[{"n", "-", "1"}], "]"}], "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"HMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"\[Alpha]", ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"n", "-", "IntRange"}], ",", "1"}], "]"}], ";;", 
                 RowBox[{"n", "-", "1"}]}], ",", "n"}], "]"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"LProduct", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                   RowBox[{"mps", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                  RowBox[{"mps", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
                
               RowBox[{
                RowBox[{"operatorsL", "[", 
                 RowBox[{"n", "-", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], ")"}]}], ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.470563081140533*^9, 3.470563092815218*^9}, {
   3.470566334171829*^9, 3.470566335598522*^9}, {3.472303681795627*^9, 
   3.472303694087062*^9}, {3.4723046565810547`*^9, 3.472304743561098*^9}, {
   3.472362845200406*^9, 3.472362864006357*^9}, {3.472368286648633*^9, 
   3.4723683023223543`*^9}, {3.472368516639093*^9, 3.4723685271137333`*^9}, {
   3.472448172166551*^9, 3.47244819272561*^9}, 3.472973981411666*^9, {
   3.472977227217565*^9, 3.472977228866046*^9}, {3.473159260788677*^9, 
   3.4731592874395447`*^9}}],

Cell[BoxData[
 RowBox[{"defineRight", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.470563083502159*^9, 3.470563096568068*^9}}],

Cell[BoxData[
 RowBox[{"defineLeft", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.4705630995847883`*^9, 3.470563109939839*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"can", "=", 
   RowBox[{"{", 
    RowBox[{"{", "1.", "}"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.472974411563171*^9, 3.47297441575625*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", 
   RowBox[{"Dimensions", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.47315917722974*^9, 3.473159193745693*^9}, {
  3.473163852329502*^9, 3.473163855599538*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.473159226406479*^9, 3.4731592926633*^9, 3.473160142425749*^9, {
   3.473160286829455*^9, 3.4731603129841833`*^9}, 3.4731638098939962`*^9, 
   3.473163856726918*^9, 3.473163948037112*^9, 3.4731640439259233`*^9, 
   3.473423632151847*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", 
   RowBox[{"TestCommunication", "[", 
    RowBox[{
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}], ",", 
     RowBox[{"interactionsL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"interactionsR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"fieldL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"fieldR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"operatorsL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"operatorsR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"HMatrix", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"1", ",", 
           RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"1", ",", 
           RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
         RowBox[{"Min", "[", 
          RowBox[{"numTensors", ",", 
           RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}], 
    "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4731602435485277`*^9, 3.473160281274455*^9}, {
  3.473160362221138*^9, 3.473160398852386*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "10", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.4731602547542686`*^9, 3.473160322713052*^9, {3.4731603636466713`*^9, 
   3.473160399465543*^9}, 3.4731638148585377`*^9, 3.473163950314307*^9, 
   3.473164045119072*^9, 3.47342363444798*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "5"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], ",", 
          
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}], "=", 
     RowBox[{"MPSCanonizeSite", "[", 
      RowBox[{"new", ",", "can", ",", 
       RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
       RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.473160060649735*^9, 3.4731601265305223`*^9}, {
  3.473163919196877*^9, 3.4731639718670807`*^9}, {3.473164048114978*^9, 
  3.473164066839492*^9}, {3.473664746342107*^9, 3.473664747076236*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{
  3.473160095765411*^9, {3.473160130037274*^9, 3.4731601555945168`*^9}, 
   3.473163888808964*^9, {3.4731639205266333`*^9, 3.4731639726519203`*^9}, {
   3.4731640487118397`*^9, 3.473164067444944*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "can", "]"}]], "Input",
 CellChangeTimes->{{3.473163905522706*^9, 3.473163915601438*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{{3.473163906793264*^9, 3.47316391587405*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Right sweep:\>\"", "<>", "\"\<, site:\>\"", "<>", 
       RowBox[{"ToString", "[", "site", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"can", ".", "#"}], "&"}], "/@", 
         RowBox[{"mps", "[", 
          RowBox[{"[", "site", "]"}], "]"}]}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], ",",
            
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}], 
        ",", 
        RowBox[{"InteractionRange", "\[Rule]", "IntRange"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], ";"}], " ", 
    RowBox[{"(*", " ", 
     RowBox[{"This", " ", "routine", " ", "changes", " ", "canon"}], " ", 
     "*)"}], "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"site", ",", "1", ",", "numTensors"}], "}"}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4730756304450912`*^9, 3.473075666737859*^9}, {
  3.4731591490230703`*^9, 3.473159155478663*^9}, {3.4731600396969233`*^9, 
  3.473160050115149*^9}, {3.4736647629804688`*^9, 3.4736647636131*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Right sweep:, site:1\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.473080401900814*^9}],

Cell[BoxData["\<\"Right sweep:, site:2\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.4730804019957943`*^9}],

Cell[BoxData["\<\"Right sweep:, site:3\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.473080402092239*^9}],

Cell[BoxData["\<\"Right sweep:, site:4\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.473080402236195*^9}],

Cell[BoxData["\<\"Right sweep:, site:5\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.4730804023237343`*^9}],

Cell[BoxData["\<\"Right sweep:, site:6\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.473080402415094*^9}],

Cell[BoxData["\<\"Right sweep:, site:7\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.473080402502*^9}],

Cell[BoxData["\<\"Right sweep:, site:8\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.473080402651822*^9}],

Cell[BoxData["\<\"Right sweep:, site:9\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.47308040274199*^9}],

Cell[BoxData["\<\"Right sweep:, site:10\"\>"], "Print",
 CellChangeTimes->{3.473075669973486*^9, 3.47307927639203*^9, 
  3.47307950905506*^9, 3.4730799980330477`*^9, 3.4730804028265867`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["energy"], "Input",
 CellChangeTimes->{3.473079281119914*^9}],

Cell[BoxData[
 RowBox[{"-", "17.179533610910745`"}]], "Output",
 CellChangeTimes->{3.473075681292645*^9, 3.47307927891046*^9, 
  3.473079511450964*^9, 3.473080001359624*^9, 3.4730804044462*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "mps"}]], "Input",
 CellChangeTimes->{{3.473075684904892*^9, 3.4730756893892717`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4730756898982353`*^9, 3.4730792827668877`*^9, 
  3.473079512091448*^9, 3.473080002064831*^9, 3.473080405295189*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "can", "]"}]], "Input",
 CellChangeTimes->{{3.473079287695567*^9, 3.4730792900758038`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473079290543397*^9, 3.4730795130349693`*^9, 
  3.473080002810182*^9, 3.4730804064027567`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"defineRight", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.473079026611175*^9, 3.473079030140046*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{"L", "[", "n", "]"}], "]"}], "//", "MatrixForm"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", "9", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4730790381050997`*^9, 3.4730790382808313`*^9}, {
  3.473079152031715*^9, 3.4730792096304483`*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 0, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`n$$], 0, 9, 1}}, Typeset`size$$ = {88., {3., 8.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`n$1242$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`n$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n$$, $CellContext`n$1242$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> MatrixForm[
        Chop[
         $CellContext`L[$CellContext`n$$]]], 
      "Specifications" :> {{$CellContext`n$$, 0, 9, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{301., {47., 52.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.47307903876232*^9, {3.473079179898108*^9, 3.473079209932988*^9}, 
   3.4730795150548353`*^9, 3.473080007618436*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Left sweep:\>\"", "<>", "\"\<, site:\>\"", "<>", 
       RowBox[{"ToString", "[", "site", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Dimensions", "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mps", "[", 
           RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
         RowBox[{"interactionsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"interactionsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"fieldL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"fieldR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"operatorsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"operatorsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"HMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
             RowBox[{"Min", "[", 
              RowBox[{"numTensors", ",", 
               RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mps", "[", 
          RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"site", ",", "numTensors", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.473079061038226*^9, 3.473079111196021*^9}, {
  3.473079309070821*^9, 3.473079313821273*^9}, {3.473664774967663*^9, 
  3.47366477562049*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Left sweep:, site:10\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080410666277*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.4730804108141413`*^9}],

Cell[BoxData["\<\"Left sweep:, site:9\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080410918708*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080411021537*^9}],

Cell[BoxData["\<\"Left sweep:, site:8\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080411197887*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080411300003*^9}],

Cell[BoxData["\<\"Left sweep:, site:7\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.4730804114058*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.4730804115081177`*^9}],

Cell[BoxData["\<\"Left sweep:, site:6\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.47308041160343*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.4730804117763853`*^9}],

Cell[BoxData["\<\"Left sweep:, site:5\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080411883769*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080412045648*^9}],

Cell[BoxData["\<\"Left sweep:, site:4\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080412151515*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080412320039*^9}],

Cell[BoxData["\<\"Left sweep:, site:3\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080412427371*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080412627657*^9}],

Cell[BoxData["\<\"Left sweep:, site:2\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080412749955*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.473080412961893*^9}],

Cell[BoxData["\<\"Left sweep:, site:1\"\>"], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.4730804130731792`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079238517865*^9, 3.473079318524128*^9, 
  3.4730795163930187`*^9, 3.473080011123218*^9, 3.4730804132556677`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "mps"}]], "Input",
 CellChangeTimes->{{3.473079334621993*^9, 3.4730793386825323`*^9}, {
  3.47307952814563*^9, 3.473079530606925*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.473079339086884*^9, {3.473079520716264*^9, 3.473079531966522*^9}, 
   3.473080017650982*^9, 3.473080414810734*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "can", "]"}]], "Input",
 CellChangeTimes->{{3.473079341274014*^9, 3.4730793439016123`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473079344463269*^9, 3.4730795325710983`*^9, 
  3.473080019759448*^9, 3.473080415646339*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["can"], "Input",
 CellChangeTimes->{{3.4730793459772053`*^9, 3.473079346094256*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1.`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.4730793463319073`*^9, 3.473079533901936*^9, 
  3.473080020658226*^9, 3.473080416270611*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{"R", "[", "n", "]"}], "]"}], "//", "MatrixForm"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "2", ",", "11", ",", "1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.473079376670451*^9, 3.47307938822744*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n$$ = 2, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`n$$], 2, 11, 1}}, Typeset`size$$ = {88., {3., 8.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`n$1282$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`n$$ = 2}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n$$, $CellContext`n$1282$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> MatrixForm[
        Chop[
         $CellContext`R[$CellContext`n$$]]], 
      "Specifications" :> {{$CellContext`n$$, 2, 11, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{301., {47., 52.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.473079383612653*^9, 3.4730793907662992`*^9}, 
   3.473079535730427*^9, 3.473080025477146*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"defineLeft", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.4730794138888617`*^9, 3.473079416429536*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"can", ".", "#"}], "&"}], "/@", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.473079539962574*^9, 3.473079542478445*^9}, {
  3.4730796155412493`*^9, 3.4730796168158083`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.1680190460606794`"}], "+", 
       RowBox[{"0.7516719694330332`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.15531203988423775`"}], "-", 
       RowBox[{"0.14961710883992024`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.3456613610995041`"}], "+", 
       RowBox[{"0.20630297137021042`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.004721115425858818`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.4451817157686296`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.473079543157236*^9, 3.473079617840548*^9, 
  3.4730800305308523`*^9, 3.473080420942748*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.473079545585874*^9, 3.473079552309586*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.4730795527320538`*^9, 3.473079619822275*^9, 
  3.4730800324822283`*^9, 3.473080422014373*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Do", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Print", "[", 
       RowBox[{"\"\<Right sweep:\>\"", "<>", "\"\<, site:\>\"", "<>", 
        RowBox[{"ToString", "[", "site", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{"Dimensions", "/@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"can", ".", "#"}], "&"}], "/@", 
           RowBox[{"mps", "[", 
            RowBox[{"[", "site", "]"}], "]"}]}], ",", 
          RowBox[{"interactionsL", "[", 
           RowBox[{"site", "-", "1"}], "]"}], ",", 
          RowBox[{"interactionsR", "[", 
           RowBox[{"site", "+", "1"}], "]"}], ",", 
          RowBox[{"fieldL", "[", 
           RowBox[{"site", "-", "1"}], "]"}], ",", 
          RowBox[{"fieldR", "[", 
           RowBox[{"site", "+", "1"}], "]"}], ",", 
          RowBox[{"operatorsL", "[", 
           RowBox[{"site", "-", "1"}], "]"}], ",", 
          RowBox[{"operatorsR", "[", 
           RowBox[{"site", "+", "1"}], "]"}], ",", 
          RowBox[{"HMatrix", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", 
                RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
             RowBox[{
              RowBox[{"Max", "[", 
               RowBox[{"1", ",", 
                RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
              RowBox[{"Min", "[", 
               RowBox[{"numTensors", ",", 
                RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
         "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
       RowBox[{"FindGroundMPSSite", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"can", ".", "#"}], "&"}], "/@", 
          RowBox[{"mps", "[", 
           RowBox[{"[", "site", "]"}], "]"}]}], ",", 
         RowBox[{"interactionsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"interactionsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"fieldL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"fieldR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"operatorsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"operatorsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"HMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
             RowBox[{"Min", "[", 
              RowBox[{"numTensors", ",", 
               RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "=", 
       RowBox[{"MPSCanonizeSite", "[", 
        RowBox[{"new", ",", "can", ",", 
         RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
         RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], ";"}], " ", 
     RowBox[{"(*", " ", 
      RowBox[{"This", " ", "routine", " ", "changes", " ", "canon"}], " ", 
      "*)"}], "\[IndentingNewLine]", ",", 
     RowBox[{"{", 
      RowBox[{"site", ",", "1", ",", "5"}], "}"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.4730794204837303`*^9, 3.4730794317157707`*^9}, 
   3.4730796103094*^9, {3.473080426913947*^9, 3.473080429097665*^9}, {
   3.473664782080246*^9, 3.473664782588818*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Right sweep:, site:1\"\>"], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.473080430285277*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.473080430404216*^9}],

Cell[BoxData["\<\"Right sweep:, site:2\"\>"], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.473080430500854*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.473080430600046*^9}],

Cell[BoxData["\<\"Right sweep:, site:3\"\>"], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.4730804307661057`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.473080430868725*^9}],

Cell[BoxData["\<\"Right sweep:, site:4\"\>"], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.473080431023286*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.473080431124531*^9}],

Cell[BoxData["\<\"Right sweep:, site:5\"\>"], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.473080431230345*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.4730794333483458`*^9, 3.473079622234446*^9, 
  3.473080034804677*^9, 3.473080069774439*^9, 3.473080114992414*^9, 
  3.4730804313903923`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSCanonizationCheck", "[", 
  RowBox[{"mps", ",", 
   RowBox[{"Site", "\[Rule]", "6"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.473080434352934*^9, 3.4730804499527617`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.4730804507561407`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mps", "=", 
   RowBox[{"MPSProductState", "[", 
    RowBox[{"10", ",", 
     RowBox[{"BondDimension", "\[Rule]", "10"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MPSCanonize", "[", 
  RowBox[{"mps", ",", 
   RowBox[{"Site", "\[Rule]", "11"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MPSCanonize", "[", "mps", "]"}]}], "Input",
 CellChangeTimes->{{3.4730814539078207`*^9, 3.4730814622488203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"pspec\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(i$\\) is neither an integer nor a \
list of integers. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/pspec\\\", ButtonNote -> \
\\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.473081278889727*^9, {3.473081435934005*^9, 3.4730814630287237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"pspec\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(i$\\) is neither an integer nor a \
list of integers. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/pspec\\\", ButtonNote -> \
\\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.473081278889727*^9, {3.473081435934005*^9, 3.473081463053276*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"pspec\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(i$\\) is neither an integer nor a \
list of integers. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/pspec\\\", ButtonNote -> \
\\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.473081278889727*^9, {3.473081435934005*^9, 3.473081463067539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"pspec\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.473081278889727*^9, {3.473081435934005*^9, 3.473081463078672*^9}}],

Cell[BoxData["11"], "Output",
 CellChangeTimes->{
  3.4730812789226017`*^9, {3.473081435986539*^9, 3.473081463089068*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.4730812789226017`*^9, {3.473081435986539*^9, 3.473081463100977*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "/@", "mps"}]], "Input",
 CellChangeTimes->{{3.4730814369789343`*^9, 3.473081444420816*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.4730814448728743`*^9, 3.473081466130301*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Multiplication of vectors", "Section",
 CellChangeTimes->{{3.473159318068016*^9, 3.473159325829184*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mps", "=", 
   RowBox[{"MPSProductState", "[", 
    RowBox[{"10", ",", 
     RowBox[{"BondDimension", "\[Rule]", "10"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MPSCanonize", "[", "mps", "]"}], "\[IndentingNewLine]", 
 RowBox[{"numTensors", "=", 
  RowBox[{"Length", "[", "mps", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"can", "=", 
  RowBox[{"{", 
   RowBox[{"{", "1.", "}"}], "}"}]}], "\n", 
 RowBox[{
  RowBox[{"IntRange", "=", "3"}], ";", 
  RowBox[{"HMatrix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Piecewise", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", 
            RowBox[{"n", "\[Equal]", "m"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.0", ",", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"n", "-", "m"}], "]"}], "\[LessEqual]", "IntRange"}]}], 
           "}"}]}], "}"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "1", ",", "10"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "1", ",", "10"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.472968243599131*^9, 3.472968253753728*^9}, {
   3.472968313329651*^9, 3.4729683198566513`*^9}, 3.47297439164145*^9, 
   3.473159119226261*^9, 3.473423622407324*^9, {3.4736171303939857`*^9, 
   3.47361713521597*^9}, 3.473617288538928*^9, {3.4736189276405287`*^9, 
   3.473618928221895*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.472968257311213*^9, 3.472968321262155*^9, 
  3.472973986847808*^9, 3.4729741562778473`*^9, 3.472974392177123*^9, 
  3.472975139755508*^9, 3.4729752825287943`*^9, 3.472976094116508*^9, 
  3.472977217278811*^9, 3.472987194844617*^9, 3.472987583408063*^9, 
  3.472988018159918*^9, 3.472988375104816*^9, 3.4729885856040373`*^9, 
  3.472988930986105*^9, 3.4730543121900177`*^9, 3.473061151099291*^9, 
  3.4730614889058847`*^9, 3.4730615277355337`*^9, 3.473061991595686*^9, 
  3.473063376897602*^9, 3.4730637101538353`*^9, 3.4730716142083387`*^9, 
  3.473071931276659*^9, 3.473072183635601*^9, 3.473072217542205*^9, 
  3.473072706523048*^9, 3.4730755737159224`*^9, 3.473079272171134*^9, 
  3.473079504716716*^9, 3.4730799918728647`*^9, 3.473080392746529*^9, 
  3.4731591246530848`*^9, 3.4731592289109697`*^9, 3.4731600211594563`*^9, 
  3.4731601388622627`*^9, 3.473160308475205*^9, 3.473163804656851*^9, 
  3.473163941492214*^9, 3.4731640397896757`*^9, 3.4731642819626427`*^9, 
  3.4734236243114758`*^9, 3.4736168000904837`*^9, 3.4736171359861717`*^9, 
  3.473617289687559*^9, 3.473618929337097*^9, 3.473620251286035*^9}],

Cell[BoxData["10"], "Output",
 CellChangeTimes->{3.472968257311213*^9, 3.472968321262155*^9, 
  3.472973986847808*^9, 3.4729741562778473`*^9, 3.472974392177123*^9, 
  3.472975139755508*^9, 3.4729752825287943`*^9, 3.472976094116508*^9, 
  3.472977217278811*^9, 3.472987194844617*^9, 3.472987583408063*^9, 
  3.472988018159918*^9, 3.472988375104816*^9, 3.4729885856040373`*^9, 
  3.472988930986105*^9, 3.4730543121900177`*^9, 3.473061151099291*^9, 
  3.4730614889058847`*^9, 3.4730615277355337`*^9, 3.473061991595686*^9, 
  3.473063376897602*^9, 3.4730637101538353`*^9, 3.4730716142083387`*^9, 
  3.473071931276659*^9, 3.473072183635601*^9, 3.473072217542205*^9, 
  3.473072706523048*^9, 3.4730755737159224`*^9, 3.473079272171134*^9, 
  3.473079504716716*^9, 3.4730799918728647`*^9, 3.473080392746529*^9, 
  3.4731591246530848`*^9, 3.4731592289109697`*^9, 3.4731600211594563`*^9, 
  3.4731601388622627`*^9, 3.473160308475205*^9, 3.473163804656851*^9, 
  3.473163941492214*^9, 3.4731640397896757`*^9, 3.4731642819626427`*^9, 
  3.4734236243114758`*^9, 3.4736168000904837`*^9, 3.4736171359861717`*^9, 
  3.473617289687559*^9, 3.473618929337097*^9, 3.4736202512896976`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1.`", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.472968257311213*^9, 3.472968321262155*^9, 
  3.472973986847808*^9, 3.4729741562778473`*^9, 3.472974392177123*^9, 
  3.472975139755508*^9, 3.4729752825287943`*^9, 3.472976094116508*^9, 
  3.472977217278811*^9, 3.472987194844617*^9, 3.472987583408063*^9, 
  3.472988018159918*^9, 3.472988375104816*^9, 3.4729885856040373`*^9, 
  3.472988930986105*^9, 3.4730543121900177`*^9, 3.473061151099291*^9, 
  3.4730614889058847`*^9, 3.4730615277355337`*^9, 3.473061991595686*^9, 
  3.473063376897602*^9, 3.4730637101538353`*^9, 3.4730716142083387`*^9, 
  3.473071931276659*^9, 3.473072183635601*^9, 3.473072217542205*^9, 
  3.473072706523048*^9, 3.4730755737159224`*^9, 3.473079272171134*^9, 
  3.473079504716716*^9, 3.4730799918728647`*^9, 3.473080392746529*^9, 
  3.4731591246530848`*^9, 3.4731592289109697`*^9, 3.4731600211594563`*^9, 
  3.4731601388622627`*^9, 3.473160308475205*^9, 3.473163804656851*^9, 
  3.473163941492214*^9, 3.4731640397896757`*^9, 3.4731642819626427`*^9, 
  3.4734236243114758`*^9, 3.4736168000904837`*^9, 3.4736171359861717`*^9, 
  3.473617289687559*^9, 3.473618929337097*^9, 3.4736202512923*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"defineRight", "[", "temp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "fer", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAll", "[", 
       RowBox[{"R", ",", "fieldR", ",", "operatorsR", ",", "interactionsR"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"R", "[", 
        RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"R", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"R", "[", "n", "]"}], "=", 
        RowBox[{"RProduct", "[", 
         RowBox[{
          RowBox[{"mps", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"mps", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"R", "[", 
           RowBox[{"n", "+", "1"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fieldR", "[", 
        RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fieldR", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"fieldR", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"RProduct", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"fieldR", "[", 
               RowBox[{"n", "+", "1"}], "]"}], "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"HMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"\[Alpha]", ",", "n", ",", "n"}], "]"}], "]"}], 
            RowBox[{"RProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"mps", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"R", "[", 
               RowBox[{"n", "+", "1"}], "]"}]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsR", "[", 
        RowBox[{"numTensors", "+", "2"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsR", "[", 
        RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsR", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"operatorsR", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"RProduct", "[", 
               RowBox[{
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
              
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"operatorsR", "[", 
                 RowBox[{"n", "+", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
               RowBox[{"Min", "[", 
                RowBox[{
                 RowBox[{"IntRange", "-", "1"}], ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{
                   RowBox[{"operatorsR", "[", 
                    RowBox[{"n", "+", "1"}], "]"}], "[", 
                   RowBox[{"[", "\[Alpha]", "]"}], "]"}], "]"}]}], "]"}]}], 
              "]"}]}], ",", 
            RowBox[{"RProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"mps", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"R", "[", 
               RowBox[{"n", "+", "1"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interactionsR", "[", 
        RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interactionsR", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"interactionsR", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"RProduct", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"interactionsR", "[", 
               RowBox[{"n", "+", "1"}], "]"}], "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"HMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"\[Alpha]", ",", "n", ",", 
                RowBox[{
                 RowBox[{"n", "+", "1"}], ";;", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"n", "+", "IntRange"}], ",", "numTensors"}], 
                  "]"}]}]}], "]"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"RProduct", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                   RowBox[{"mps", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                  RowBox[{"mps", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
                
               RowBox[{
                RowBox[{"operatorsR", "[", 
                 RowBox[{"n", "+", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], ")"}]}], ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"defineLeft", "[", "temp_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "fer", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearAll", "[", 
       RowBox[{"L", ",", "fieldL", ",", "operatorsL", ",", "interactionsL"}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "[", "0", "]"}], "=", 
       RowBox[{"{", 
        RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"L", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"L", "[", "n", "]"}], "=", 
        RowBox[{"LProduct", "[", 
         RowBox[{
          RowBox[{"mps", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"mps", "[", 
           RowBox[{"[", "n", "]"}], "]"}], ",", 
          RowBox[{"L", "[", 
           RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fieldL", "[", "0", "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"fieldL", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"fieldL", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"LProduct", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"fieldL", "[", 
               RowBox[{"n", "-", "1"}], "]"}], "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"HMatrix", "[", 
             RowBox[{"[", 
              RowBox[{"\[Alpha]", ",", "n", ",", "n"}], "]"}], "]"}], 
            RowBox[{"LProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"mps", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"L", "[", 
               RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsL", "[", 
        RowBox[{"-", "1"}], "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsL", "[", "0", "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"operatorsL", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"operatorsL", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Prepend", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"LProduct", "[", 
               RowBox[{
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
              
             RowBox[{"Take", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"operatorsL", "[", 
                 RowBox[{"n", "-", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
               RowBox[{"-", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"IntRange", "-", "1"}], ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"operatorsL", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], "]"}]}], "]"}]}]}],
               "]"}]}], ",", 
            RowBox[{"LProduct", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}]}], ",", 
              RowBox[{"mps", "[", 
               RowBox[{"[", "n", "]"}], "]"}], ",", 
              RowBox[{"L", "[", 
               RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interactionsL", "[", "0", "]"}], "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", "0", "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"interactionsL", "[", "n_", "]"}], ":=", 
       RowBox[{
        RowBox[{"interactionsL", "[", "n", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"LProduct", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{"mps", "[", 
              RowBox[{"[", "n", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"interactionsL", "[", 
               RowBox[{"n", "-", "1"}], "]"}], "[", 
              RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"HMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"\[Alpha]", ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{
                   RowBox[{"n", "-", "IntRange"}], ",", "1"}], "]"}], ";;", 
                 RowBox[{"n", "-", "1"}]}], ",", "n"}], "]"}], "]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"LProduct", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                   RowBox[{"mps", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                  RowBox[{"mps", "[", 
                   RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], "/@",
                
               RowBox[{
                RowBox[{"operatorsL", "[", 
                 RowBox[{"n", "-", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], ")"}]}], ")"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.470563081140533*^9, 3.470563092815218*^9}, {
   3.470566334171829*^9, 3.470566335598522*^9}, {3.472303681795627*^9, 
   3.472303694087062*^9}, {3.4723046565810547`*^9, 3.472304743561098*^9}, {
   3.472362845200406*^9, 3.472362864006357*^9}, {3.472368286648633*^9, 
   3.4723683023223543`*^9}, {3.472368516639093*^9, 3.4723685271137333`*^9}, {
   3.472448172166551*^9, 3.47244819272561*^9}, 3.472973981411666*^9, {
   3.472977227217565*^9, 3.472977228866046*^9}, {3.473159260788677*^9, 
   3.4731592874395447`*^9}}],

Cell[BoxData[
 RowBox[{"defineLeft", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.473423765443397*^9, 3.473423770875154*^9}}],

Cell[BoxData[
 RowBox[{"defineRight", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.47342377283032*^9, 3.47342377786806*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testsite", "=", "1"}], ";"}]], "Input",
 CellChangeTimes->{{3.4724685788567667`*^9, 3.472468599948432*^9}, {
   3.472468664046069*^9, 3.472468664103245*^9}, 3.472470125208104*^9, {
   3.472989686643928*^9, 3.472989686707499*^9}, {3.473054495675261*^9, 
   3.473054497062055*^9}, {3.4730546747146482`*^9, 3.473054674886344*^9}, 
   3.473061194110531*^9, 3.473063553225494*^9, 3.473080457040694*^9, 
   3.473081282071857*^9, 3.473138347989231*^9, {3.4731593279478407`*^9, 
   3.473159328154974*^9}, 3.4731639919418507`*^9, 3.473164293367218*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsLinkActive", "[", "]"}]], "Input",
 CellChangeTimes->{{3.4730808196202717`*^9, 3.473080826120604*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.473080824137521*^9, 3.4730808264387503`*^9}, {
   3.473159329831402*^9, 3.4731593390462513`*^9}, 3.4731594920139647`*^9, 
   3.47316399455998*^9, 3.4731642956310883`*^9, 3.473425375982814*^9, 
   3.473616811210381*^9, {3.473617088609056*^9, 3.473617104890973*^9}, 
   3.473617152071348*^9, 3.4736172986904593`*^9, 3.4736189345257*^9, 
   3.473620257242511*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "testsite"}], "}"}], ",", 
   RowBox[{"Dimensions", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.47315917722974*^9, 3.473159193745693*^9}, {
  3.4731597992118893`*^9, 3.473159846210322*^9}, {3.4731640047709827`*^9, 
  3.4731640061706057`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.473159766480053*^9, {3.473159822963176*^9, 3.473159846862846*^9}, 
   3.473164007733922*^9, 3.473164297138042*^9, {3.473423662843185*^9, 
   3.473423704179063*^9}, 3.473423788361374*^9, 3.473616812361321*^9, 
   3.473617108539791*^9, 3.473617153125225*^9, 3.473617301178306*^9, 
   3.473618935357432*^9, {3.473620258807132*^9, 3.473620267091814*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "testsite"}], "}"}], ",", 
    RowBox[{
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}]}], ";", 
     RowBox[{"Timing", "[", 
      RowBox[{"new", "=", 
       RowBox[{"MPSMatrixVector", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"can", ".", "#"}], "&"}], "/@", 
          RowBox[{"mps", "[", 
           RowBox[{"[", "site", "]"}], "]"}]}], ",", "temp", ",", 
         RowBox[{"interactionsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"interactionsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"fieldL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"fieldR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"operatorsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"operatorsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"HMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], 
            ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
             RowBox[{"Min", "[", 
              RowBox[{"numTensors", ",", 
               RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}],
         "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "testsite"}], "}"}], ",", 
    RowBox[{
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}]}], ";", 
     RowBox[{"Timing", "[", 
      RowBox[{"Heff", "=", 
       RowBox[{"MPSEffectiveHam", "[", 
        RowBox[{
         RowBox[{"interactionsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"interactionsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"fieldL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"fieldR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"operatorsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"operatorsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"HMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], 
            ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
             RowBox[{"Min", "[", 
              RowBox[{"numTensors", ",", 
               RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}],
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Dimensions", "[", 
      RowBox[{"old", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Heff", ".", 
            RowBox[{"Flatten", "[", "temp", "]"}]}], ",", "10"}], "]"}], ",", 
         "1"}], "]"}]}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", "new", "\[IndentingNewLine]", "old"}], "Input",\

 CellChangeTimes->{{3.4724606438121433`*^9, 3.472460676110228*^9}, {
   3.472462447909309*^9, 3.47246249134626*^9}, {3.4724625402534513`*^9, 
   3.4724625719903383`*^9}, {3.472462802795916*^9, 3.472462831104908*^9}, {
   3.472462861489675*^9, 3.472463010266642*^9}, {3.472463182281623*^9, 
   3.4724631854907722`*^9}, {3.472463500047091*^9, 3.472463506458467*^9}, {
   3.4724657384034452`*^9, 3.472465742330604*^9}, {3.472466088446577*^9, 
   3.472466096521057*^9}, {3.472466129603302*^9, 3.472466129701433*^9}, 
   3.472466170578692*^9, {3.472466280701398*^9, 3.472466281038463*^9}, {
   3.472467312137054*^9, 3.472467344293009*^9}, {3.4724673887116203`*^9, 
   3.4724674113225822`*^9}, {3.4724674676025553`*^9, 3.472467509241569*^9}, {
   3.472467539385932*^9, 3.4724675555119867`*^9}, {3.472467702309668*^9, 
   3.472467711447235*^9}, {3.47246789119564*^9, 3.472467892506123*^9}, {
   3.472468589121419*^9, 3.4724685912821093`*^9}, {3.472470136571056*^9, 
   3.4724701607806377`*^9}, {3.472989796045066*^9, 3.472989826875085*^9}, {
   3.4730545422836123`*^9, 3.473054545176862*^9}, {3.473054581193801*^9, 
   3.473054664745623*^9}, {3.4730635617253733`*^9, 3.473063565948488*^9}, {
   3.473081324093655*^9, 3.4730813908787613`*^9}, {3.473159453750225*^9, 
   3.473159483647032*^9}, {3.4731595353416433`*^9, 3.4731595567387877`*^9}, {
   3.4731598532657623`*^9, 3.4731600092343187`*^9}, {3.473164019355049*^9, 
   3.473164020042047*^9}, {3.4731640744818783`*^9, 3.473164094610376*^9}, {
   3.473164140660574*^9, 3.4731641453951187`*^9}, {3.473164332196959*^9, 
   3.473164338856387*^9}, {3.4731643850135098`*^9, 3.473164386466338*^9}, {
   3.4736172532121763`*^9, 3.473617256031006*^9}, {3.473618124901415*^9, 
   3.473618174495308*^9}, {3.473618240735614*^9, 3.473618261027866*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.056018642994451445`"}], "-", 
       RowBox[{"0.21326041384784525`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.4614208660264081`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.17549088161304333`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.6124376045839481`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.5911748545654565`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.22862874097355584`"}], "-", 
       RowBox[{"0.39300825914378346`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.43590907231549086`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.5983533533848364`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.3891518164892114`"}], "-", 
       RowBox[{"0.32098673181381654`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.09978534306519919`"}], "-", 
       RowBox[{"0.18840938063562207`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.6938869659303794`"}], "-", 
       RowBox[{"0.05661962065056102`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.5146792070803698`"}], "+", 
       RowBox[{"0.8324731408039016`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.7743769047377519`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.2973108397537657`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.5426335741566837`", "\[InvisibleSpace]", "+", 
       RowBox[{"1.8202243951122739`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.6673072804465727`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.21304346536865515`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.4071064306397735`"}], "-", 
       RowBox[{"0.2676846299274045`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.3153125125040847`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.26803499742867054`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.10484459833109903`"}], "-", 
       RowBox[{"0.38646082182478636`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"1.6459912605315836`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.3518167537614158`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.3630007151508985`"}], "+", 
       RowBox[{"0.46742486879031614`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.04436500398900352`"}], "+", 
       RowBox[{"0.1314341019259607`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.7589977788409719`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.6399460699155891`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.11535209507215892`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.013127630650188765`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.473617256526758*^9, 3.4736173342161293`*^9, 3.4736173868081627`*^9, 
   3.4736174449727716`*^9, 3.4736176064612913`*^9, 3.4736176480979967`*^9, 
   3.473617876874383*^9, {3.473618118325673*^9, 3.473618144369814*^9}, 
   3.47361817544389*^9, 3.4736182476043367`*^9, 3.473618465507135*^9, 
   3.473618538383881*^9, 3.473618618712487*^9, 3.473618660500429*^9, 
   3.47361872667201*^9, 3.473618778872776*^9, {3.473618822838382*^9, 
   3.473618845428484*^9}, 3.473618938760075*^9, 3.473619253148307*^9, 
   3.473619600697192*^9, 3.473619663245677*^9, 3.4736197634840813`*^9, 
   3.473620004008439*^9, 3.4736202716369267`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.0560186429944515`"}], "-", 
       RowBox[{"0.21326041384784525`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.46142086602640814`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.17549088161304324`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.6124376045839485`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.5911748545654565`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.2286287409735558`"}], "-", 
       RowBox[{"0.39300825914378346`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.43590907231549075`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.5983533533848364`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.3891518164892114`"}], "-", 
       RowBox[{"0.32098673181381654`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.09978534306519904`"}], "-", 
       RowBox[{"0.18840938063562213`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.6938869659303792`"}], "-", 
       RowBox[{"0.056619620650561`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.51467920708037`"}], "+", 
       RowBox[{"0.8324731408039018`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.7743769047377518`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.29731083975376554`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.5426335741566835`", "\[InvisibleSpace]", "+", 
       RowBox[{"1.820224395112274`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.6673072804465731`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.21304346536865504`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.4071064306397734`"}], "-", 
       RowBox[{"0.2676846299274045`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.3153125125040846`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.2680349974286708`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.10484459833109912`"}], "-", 
       RowBox[{"0.38646082182478647`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"1.6459912605315836`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.35181675376141586`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.36300071515089827`"}], "+", 
       RowBox[{"0.46742486879031603`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.04436500398900349`"}], "+", 
       RowBox[{"0.13143410192596064`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.7589977788409721`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.6399460699155892`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.11535209507215892`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.013127630650188706`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.473617256526758*^9, 3.4736173342161293`*^9, 3.4736173868081627`*^9, 
   3.4736174449727716`*^9, 3.4736176064612913`*^9, 3.4736176480979967`*^9, 
   3.473617876874383*^9, {3.473618118325673*^9, 3.473618144369814*^9}, 
   3.47361817544389*^9, 3.4736182476043367`*^9, 3.473618465507135*^9, 
   3.473618538383881*^9, 3.473618618712487*^9, 3.473618660500429*^9, 
   3.47361872667201*^9, 3.473618778872776*^9, {3.473618822838382*^9, 
   3.473618845428484*^9}, 3.473618938760075*^9, 3.473619253148307*^9, 
   3.473619600697192*^9, 3.473619663245677*^9, 3.4736197634840813`*^9, 
   3.473620004008439*^9, 3.473620271661655*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], ",", 
          
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}], "=", 
     RowBox[{"MPSCanonizeSite", "[", 
      RowBox[{"new", ",", "can", ",", 
       RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
       RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], ";", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{
  3.473620124781756*^9, {3.473664907419531*^9, 3.473664908342752*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473620163306623*^9, 3.473620326802314*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testsite", "=", "2"}]], "Input",
 CellChangeTimes->{{3.473620175560657*^9, 3.473620178336194*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{3.473620179012746*^9, 3.473620369693091*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "testsite"}], "}"}], ",", 
   RowBox[{"Dimensions", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "}"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "5"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.473620550564353*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "testsite"}], "}"}], ",", 
    RowBox[{
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}]}], ";", 
     RowBox[{"Timing", "[", 
      RowBox[{"new", "=", 
       RowBox[{"MPSMatrixVector", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"can", ".", "#"}], "&"}], "/@", 
          RowBox[{"mps", "[", 
           RowBox[{"[", "site", "]"}], "]"}]}], ",", "temp", ",", 
         RowBox[{"interactionsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"interactionsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"fieldL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"fieldR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"operatorsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"operatorsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"HMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], 
            ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
             RowBox[{"Min", "[", 
              RowBox[{"numTensors", ",", 
               RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}],
         "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "testsite"}], "}"}], ",", 
    RowBox[{
     RowBox[{"temp", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}]}], ";", 
     RowBox[{"Timing", "[", 
      RowBox[{"Heff", "=", 
       RowBox[{"MPSEffectiveHam", "[", 
        RowBox[{
         RowBox[{"interactionsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"interactionsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"fieldL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"fieldR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"operatorsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"operatorsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"HMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", "site"}], 
            ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "IntRange"}]}], "]"}], ";;", 
             RowBox[{"Min", "[", 
              RowBox[{"numTensors", ",", 
               RowBox[{"site", "+", "IntRange"}]}], "]"}]}]}], "]"}], "]"}]}],
         "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Dimensions", "[", 
      RowBox[{"old", "=", 
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Heff", ".", 
            RowBox[{"Flatten", "[", "temp", "]"}]}], ",", "10"}], "]"}], ",", 
         "1"}], "]"}]}], "]"}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", "new", "\[IndentingNewLine]", "old"}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.21904265824216246`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.25126648013413444`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.8035175318533678`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.5026199739193251`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.0710006757733628`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.5099024867144719`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "1.4066577111749536`"}], "+", 
        RowBox[{"0.4198655579679841`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.6584358982358935`"}], "-", 
        RowBox[{"0.8234572723370108`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.6402407443382172`"}], "+", 
        RowBox[{"0.5803905657283848`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.20098899371243925`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.5774965040675168`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "1.3473686848901405`"}], "+", 
        RowBox[{"1.3194074015744715`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.5746569613255663`"}], "-", 
        RowBox[{"0.1428110258455047`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.4319800527878256`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.16436874239114188`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.33080921878480773`"}], "+", 
        RowBox[{"0.006248326411447652`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.2520913473429258`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.1126958148568535`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.7435089232824601`"}], "-", 
        RowBox[{"1.0264858087409647`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.38456162058882276`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.6827176935106876`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.1380709176749075`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.4453289837096831`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.6678279733266825`", "\[InvisibleSpace]", "+", 
        RowBox[{"1.0065083482258985`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.11725782607047303`"}], "-", 
        RowBox[{"1.0406509846292429`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.42341392305411646`"}], "-", 
        RowBox[{"0.4689363136028201`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.3244134698197932`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.6532805769647504`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.4069477519595988`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.05089011145731241`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.14532737788566397`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.4942106692341704`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.6119252521361113`"}], "+", 
        RowBox[{"0.19745797482932573`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.5992261906631376`"}], "+", 
        RowBox[{"0.30456698957866263`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.7977145524936707`"}], "-", 
        RowBox[{"0.014979542042875285`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.392502615607268`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.5673048629738733`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"1.5411277079520729`", "\[InvisibleSpace]", "-", 
        RowBox[{"1.1819460893129012`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.8982976571172626`"}], "-", 
        RowBox[{"0.8861564431197301`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "1.373711563291291`"}], "-", 
        RowBox[{"0.19252715500278442`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.03233601334206326`"}], "-", 
        RowBox[{"0.2562434312780385`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.8333775244949758`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.30371347354536615`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.022835528999045764`"}], "-", 
        RowBox[{"0.07722303147508029`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.19069082795553532`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.16877492713238662`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.06784398303737015`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.3389038872450214`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.020934522835810734`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.2241639457444317`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.7866803078603005`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.05070708049737141`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.5452313447463241`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.015211673219329952`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.6566424653093836`"}], "-", 
        RowBox[{"0.9617452368323992`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.572815495711165`"}], "-", 
        RowBox[{"0.31457128012810753`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.3961234318961078`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.04457914251014715`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.3316450747640341`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.428356441649748`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.473620181673627*^9, {3.473620360431649*^9, 3.4736203842671947`*^9}, 
   3.473620487165135*^9, 3.4736207362852583`*^9, 3.4736208153558207`*^9, 
   3.473620888569867*^9, 3.473620931568944*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.21904265824216274`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.2512664801341345`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.8035175318533679`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.5026199739193249`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"1.0710006757733628`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.5099024867144719`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "1.4066577111749536`"}], "+", 
       RowBox[{"0.419865557967984`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.6584358982358935`"}], "-", 
       RowBox[{"0.8234572723370108`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.6402407443382172`"}], "+", 
       RowBox[{"0.5803905657283851`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.2009889937124393`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.5774965040675167`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "1.3473686848901407`"}], "+", 
       RowBox[{"1.3194074015744712`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.5746569613255664`"}], "-", 
       RowBox[{"0.1428110258455047`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.43198005278782514`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.16436874239114188`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.3308092187848078`"}], "+", 
       RowBox[{"0.006248326411447616`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.2520913473429259`", "\[InvisibleSpace]", "-", 
       RowBox[{"1.1126958148568533`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.7435089232824599`"}], "-", 
       RowBox[{"1.0264858087409645`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.38456162058882276`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.6827176935106871`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"1.138070917674908`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.44532898370968294`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"1.6678279733266812`", "\[InvisibleSpace]", "+", 
       RowBox[{"1.0065083482258987`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.11725782607047319`"}], "-", 
       RowBox[{"1.0406509846292427`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.4234139230541163`"}], "-", 
       RowBox[{"0.46893631360282007`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.3244134698197932`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.6532805769647507`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.4069477519595986`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.050890111457312356`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.14532737788566424`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.4942106692341705`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.6119252521361113`"}], "+", 
       RowBox[{"0.19745797482932553`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.5992261906631376`"}], "+", 
       RowBox[{"0.3045669895786624`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.797714552493671`"}], "-", 
       RowBox[{"0.014979542042875296`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"1.3925026156072682`", "\[InvisibleSpace]", "-", 
       RowBox[{"1.5673048629738735`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"1.5411277079520738`", "\[InvisibleSpace]", "-", 
       RowBox[{"1.1819460893129012`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.8982976571172621`"}], "-", 
       RowBox[{"0.8861564431197302`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "1.3737115632912913`"}], "-", 
       RowBox[{"0.1925271550027845`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.03233601334206285`"}], "-", 
       RowBox[{"0.2562434312780387`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.8333775244949755`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.30371347354536604`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.02283552899904563`"}], "-", 
       RowBox[{"0.07722303147508021`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.19069082795553516`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.16877492713238654`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.06784398303736999`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.33890388724502174`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.02093452283581064`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.2241639457444318`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.7866803078603006`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.050707080497371576`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.5452313447463241`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.015211673219329813`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.6566424653093839`"}], "-", 
       RowBox[{"0.9617452368323995`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.5728154957111649`"}], "-", 
       RowBox[{"0.3145712801281074`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.3961234318961079`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.044579142510147086`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.33164507476403393`", "\[InvisibleSpace]", "-", 
       RowBox[{"0.42835644164974784`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.473620181673627*^9, {3.473620360431649*^9, 3.4736203842671947`*^9}, 
   3.473620487165135*^9, 3.4736207362852583`*^9, 3.4736208153558207`*^9, 
   3.473620888569867*^9, 3.473620931589028*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other things", "Section",
 CellChangeTimes->{{3.4736200993457747`*^9, 3.473620101314382*^9}}],

Cell[BoxData[
 RowBox[{"defineRight", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.473080092768757*^9, 3.473080095135935*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Print", "[", 
      RowBox[{"\"\<Left sweep:\>\"", "<>", "\"\<, site:\>\"", "<>", 
       RowBox[{"ToString", "[", "site", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", 
      RowBox[{"Dimensions", "/@", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"mps", "[", 
           RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
         RowBox[{"interactionsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"interactionsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"fieldL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"fieldR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"operatorsL", "[", 
          RowBox[{"site", "-", "1"}], "]"}], ",", 
         RowBox[{"operatorsR", "[", 
          RowBox[{"site", "+", "1"}], "]"}], ",", 
         RowBox[{"HMatrix", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", 
               RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
             RowBox[{"Min", "[", 
              RowBox[{"numTensors", ",", 
               RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
        "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"mps", "[", 
          RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], ";"}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{"site", ",", "numTensors", ",", "1", ",", 
      RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{3.473664840750998*^9}],

Cell[CellGroupData[{

Cell[BoxData["\<\"Left sweep:, site:10\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.4730801015238743`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080101628799*^9}],

Cell[BoxData["\<\"Left sweep:, site:9\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080101730422*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.4730801018295193`*^9}],

Cell[BoxData["\<\"Left sweep:, site:8\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.47308010200891*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080102108095*^9}],

Cell[BoxData["\<\"Left sweep:, site:7\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080102264574*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080102356731*^9}],

Cell[BoxData["\<\"Left sweep:, site:6\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.4730801024511747`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080102545578*^9}],

Cell[BoxData["\<\"Left sweep:, site:5\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080102648985*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080102751275*^9}],

Cell[BoxData["\<\"Left sweep:, site:4\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080102931368*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080103025105*^9}],

Cell[BoxData["\<\"Left sweep:, site:3\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080103191557*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080103284958*^9}],

Cell[BoxData["\<\"Left sweep:, site:2\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080103459333*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080103561162*^9}],

Cell[BoxData["\<\"Left sweep:, site:1\"\>"], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080103739044*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Print",
 CellChangeTimes->{3.473079678371838*^9, 3.473080050395248*^9, 
  3.473080103839486*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", 
   RowBox[{"TestCommunication", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"can", ".", "#"}], "&"}], "/@", 
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}]}], ",", 
     RowBox[{"interactionsL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"interactionsR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"fieldL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"fieldR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"operatorsL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"operatorsR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"HMatrix", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"1", ",", 
           RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"1", ",", 
           RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
         RowBox[{"Min", "[", 
          RowBox[{"numTensors", ",", 
           RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.4730619991722517`*^9, 3.473062021446682*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "10", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.4730620227003593`*^9, 3.4730621698965883`*^9, 
  3.4730622066943073`*^9, 3.473063383206608*^9, 3.473063714422329*^9, 
  3.473071620762266*^9, 3.473071935738504*^9, 3.473072221518477*^9, 
  3.473072710961872*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}], "=", 
     RowBox[{"MPSCanonizeSite", "[", 
      RowBox[{"new", ",", "can", ",", 
       RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
       RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4724693178605824`*^9, 3.472469326805233*^9}, 
   3.4724693933559723`*^9, 3.472470099337644*^9, {3.472974429194419*^9, 
   3.4729744392277403`*^9}, {3.47297452492603*^9, 3.4729745303055983`*^9}, {
   3.472975171644249*^9, 3.472975183300487*^9}, {3.4729772485186443`*^9, 
   3.472977262039773*^9}, {3.473061509921791*^9, 3.473061510326495*^9}, 
   3.473664845712891*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.8258763779623745`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{"0.5638512288926479`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0.36055993298349676`", "\[InvisibleSpace]", "+", 
       RowBox[{"0.43350287548144995`", " ", "\[ImaginaryI]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.5281143610799169`"}], "-", 
       RowBox[{"0.6349543395374204`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.472975184764381*^9, 3.472975305625753*^9, 3.4729761217523003`*^9, 
   3.472977266810256*^9, 3.4729872129426947`*^9, 3.472987595615037*^9, 
   3.472988023903215*^9, 3.4729883808955097`*^9, 3.47298859088581*^9, 
   3.4729889366556883`*^9, 3.473054319233521*^9, {3.473061498654475*^9, 
   3.473061537700922*^9}, 3.473062173861252*^9, 3.473062213909894*^9, 
   3.473063391176441*^9, 3.473063716538478*^9, 3.473071630812098*^9, 
   3.473071938377624*^9, 3.473072222282737*^9, 3.473072711822907*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.47298803150874*^9, 3.472988033367332*^9}, {
  3.473062186479352*^9, 3.4730621878045473`*^9}}],

Cell[BoxData[
 RowBox[{"-", "5.10619857206201`"}]], "Output",
 CellChangeTimes->{3.472988033810102*^9, 3.472988381902699*^9, 
  3.472988591904765*^9, 3.472988937455307*^9, 3.473054320326551*^9, 
  3.473061539887845*^9, 3.473062188246428*^9, 3.473062223670536*^9, 
  3.4730633930977163`*^9, 3.4730637181072083`*^9, 3.473071632251294*^9, 
  3.4730719393414793`*^9, 3.473072227455283*^9, 3.4730727126062098`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.472988033810102*^9, 3.472988381902699*^9, 
  3.472988591904765*^9, 3.472988937455307*^9, 3.473054320326551*^9, 
  3.473061539887845*^9, 3.473062188246428*^9, 3.473062223670536*^9, 
  3.4730633930977163`*^9, 3.4730637181072083`*^9, 3.473071632251294*^9, 
  3.4730719393414793`*^9, 3.473072227455283*^9, 3.473072712678418*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472988033810102*^9, 3.472988381902699*^9, 
  3.472988591904765*^9, 3.472988937455307*^9, 3.473054320326551*^9, 
  3.473061539887845*^9, 3.473062188246428*^9, 3.473062223670536*^9, 
  3.4730633930977163`*^9, 3.4730637181072083`*^9, 3.473071632251294*^9, 
  3.4730719393414793`*^9, 3.473072227455283*^9, 3.473072712801072*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472988033810102*^9, 3.472988381902699*^9, 
  3.472988591904765*^9, 3.472988937455307*^9, 3.473054320326551*^9, 
  3.473061539887845*^9, 3.473062188246428*^9, 3.473062223670536*^9, 
  3.4730633930977163`*^9, 3.4730637181072083`*^9, 3.473071632251294*^9, 
  3.4730719393414793`*^9, 3.473072227455283*^9, 3.473072713008719*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "2"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}], "=", 
     RowBox[{"MPSCanonizeSite", "[", 
      RowBox[{"new", ",", "can", ",", 
       RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
       RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.472977277057087*^9, 3.47297727714168*^9}, 
   3.473061545537428*^9, {3.473062242527562*^9, 3.473062244562306*^9}, 
   3.473071637548059*^9, 3.4736648467852097`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.4356796526600118`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.8772527409310645`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.15036558457648033`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.13416802809149053`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.4446704532208008`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.04313876142829791`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.161768151991187`"}], "-", 
        RowBox[{"0.049626116175205806`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.6071273850799961`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.5437449438533372`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.29417403574898526`"}], "+", 
        RowBox[{"0.14482734514094175`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.5560168530712843`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.3964248100634937`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.4000719095289962`"}], "-", 
        RowBox[{"0.19156396414670956`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.5363311550528167`"}], "+", 
        RowBox[{"0.06420818563046848`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.2092391348957442`"}], "-", 
        RowBox[{"0.037195824481855946`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.2390939936789849`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.2951561735867204`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.02389762021403788`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.06686225181656444`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.14123562662117517`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.03750552073374745`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.7743697576212683`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.479241641115832`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47306339736016*^9, 3.4730637195496607`*^9, 
  3.473071638549035*^9, 3.473071940591064*^9, 3.473072231167068*^9, 
  3.473072713755521*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.472988042006405*^9, 3.4729880439246883`*^9}, {
  3.473063399330529*^9, 3.4730634007775717`*^9}}],

Cell[BoxData[
 RowBox[{"-", "7.058120537557996`"}]], "Output",
 CellChangeTimes->{3.472988044424*^9, 3.472988397728703*^9, 
  3.47298859358468*^9, 3.472988939089403*^9, 3.473054322213068*^9, 
  3.473061548006556*^9, 3.473063401402945*^9, 3.473063721031804*^9, 
  3.473071640411302*^9, 3.473071941599031*^9, 3.473072232234952*^9, 
  3.4730727145560102`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.472988044424*^9, 3.472988397728703*^9, 
  3.47298859358468*^9, 3.472988939089403*^9, 3.473054322213068*^9, 
  3.473061548006556*^9, 3.473063401402945*^9, 3.473063721031804*^9, 
  3.473071640411302*^9, 3.473071941599031*^9, 3.473072232234952*^9, 
  3.473072714620328*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472988044424*^9, 3.472988397728703*^9, 
  3.47298859358468*^9, 3.472988939089403*^9, 3.473054322213068*^9, 
  3.473061548006556*^9, 3.473063401402945*^9, 3.473063721031804*^9, 
  3.473071640411302*^9, 3.473071941599031*^9, 3.473072232234952*^9, 
  3.473072714741867*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472988044424*^9, 3.472988397728703*^9, 
  3.47298859358468*^9, 3.472988939089403*^9, 3.473054322213068*^9, 
  3.473061548006556*^9, 3.473063401402945*^9, 3.473063721031804*^9, 
  3.473071640411302*^9, 3.473071941599031*^9, 3.473072232234952*^9, 
  3.473072714925115*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "3"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}], "=", 
     RowBox[{"MPSCanonizeSite", "[", 
      RowBox[{"new", ",", "can", ",", 
       RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
       RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], ";"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.472987292883089*^9, 3.472987293257235*^9}, 
   3.473061552704268*^9, 3.473063406527109*^9, 3.473664850005789*^9}],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "4", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.472988055028268*^9, 3.472988057814231*^9}, {
  3.47306341008082*^9, 3.4730634111967916`*^9}}],

Cell[BoxData[
 RowBox[{"-", "9.11616914599119`"}]], "Output",
 CellChangeTimes->{3.472988058258048*^9, 3.472988401672071*^9, 
  3.472988595615367*^9, 3.472988940720509*^9, 3.473054324036298*^9, 
  3.473061556249341*^9, 3.473063411735014*^9, 3.473063723479044*^9, 
  3.473071645755393*^9, 3.4730719434824038`*^9, 3.4730722345707207`*^9, 
  3.473072716586874*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.472988058258048*^9, 3.472988401672071*^9, 
  3.472988595615367*^9, 3.472988940720509*^9, 3.473054324036298*^9, 
  3.473061556249341*^9, 3.473063411735014*^9, 3.473063723479044*^9, 
  3.473071645755393*^9, 3.4730719434824038`*^9, 3.4730722345707207`*^9, 
  3.473072716650297*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472988058258048*^9, 3.472988401672071*^9, 
  3.472988595615367*^9, 3.472988940720509*^9, 3.473054324036298*^9, 
  3.473061556249341*^9, 3.473063411735014*^9, 3.473063723479044*^9, 
  3.473071645755393*^9, 3.4730719434824038`*^9, 3.4730722345707207`*^9, 
  3.473072716774562*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472988058258048*^9, 3.472988401672071*^9, 
  3.472988595615367*^9, 3.472988940720509*^9, 3.473054324036298*^9, 
  3.473061556249341*^9, 3.473063411735014*^9, 3.473063723479044*^9, 
  3.473071645755393*^9, 3.4730719434824038`*^9, 3.4730722345707207`*^9, 
  3.473072716965193*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "4"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4729873039884443`*^9, 3.472987304061762*^9}, {
   3.472987566872168*^9, 3.472987571892564*^9}, 3.473061560075808*^9, 
   3.473664850745009*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472987305128269*^9, 3.472987609767254*^9, 
  3.4729880659098454`*^9, 3.472988403733976*^9, 3.472988596606483*^9, 
  3.472988941637971*^9, 3.473054325846264*^9, 3.473061561175507*^9, 
  3.473063415719604*^9, 3.473063725046008*^9, 3.473071647737299*^9, 
  3.473071944442256*^9, 3.473072236266573*^9, 3.473072717726728*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "4", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.472988078664811*^9, 3.4729880902620173`*^9}, {
  3.473063417119302*^9, 3.473063417982127*^9}}],

Cell[BoxData[
 RowBox[{"-", "10.09564098855797`"}]], "Output",
 CellChangeTimes->{
  3.472987323060432*^9, 3.472987618640092*^9, {3.472988071297821*^9, 
   3.4729880905807123`*^9}, 3.472988406246619*^9, 3.472988597504858*^9, 
   3.472988942415267*^9, 3.4730543268514967`*^9, 3.473061562454019*^9, 
   3.47306341851856*^9, 3.4730637259602547`*^9, 3.473071648958743*^9, 
   3.473071945258525*^9, 3.473072237261959*^9, 3.473072718607396*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{
  3.472987323060432*^9, 3.472987618640092*^9, {3.472988071297821*^9, 
   3.4729880905807123`*^9}, 3.472988406246619*^9, 3.472988597504858*^9, 
   3.472988942415267*^9, 3.4730543268514967`*^9, 3.473061562454019*^9, 
   3.47306341851856*^9, 3.4730637259602547`*^9, 3.473071648958743*^9, 
   3.473071945258525*^9, 3.473072237261959*^9, 3.473072718675262*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{
  3.472987323060432*^9, 3.472987618640092*^9, {3.472988071297821*^9, 
   3.4729880905807123`*^9}, 3.472988406246619*^9, 3.472988597504858*^9, 
   3.472988942415267*^9, 3.4730543268514967`*^9, 3.473061562454019*^9, 
   3.47306341851856*^9, 3.4730637259602547`*^9, 3.473071648958743*^9, 
   3.473071945258525*^9, 3.473072237261959*^9, 3.473072718790781*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{
  3.472987323060432*^9, 3.472987618640092*^9, {3.472988071297821*^9, 
   3.4729880905807123`*^9}, 3.472988406246619*^9, 3.472988597504858*^9, 
   3.472988942415267*^9, 3.4730543268514967`*^9, 3.473061562454019*^9, 
   3.47306341851856*^9, 3.4730637259602547`*^9, 3.473071648958743*^9, 
   3.473071945258525*^9, 3.473072237261959*^9, 3.473072718902466*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "5"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4729873116212053`*^9, 3.472987311753777*^9}, {
   3.472987556443143*^9, 3.4729875604841013`*^9}, 3.473061566544738*^9, 
   3.473664851413906*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.47298732805704*^9, 3.47298762211705*^9, 
  3.4729880926054363`*^9, 3.47298840822825*^9, 3.472988598469654*^9, 
  3.472988943333996*^9, 3.473054328213373*^9, 3.473061566949168*^9, 
  3.47306342160612*^9, 3.473063727382031*^9, 3.473071650910397*^9, 
  3.47307194625403*^9, 3.473072238446657*^9, 3.473072719710854*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.472988097799604*^9, 3.472988099413972*^9}, {
  3.4730543304616528`*^9, 3.473054331642222*^9}}],

Cell[BoxData[
 RowBox[{"-", "12.837944540342486`"}]], "Output",
 CellChangeTimes->{3.472987633434957*^9, 3.472988099814234*^9, 
  3.472988409574759*^9, 3.472988599344409*^9, 3.472988944208559*^9, 
  3.473054332114093*^9, 3.473061568405964*^9, 3.4730634231270933`*^9, 
  3.473063728518578*^9, 3.4730716520906*^9, 3.473071947114831*^9, 
  3.473072239503375*^9, 3.473072722049191*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472987633434957*^9, 3.472988099814234*^9, 
  3.472988409574759*^9, 3.472988599344409*^9, 3.472988944208559*^9, 
  3.473054332114093*^9, 3.473061568405964*^9, 3.4730634231270933`*^9, 
  3.473063728518578*^9, 3.4730716520906*^9, 3.473071947114831*^9, 
  3.473072239503375*^9, 3.473072722121566*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472987633434957*^9, 3.472988099814234*^9, 
  3.472988409574759*^9, 3.472988599344409*^9, 3.472988944208559*^9, 
  3.473054332114093*^9, 3.473061568405964*^9, 3.4730634231270933`*^9, 
  3.473063728518578*^9, 3.4730716520906*^9, 3.473071947114831*^9, 
  3.473072239503375*^9, 3.4730727222382708`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472987633434957*^9, 3.472988099814234*^9, 
  3.472988409574759*^9, 3.472988599344409*^9, 3.472988944208559*^9, 
  3.473054332114093*^9, 3.473061568405964*^9, 3.4730634231270933`*^9, 
  3.473063728518578*^9, 3.4730716520906*^9, 3.473071947114831*^9, 
  3.473072239503375*^9, 3.473072722441133*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "6"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4729873334135513`*^9, 3.472987346292715*^9}, 
   3.4730634387538977`*^9, 3.4736648526144323`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{
  3.47298734813745*^9, 3.472987636723267*^9, 3.4729881063347816`*^9, 
   3.472988411151123*^9, 3.472988600249591*^9, 3.472988945380032*^9, 
   3.4730543346596613`*^9, {3.4730634250085373`*^9, 3.4730634437905827`*^9}, 
   3.473063729866061*^9, 3.473071653865473*^9, 3.473071948257785*^9, 
   3.473072240846532*^9, 3.473072723602008*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "6", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{
  3.472987645942594*^9, {3.472988110260325*^9, 3.472988118372466*^9}, {
   3.473054336097769*^9, 3.47305433703423*^9}}],

Cell[BoxData[
 RowBox[{"-", "15.352319331768369`"}]], "Output",
 CellChangeTimes->{3.472987646230549*^9, 3.4729881220827312`*^9, 
  3.4729884127743263`*^9, 3.4729886010552387`*^9, 3.472988946400754*^9, 
  3.4730543392674017`*^9, 3.473063445500573*^9, 3.4730637307738667`*^9, 
  3.4730716550983877`*^9, 3.473071949098504*^9, 3.473072241771302*^9, 
  3.4730727244593277`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472987646230549*^9, 3.4729881220827312`*^9, 
  3.4729884127743263`*^9, 3.4729886010552387`*^9, 3.472988946400754*^9, 
  3.4730543392674017`*^9, 3.473063445500573*^9, 3.4730637307738667`*^9, 
  3.4730716550983877`*^9, 3.473071949098504*^9, 3.473072241771302*^9, 
  3.4730727245218287`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472987646230549*^9, 3.4729881220827312`*^9, 
  3.4729884127743263`*^9, 3.4729886010552387`*^9, 3.472988946400754*^9, 
  3.4730543392674017`*^9, 3.473063445500573*^9, 3.4730637307738667`*^9, 
  3.4730716550983877`*^9, 3.473071949098504*^9, 3.473072241771302*^9, 
  3.473072724636848*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.472987646230549*^9, 3.4729881220827312`*^9, 
  3.4729884127743263`*^9, 3.4729886010552387`*^9, 3.472988946400754*^9, 
  3.4730543392674017`*^9, 3.473063445500573*^9, 3.4730637307738667`*^9, 
  3.4730716550983877`*^9, 3.473071949098504*^9, 3.473072241771302*^9, 
  3.4730727248281717`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSCanonizationCheck", "[", 
  RowBox[{"mps", ",", 
   RowBox[{"Site", "\[Rule]", "7"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.472987359012336*^9, 3.4729873811547956`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.472987381857292*^9, 3.472987649185121*^9, 
  3.4729881309045486`*^9, 3.4729884149282427`*^9, 3.47298860245059*^9, 
  3.4729889475756607`*^9, 3.473054342721991*^9, 3.473063450134166*^9, 
  3.473063732295444*^9, 3.473071658175675*^9, 3.473071950204874*^9, 
  3.473072243131605*^9, 3.473072726028842*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "7"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4729873870471*^9, 3.4729873873879843`*^9}, {
   3.473063456013286*^9, 3.473063456736023*^9}, 3.4736648532766953`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.472987390529196*^9, 3.472987658750739*^9, 
  3.472988202574956*^9, 3.472988416159586*^9, 3.472988603318192*^9, 
  3.472988948485635*^9, 3.4730543447100983`*^9, 3.473063457383527*^9, 
  3.473063733274495*^9, 3.47307165903826*^9, 3.473071951130179*^9, 
  3.4730722437965927`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "7", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "8", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.472987665363761*^9, 3.472987696373849*^9}, 
   3.473054346635351*^9}],

Cell[BoxData[
 RowBox[{"-", "17.317919152221798`"}]], "Output",
 CellChangeTimes->{3.472987665954545*^9, 3.472987697075346*^9, 
  3.472988205567732*^9, 3.472988417734685*^9, 3.472988604479137*^9, 
  3.472988949504672*^9, 3.473054347506425*^9, 3.4730634593346243`*^9, 
  3.4730637344554863`*^9, 3.47307166028328*^9, 3.4730719519669857`*^9, 
  3.473072244603394*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.472987665954545*^9, 3.472987697075346*^9, 
  3.472988205567732*^9, 3.472988417734685*^9, 3.472988604479137*^9, 
  3.472988949504672*^9, 3.473054347506425*^9, 3.4730634593346243`*^9, 
  3.4730637344554863`*^9, 3.47307166028328*^9, 3.4730719519669857`*^9, 
  3.473072244666621*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.472987665954545*^9, 3.472987697075346*^9, 
  3.472988205567732*^9, 3.472988417734685*^9, 3.472988604479137*^9, 
  3.472988949504672*^9, 3.473054347506425*^9, 3.4730634593346243`*^9, 
  3.4730637344554863`*^9, 3.47307166028328*^9, 3.4730719519669857`*^9, 
  3.473072244784062*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.472987665954545*^9, 3.472987697075346*^9, 
  3.472988205567732*^9, 3.472988417734685*^9, 3.472988604479137*^9, 
  3.472988949504672*^9, 3.473054347506425*^9, 3.4730634593346243`*^9, 
  3.4730637344554863`*^9, 3.47307166028328*^9, 3.4730719519669857`*^9, 
  3.4730722449648113`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSCanonizationCheck", "[", 
  RowBox[{"mps", ",", 
   RowBox[{"Site", "\[Rule]", "8"}]}], "]"}]], "Input",
 CellChangeTimes->{3.472987417779768*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.472987418316554*^9, 3.4729877093478928`*^9, 
  3.472988426153315*^9, 3.472988605615757*^9, 3.4729889521509867`*^9, 
  3.473054349954444*^9, 3.473063461671166*^9, 3.473063736027669*^9, 
  3.4730716624908047`*^9, 3.473071952955743*^9, 3.473072245691176*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "8"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.472987409812949*^9, 3.47298741026115*^9}, {
   3.4730634669139347`*^9, 3.473063467152052*^9}, 3.4736648540685043`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.472987421190167*^9, 3.472987711941537*^9, 
  3.472988428528871*^9, 3.4729886064944067`*^9, 3.4729889543258877`*^9, 
  3.47305435134967*^9, 3.473063467385846*^9, 3.473063737018221*^9, 
  3.473071663802305*^9, 3.47307195368756*^9, 3.473072246570121*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "8", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "9", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.47298772765304*^9, 3.472987729604271*^9}, 
   3.473054352603499*^9}],

Cell[BoxData[
 RowBox[{"-", "17.344832667148893`"}]], "Output",
 CellChangeTimes->{3.4729877690927362`*^9, 3.472988430482483*^9, 
  3.4729886076311207`*^9, 3.472988956191329*^9, 3.473054353314101*^9, 
  3.473063468758471*^9, 3.4730637383271713`*^9, 3.473071665099464*^9, 
  3.473071954586542*^9, 3.473072247723119*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.4729877690927362`*^9, 3.472988430482483*^9, 
  3.4729886076311207`*^9, 3.472988956191329*^9, 3.473054353314101*^9, 
  3.473063468758471*^9, 3.4730637383271713`*^9, 3.473071665099464*^9, 
  3.473071954586542*^9, 3.473072247804742*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.4729877690927362`*^9, 3.472988430482483*^9, 
  3.4729886076311207`*^9, 3.472988956191329*^9, 3.473054353314101*^9, 
  3.473063468758471*^9, 3.4730637383271713`*^9, 3.473071665099464*^9, 
  3.473071954586542*^9, 3.4730722479234753`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.4729877690927362`*^9, 3.472988430482483*^9, 
  3.4729886076311207`*^9, 3.472988956191329*^9, 3.473054353314101*^9, 
  3.473063468758471*^9, 3.4730637383271713`*^9, 3.473071665099464*^9, 
  3.473071954586542*^9, 3.4730722481074038`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "9"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.472987447538903*^9, 3.472987460857132*^9}, 
   3.473063474114571*^9, 3.47366485485776*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.472987448627371*^9, 3.47298746326968*^9}, 
   3.472988434656115*^9, 3.472988608974193*^9, 3.472988957358532*^9, 
   3.4730543686419086`*^9, 3.473063474519352*^9, 3.4730637398619423`*^9, 
   3.473071667663175*^9, 3.473071955706347*^9, 3.473072249113707*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "9", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4729884476051693`*^9, 3.4729884494744873`*^9}, {
  3.473054369944227*^9, 3.473054371641602*^9}}],

Cell[BoxData[
 RowBox[{"-", "17.347342334784045`"}]], "Output",
 CellChangeTimes->{3.472988449826744*^9, 3.4729886103511953`*^9, 
  3.472988958735539*^9, 3.473054372252407*^9, 3.473063476278809*^9, 
  3.473063741195071*^9, 3.47307166957836*^9, 3.4730719565026913`*^9, 
  3.473072250027113*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.472988449826744*^9, 3.4729886103511953`*^9, 
  3.472988958735539*^9, 3.473054372252407*^9, 3.473063476278809*^9, 
  3.473063741195071*^9, 3.47307166957836*^9, 3.4730719565026913`*^9, 
  3.473072250085683*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.472988449826744*^9, 3.4729886103511953`*^9, 
  3.472988958735539*^9, 3.473054372252407*^9, 3.473063476278809*^9, 
  3.473063741195071*^9, 3.47307166957836*^9, 3.4730719565026913`*^9, 
  3.473072250196691*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.472988449826744*^9, 3.4729886103511953`*^9, 
  3.472988958735539*^9, 3.473054372252407*^9, 3.473063476278809*^9, 
  3.473063741195071*^9, 3.47307166957836*^9, 3.4730719565026913`*^9, 
  3.473072250383582*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "10"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
    RowBox[{"FindGroundMPSSiteManual", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.472989044980818*^9, 3.472989051381583*^9}, 
   3.4729890829381943`*^9, 3.473061177778582*^9, {3.4730635029059343`*^9, 
   3.4730635097525682`*^9}, 3.473664855691226*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "17.37937196944646`"}], "-", 
     RowBox[{"4.60466389309148`*^-16", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.7249535225125423`", "\[InvisibleSpace]", "-", 
         RowBox[{"0.2763373877343316`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.1765906278991753`"}], "+", 
         RowBox[{"0.16217187918233628`", " ", "\[ImaginaryI]"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.37093286406672454`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.17452692032694556`", " ", "\[ImaginaryI]"}]}], "}"}], ",",
        
       RowBox[{"{", 
        RowBox[{"0.4115692619470829`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.056178084109816506`", " ", "\[ImaginaryI]"}]}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.472989090324285*^9, {3.4729891943882847`*^9, 3.4729891982566023`*^9}, 
   3.473054383125608*^9, 3.4730611782268543`*^9, {3.473063503693285*^9, 
   3.473063510334907*^9}, 3.473063768040119*^9, 3.4730716772288923`*^9, 
   3.473071957674337*^9, 3.4730722548263702`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"site", "=", "10"}], "}"}], ",", 
     RowBox[{"MPSEffectiveHam", "[", 
      RowBox[{
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     "\[IndentingNewLine]", "]"}], ".", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "//", 
  "Normal"}]], "Input",
 CellChangeTimes->{{3.472989221411861*^9, 3.47298928038303*^9}, 
   3.4730611728767147`*^9, {3.473063521367395*^9, 3.473063526970385*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "17.100843943137985`"}], "+", 
    RowBox[{"1.797357617283917`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "13.134287034662066`"}], "-", 
    RowBox[{"0.7360581333756451`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "15.474716685087806`"}], "-", 
    RowBox[{"0.7454393135171318`", " ", "\[ImaginaryI]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "15.909116916535222`"}], "-", 
    RowBox[{"0.3158601703911391`", " ", "\[ImaginaryI]"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.472989249478909*^9, 3.472989281094487*^9}, 
   3.473054394947598*^9, 3.473061180051317*^9, {3.473063522444858*^9, 
   3.473063528247147*^9}, 3.473063777941584*^9, 3.473071681849882*^9, 
   3.4730719592303133`*^9, 3.473072258142619*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "10"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
    RowBox[{"FindGroundMPSSite", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.472988463892659*^9, 3.472988463961852*^9}, 
   3.472988664005599*^9, 3.472989102286933*^9, {3.473061187004974*^9, 
   3.473061188316936*^9}, {3.473063533147933*^9, 3.473063537053175*^9}, 
   3.473664860227892*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "17.179803602821135`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.019601010566030863`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.7066279616244653`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.013327467325346218`"}], "-", 
         RowBox[{"0.2844706713966004`", " ", "\[ImaginaryI]"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.2659715710930665`"}], "+", 
         RowBox[{"0.2590770087066376`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "0.3979370671121391`"}], "+", 
         RowBox[{"0.3506791375505513`", " ", "\[ImaginaryI]"}]}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.472989110834949*^9, 3.473054413153623*^9, 
  3.4730547564731007`*^9, 3.47305527007843*^9, 3.4730635379643297`*^9, 
  3.473063790086156*^9, 3.473071687598507*^9, 3.473071961051218*^9, 
  3.4730722604266977`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"defineRight", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.4730553835842667`*^9, 3.4730553875110483`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "10"}], "}"}], ",", 
   RowBox[{"Dimensions", "[", 
    RowBox[{
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}], "=", 
     RowBox[{"MPSCanonizeSite", "[", 
      RowBox[{"new", ",", "can", ",", 
       RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.473055361628582*^9, 3.473055375961378*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473071733775545*^9, 3.4730719666077337`*^9, 
  3.473072304315412*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "9"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "9", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4730554220951777`*^9, 3.473055448522502*^9}, 
   3.473063836369934*^9, 3.473664861095173*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473071752457183*^9, 3.473071967917844*^9, 
  3.473072310286313*^9}],

Cell[BoxData[
 RowBox[{"-", "17.347342334784017`"}]], "Output",
 CellChangeTimes->{3.473071752457183*^9, 3.473071967917844*^9, 
  3.473072310357375*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473071752457183*^9, 3.473071967917844*^9, 
  3.4730723104826393`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.473071752457183*^9, 3.473071967917844*^9, 
  3.473072310592415*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473071752457183*^9, 3.473071967917844*^9, 
  3.473072310703162*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "8"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "9", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4730554220951777`*^9, 3.473055448522502*^9}, 
   3.473063836369934*^9, 3.4730717625530167`*^9, 3.473664861825433*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.4730717634465103`*^9, 3.473071970551647*^9, 
  3.473072311966556*^9}],

Cell[BoxData[
 RowBox[{"-", "17.344832667148886`"}]], "Output",
 CellChangeTimes->{3.4730717634465103`*^9, 3.473071970551647*^9, 
  3.473072312033204*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.4730717634465103`*^9, 3.473071970551647*^9, 
  3.473072312135569*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.4730717634465103`*^9, 3.473071970551647*^9, 
  3.473072312236638*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.4730717634465103`*^9, 3.473071970551647*^9, 
  3.473072312345252*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "7"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "9", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4730554220951777`*^9, 3.473055448522502*^9}, 
   3.473063836369934*^9, 3.4730717713016453`*^9, 3.473664863262981*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.473071771949094*^9, 3.473071972071664*^9, 
  3.473072313211783*^9}],

Cell[BoxData[
 RowBox[{"-", "17.31791915222198`"}]], "Output",
 CellChangeTimes->{3.473071771949094*^9, 3.473071972071664*^9, 
  3.473072313276492*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473071771949094*^9, 3.473071972071664*^9, 
  3.4730723133826933`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.473071771949094*^9, 3.473071972071664*^9, 
  3.4730723135675097`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473071771949094*^9, 3.473071972071664*^9, 
  3.473072313673766*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "6"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "6", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4730554220951777`*^9, 3.473055448522502*^9}, 
   3.473063836369934*^9, {3.4730717994789352`*^9, 3.473071805169642*^9}, 
   3.473664863802807*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.47307180876508*^9, 3.473071973519684*^9, 
  3.473072314542193*^9}],

Cell[BoxData[
 RowBox[{"-", "17.389538393373197`"}]], "Output",
 CellChangeTimes->{3.47307180876508*^9, 3.473071973519684*^9, 
  3.4730723146086903`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.47307180876508*^9, 3.473071973519684*^9, 
  3.4730723147120934`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.47307180876508*^9, 3.473071973519684*^9, 
  3.473072314819483*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.47307180876508*^9, 3.473071973519684*^9, 
  3.473072314921137*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "5"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "4", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "5", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4730554220951777`*^9, 3.473055448522502*^9}, 
   3.473063836369934*^9, {3.47307181493382*^9, 3.473071820070983*^9}, 
   3.473664864249199*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.4730718207219887`*^9, 3.4730719746818027`*^9, 
  3.47307231593425*^9}],

Cell[BoxData[
 RowBox[{"-", "17.34103446383397`"}]], "Output",
 CellChangeTimes->{3.4730718207219887`*^9, 3.4730719746818027`*^9, 
  3.473072316000395*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.4730718207219887`*^9, 3.4730719746818027`*^9, 
  3.47307231610397*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.4730718207219887`*^9, 3.4730719746818027`*^9, 
  3.473072316216792*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.4730718207219887`*^9, 3.4730719746818027`*^9, 
  3.473072316321341*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "4"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "9", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4730554220951777`*^9, 3.473055448522502*^9}, 
   3.473063836369934*^9, 3.473071829193225*^9, 3.473664865836841*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.473071829629066*^9, 3.4730719759819727`*^9, 
  3.473072317345861*^9}],

Cell[BoxData[
 RowBox[{"-", "17.38400534756289`"}]], "Output",
 CellChangeTimes->{3.473071829629066*^9, 3.4730719759819727`*^9, 
  3.4730723174134207`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473071829629066*^9, 3.4730719759819727`*^9, 
  3.473072317520906*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.473071829629066*^9, 3.4730719759819727`*^9, 
  3.47307231770534*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473071829629066*^9, 3.4730719759819727`*^9, 
  3.473072317808045*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "3"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4730554220951777`*^9, 3.473055448522502*^9}, 
   3.473063836369934*^9, {3.473071835848701*^9, 3.473071842424623*^9}, 
   3.47366486821762*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.473071843820545*^9, 3.473071977209683*^9, 
  3.473072318730055*^9}],

Cell[BoxData[
 RowBox[{"-", "17.301107551076974`"}]], "Output",
 CellChangeTimes->{3.473071843820545*^9, 3.473071977209683*^9, 
  3.473072318796443*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.473071843820545*^9, 3.473071977209683*^9, 
  3.473072318897747*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.473071843820545*^9, 3.473071977209683*^9, 
  3.4730723190709343`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.473071843820545*^9, 3.473071977209683*^9, 
  3.473072319176951*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "2"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.4730554220951777`*^9, 3.473055448522502*^9}, 
   3.473063836369934*^9, {3.4730718543259583`*^9, 3.473071862309038*^9}, 
   3.47366486831474*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.473071863185714*^9, 3.4730719785899982`*^9, 
  3.473072320089979*^9}],

Cell[BoxData[
 RowBox[{"-", "17.283074159182053`"}]], "Output",
 CellChangeTimes->{3.473071863185714*^9, 3.4730719785899982`*^9, 
  3.473072320155869*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473071863185714*^9, 3.4730719785899982`*^9, 
  3.4730723202625313`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473071863185714*^9, 3.4730719785899982`*^9, 
  3.473072320435611*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.473071863185714*^9, 3.4730719785899982`*^9, 
  3.47307232054067*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{
   RowBox[{"fieldL", "[", "0", "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.473071998101993*^9, 3.473072016702462*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.473072004783868*^9, 3.4730720173415422`*^9}, 
   3.473072323803877*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", 
   RowBox[{"Dimensions", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "}"}]}]}], "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.473071985455255*^9, 3.473071989793964*^9}, {
  3.4730720430319443`*^9, 3.4730720518594627`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.473072052610629*^9, 3.4730723266541023`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", 
   RowBox[{"TestCommunication", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
     RowBox[{"interactionsL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"interactionsR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"fieldL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"fieldR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"operatorsL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"operatorsR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"HMatrix", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"1", ",", 
           RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"1", ",", 
           RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
         RowBox[{"Min", "[", 
          RowBox[{"numTensors", ",", 
           RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "2", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473071899317083*^9, 3.473072061951249*^9, 
  3.4730723287622757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{3.473072093715163*^9, 3.473664868416746*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473072139981573*^9, 3.4730723323784323`*^9}],

Cell[BoxData[
 RowBox[{"-", "17.28115628754273`"}]], "Output",
 CellChangeTimes->{3.473072139981573*^9, 3.473072332443528*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473072139981573*^9, 3.473072332566575*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473072139981573*^9, 3.473072332750102*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.473072139981573*^9, 3.473072332867839*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["can"], "Input",
 CellChangeTimes->{{3.473072339101337*^9, 3.473072339258456*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0.9999999999999998`", "\[InvisibleSpace]", "+", 
    RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.473072339693812*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", "can", "]"}]], "Input",
 CellChangeTimes->{{3.473072342907506*^9, 3.473072346045923*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0.9999999999999998`", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.473072346381013*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"defineLeft", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.473072376602333*^9, 3.4730723787802362`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", 
   RowBox[{"TestCommunication", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"can", ".", "#"}], "&"}], "/@", 
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}]}], ",", 
     RowBox[{"interactionsL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"interactionsR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"fieldL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"fieldR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"operatorsL", "[", 
      RowBox[{"site", "-", "1"}], "]"}], ",", 
     RowBox[{"operatorsR", "[", 
      RowBox[{"site", "+", "1"}], "]"}], ",", 
     RowBox[{"HMatrix", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"1", ",", 
           RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
        RowBox[{
         RowBox[{"Max", "[", 
          RowBox[{"1", ",", 
           RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
         RowBox[{"Min", "[", 
          RowBox[{"numTensors", ",", 
           RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "2", ",", "0", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473072413534589*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "1"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Dimensions", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"mps", "[", 
           RowBox[{"[", "site", "]"}], "]"}], "=", 
          RowBox[{"MPSCanonizeSite", "[", 
           RowBox[{"new", ",", "can", ",", 
            RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
            RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], ","}], 
        "]"}], "\[IndentingNewLine]", "energy"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.473072421077173*^9, 3.473072496356103*^9}, 
   3.473664868512179*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "138.2492503003416`"}], ",", 
   RowBox[{"-", "34.5623125750854`"}], ",", 
   RowBox[{"-", "276.4985006006832`"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4730724633779*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", 
    RowBox[{"1", "+", "1"}], "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.473072514257812*^9, 3.473072532529315*^9}}],

Cell[BoxData[
 RowBox[{"-", "17.2811562875427`"}]], "Output",
 CellChangeTimes->{3.473072533404104*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473072533411212*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473072533519479*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.473072533689557*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "2"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], "=", 
        RowBox[{"MPSCanonizeSite", "[", 
         RowBox[{"new", ",", "can", ",", 
          RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
          RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "energy", ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.4730725059297113`*^9, 3.4730725060437193`*^9}, {
   3.473072556350988*^9, 3.473072558948475*^9}, 3.4736648686132402`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimensions", "::", "\<\"innf\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Non-negative integer or Infinity expected at position \
\\!\\(2\\) in \
\\!\\(Dimensions[\\(\\(\\(\\({\\(\\({\\(\\({\\(\\(\\(\\(0.41228478061342305` \
\[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.8911610681961728`\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\
\\), \\(\\(\\(\\(0.18819527482363918` \[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(-0.020874595566222707`\\)\\) + \
\\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\), \
\\(\\({\\(\\(\\(\\(0.43061800740990064` \[InvisibleSpace]\\)\\) + \
\\(\\(0.09317213651989997`\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\), \\(\\(\\(\\(-0.43057547590386785`\\)\\) + \
\\(\\(0.24541560244570182`\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\), \
\\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] \
4 \[RightSkeleton]\\)\\)\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/innf\\\", ButtonNote -> \
\\\"Dimensions::innf\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473072540460881*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dimensions", "::", "\<\"innf\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Non-negative integer or Infinity expected at position \
\\!\\(2\\) in \
\\!\\(Dimensions[\\(\\(\\(\\({\\(\\({\\(\\({\\(\\(\\(\\(0.41228478061342305` \
\[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.8911610681961728`\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\
\\), \\(\\(\\(\\(0.18819527482363918` \[InvisibleSpace]\\)\\) + \\(\\(0.`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(-0.020874595566222707`\\)\\) + \
\\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\), \
\\(\\({\\(\\(\\(\\(0.43061800740990064` \[InvisibleSpace]\\)\\) + \
\\(\\(0.09317213651989997`\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\), \\(\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)\\), \\(\\(\\(\\(-0.43057547590386785`\\)\\) + \
\\(\\(0.24541560244570182`\\\\ \[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\), \
\\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] \
4 \[RightSkeleton]\\)\\)\\)\\)]\\). \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/innf\\\", ButtonNote -> \
\\\"Dimensions::innf\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473072540557219*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "17.28307415918206`"}], " ", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.41228478061342305`", "\[InvisibleSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.8911610681961728`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{"0.18819527482363918`", "\[InvisibleSpace]", "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.020874595566222707`"}], "+", 
             RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.43061800740990064`", "\[InvisibleSpace]", "+", 
             RowBox[{"0.09317213651989997`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{"0.05929954479660465`", "\[InvisibleSpace]", "-", 
             RowBox[{"0.010831120157525083`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.7103254535704556`"}], "-", 
             RowBox[{"0.22818200439559094`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.43057547590386785`"}], "+", 
             RowBox[{"0.24541560244570182`", " ", "\[ImaginaryI]"}]}]}], 
           "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "0.5055681226929413`"}], "-", 
             RowBox[{"0.5630713324774979`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.29490381922512776`"}], "-", 
             RowBox[{"0.3386378617907292`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.2895813238601224`"}], "-", 
             RowBox[{"0.3744505713555908`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.00618344058658124`"}], "-", 
             RowBox[{"0.03998593968371661`", " ", "\[ImaginaryI]"}]}]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0.1162422569782896`", "\[InvisibleSpace]", "+", 
             RowBox[{"0.2230417671570279`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.012034557634486014`"}], "+", 
             RowBox[{"0.020236273008734346`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.21842098064372162`"}], "-", 
             RowBox[{"0.36901891972027256`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{"0.8404400515435114`", "\[InvisibleSpace]", "+", 
             RowBox[{"0.21439123661656284`", " ", "\[ImaginaryI]"}]}]}], 
           "}"}]}], "}"}]}], "}"}], ",", "Null"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47307254065864*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "3"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], "=", 
        RowBox[{"MPSCanonizeSite", "[", 
         RowBox[{"new", ",", "can", ",", 
          RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
          RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "energy", ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.47307257206135*^9, 3.4736648687149076`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "8"}], "}"}], ",", 
   RowBox[{"-", "17.301107551076914`"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "10"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.473072577647826*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "4"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], "=", 
        RowBox[{"MPSCanonizeSite", "[", 
         RowBox[{"new", ",", "can", ",", 
          RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
          RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "energy", ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.473072590964673*^9, 3.473664868811469*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "10"}], "}"}], ",", 
   RowBox[{"-", "17.384005347562915`"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.473072592066502*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "5"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], "=", 
        RowBox[{"MPSCanonizeSite", "[", 
         RowBox[{"new", ",", "can", ",", 
          RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
          RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "energy", ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.473072599652835*^9, 3.473664868914097*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"-", "17.341961785919885`"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4730726005814457`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "6"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], "=", 
        RowBox[{"MPSCanonizeSite", "[", 
         RowBox[{"new", ",", "can", ",", 
          RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
          RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "energy", ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.473072611556341*^9, 3.473664869010611*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"-", "17.390638342659066`"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "8"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.473072612130074*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "7"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], "=", 
        RowBox[{"MPSCanonizeSite", "[", 
         RowBox[{"new", ",", "can", ",", 
          RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
          RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "energy", ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.473072618627812*^9, 3.473072618747477*^9}, 
   3.4736648691113787`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "8"}], "}"}], ",", 
   RowBox[{"-", "17.322569138355313`"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "10", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "4"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.4730726200779047`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "8"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], "=", 
        RowBox[{"MPSCanonizeSite", "[", 
         RowBox[{"new", ",", "can", ",", 
          RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
          RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "energy", ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.47307262728471*^9, 3.4730726273730803`*^9}, 
   3.47366486921035*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "4"}], "}"}], ",", 
   RowBox[{"-", "17.34955220908777`"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "8", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.473072628914714*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "9"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], "=", 
        RowBox[{"MPSCanonizeSite", "[", 
         RowBox[{"new", ",", "can", ",", 
          RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
          RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "energy", ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{3.4730726346601973`*^9, 3.473664869310533*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"-", "17.352588473469975`"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.473072638705357*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "10"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"can", ".", "#"}], "&"}], "/@", 
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}]}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Dimensions", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], "=", 
        RowBox[{"MPSCanonizeSite", "[", 
         RowBox[{"new", ",", "can", ",", 
          RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
          RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}], ",", 
      "\[IndentingNewLine]", "energy", ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Dimensions", "[", "can", "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"site", "+", "1"}], "]"}], "]"}], "]"}]}], "}"}]}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.473072644804701*^9, 3.4730726448923683`*^9}, 
   3.473664869409679*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part \\!\\(11\\) of \
\\!\\({\\(\\({\\(\\({\\({\\(\\(\\(\\(0.8786810747270531` \[InvisibleSpace]\\)\
\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.4774092258393326`\\)\\) + \\(\\(0.`\\\\ \[ImaginaryI]\\)\\)\\)\
\\)}\\)}\\)\\), \\(\\({\\({\\(\\(\\(\\(0.3249028885585425` \
\[InvisibleSpace]\\)\\) + \\(\\(0.34979662937602224`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5979901599065905` \
\[InvisibleSpace]\\)\\) + \\(\\(0.6438075797459826`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)}\\)\\)}\\)\\), \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\)}\\) does not exist. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4730726458357153`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"-", "17.186519029851745`"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", "2", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.473072645940789*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"testsite", "=", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.4724685788567667`*^9, 3.472468599948432*^9}, {
   3.472468664046069*^9, 3.472468664103245*^9}, 3.472470125208104*^9, {
   3.472989686643928*^9, 3.472989686707499*^9}, {3.473054495675261*^9, 
   3.473054497062055*^9}, {3.4730546747146482`*^9, 3.473054674886344*^9}, 
   3.473061194110531*^9, 3.473063553225494*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "testsite"}], "}"}], ",", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}]}], ";", 
    RowBox[{"Timing", "[", 
     RowBox[{"new", "=", 
      RowBox[{"MPSMatrixVector", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", "temp", ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "testsite"}], "}"}], ",", 
   RowBox[{
    RowBox[{"Timing", "[", 
     RowBox[{"old", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MPSEffectiveHam", "[", 
            RowBox[{
             RowBox[{"interactionsL", "[", 
              RowBox[{"site", "-", "1"}], "]"}], ",", 
             RowBox[{"interactionsR", "[", 
              RowBox[{"site", "+", "1"}], "]"}], ",", 
             RowBox[{"fieldL", "[", 
              RowBox[{"site", "-", "1"}], "]"}], ",", 
             RowBox[{"fieldR", "[", 
              RowBox[{"site", "+", "1"}], "]"}], ",", 
             RowBox[{"operatorsL", "[", 
              RowBox[{"site", "-", "1"}], "]"}], ",", 
             RowBox[{"operatorsR", "[", 
              RowBox[{"site", "+", "1"}], "]"}], ",", 
             RowBox[{"HMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
                 RowBox[{"Min", "[", 
                  RowBox[{"numTensors", ",", 
                   RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
            "]"}], ".", 
           RowBox[{"Flatten", "[", 
            RowBox[{"mps", "[", 
             RowBox[{"[", "site", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"mps", "[", 
            RowBox[{"[", 
             RowBox[{"site", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"mps", "[", 
          RowBox[{"[", 
           RowBox[{"site", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], 
       "]"}]}], "]"}], "//", "Normal"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.4724606438121433`*^9, 3.472460676110228*^9}, {
   3.472462447909309*^9, 3.47246249134626*^9}, {3.4724625402534513`*^9, 
   3.4724625719903383`*^9}, {3.472462802795916*^9, 3.472462831104908*^9}, {
   3.472462861489675*^9, 3.472463010266642*^9}, {3.472463182281623*^9, 
   3.4724631854907722`*^9}, {3.472463500047091*^9, 3.472463506458467*^9}, {
   3.4724657384034452`*^9, 3.472465742330604*^9}, {3.472466088446577*^9, 
   3.472466096521057*^9}, {3.472466129603302*^9, 3.472466129701433*^9}, 
   3.472466170578692*^9, {3.472466280701398*^9, 3.472466281038463*^9}, {
   3.472467312137054*^9, 3.472467344293009*^9}, {3.4724673887116203`*^9, 
   3.4724674113225822`*^9}, {3.4724674676025553`*^9, 3.472467509241569*^9}, {
   3.472467539385932*^9, 3.4724675555119867`*^9}, {3.472467702309668*^9, 
   3.472467711447235*^9}, {3.47246789119564*^9, 3.472467892506123*^9}, {
   3.472468589121419*^9, 3.4724685912821093`*^9}, {3.472470136571056*^9, 
   3.4724701607806377`*^9}, {3.472989796045066*^9, 3.472989826875085*^9}, {
   3.4730545422836123`*^9, 3.473054545176862*^9}, {3.473054581193801*^9, 
   3.473054664745623*^9}, {3.4730635617253733`*^9, 3.473063565948488*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"LinkObject", "::", "\<\"linkd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Unable to communicate with closed link \
\\!\\(LinkObject[\\(\\(\\\"/ICFO/home/fcucchietti/Mathematica/MPS/\
arpackformps/Linux-x86-64/arpackformps\\\", 520, 7\\)\\)]\\). \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/LinkObject/linkd\\\", \
ButtonNote -> \\\"LinkObject::linkd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.473063567058929*^9, 3.4730635807055492`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "$Failed"}], "}"}]], "Output",
 CellChangeTimes->{
  3.4724606773766623`*^9, 3.4724608684671*^9, 3.47246115369849*^9, 
   3.4724612838893433`*^9, 3.472461342850691*^9, 3.472462427255107*^9, 
   3.4724624947361183`*^9, 3.472462578091269*^9, 3.47246268892948*^9, 
   3.472462834701461*^9, 3.4724628704431334`*^9, {3.4724629551627607`*^9, 
   3.472463011356473*^9}, 3.472463356208746*^9, 3.4724634570247583`*^9, 
   3.472463507206932*^9, 3.472463793569631*^9, 3.472463829840391*^9, 
   3.472465104284863*^9, 3.472465142165859*^9, 3.4724652260047913`*^9, 
   3.472465313850058*^9, 3.4724655095884047`*^9, 3.472465603480195*^9, 
   3.472465745879465*^9, 3.472465823714623*^9, {3.47246608317032*^9, 
   3.472466098024962*^9}, 3.472466130432324*^9, 3.47246617134026*^9, 
   3.4724662707584677`*^9, 3.472466322306493*^9, 3.472466370639168*^9, 
   3.4724664273191557`*^9, {3.4724664775719767`*^9, 3.472466483906304*^9}, {
   3.472466538573092*^9, 3.472466556649413*^9}, {3.472467351437305*^9, 
   3.472467412875902*^9}, {3.472467470692979*^9, 3.4724674790852137`*^9}, {
   3.472467511707183*^9, 3.472467556403837*^9}, {3.472467704741498*^9, 
   3.472467712083653*^9}, 3.472467893553629*^9, 3.472468135182638*^9, 
   3.4724685170188713`*^9, {3.4724685936479683`*^9, 3.472468601859074*^9}, 
   3.472468666394476*^9, {3.472470163001091*^9, 3.472470176091954*^9}, {
   3.472989801922962*^9, 3.472989848619678*^9}, 3.473054504828915*^9, 
   3.473054546284025*^9, {3.473054666718327*^9, 3.473054701138109*^9}, {
   3.4730611999250517`*^9, 3.4730612238232803`*^9}, {3.4730635558287067`*^9, 
   3.4730635807407093`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"11.293018883881349`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.12340977223048927`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"10.74479973510812`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.679775609070499`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "3.905376155398679`"}], "+", 
         RowBox[{"10.396301251748435`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"5.126645548357356`", "\[InvisibleSpace]", "-", 
         RowBox[{"8.606827233275355`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4724606773766623`*^9, 3.4724608684671*^9, 3.47246115369849*^9, 
   3.4724612838893433`*^9, 3.472461342850691*^9, 3.472462427255107*^9, 
   3.4724624947361183`*^9, 3.472462578091269*^9, 3.47246268892948*^9, 
   3.472462834701461*^9, 3.4724628704431334`*^9, {3.4724629551627607`*^9, 
   3.472463011356473*^9}, 3.472463356208746*^9, 3.4724634570247583`*^9, 
   3.472463507206932*^9, 3.472463793569631*^9, 3.472463829840391*^9, 
   3.472465104284863*^9, 3.472465142165859*^9, 3.4724652260047913`*^9, 
   3.472465313850058*^9, 3.4724655095884047`*^9, 3.472465603480195*^9, 
   3.472465745879465*^9, 3.472465823714623*^9, {3.47246608317032*^9, 
   3.472466098024962*^9}, 3.472466130432324*^9, 3.47246617134026*^9, 
   3.4724662707584677`*^9, 3.472466322306493*^9, 3.472466370639168*^9, 
   3.4724664273191557`*^9, {3.4724664775719767`*^9, 3.472466483906304*^9}, {
   3.472466538573092*^9, 3.472466556649413*^9}, {3.472467351437305*^9, 
   3.472467412875902*^9}, {3.472467470692979*^9, 3.4724674790852137`*^9}, {
   3.472467511707183*^9, 3.472467556403837*^9}, {3.472467704741498*^9, 
   3.472467712083653*^9}, 3.472467893553629*^9, 3.472468135182638*^9, 
   3.4724685170188713`*^9, {3.4724685936479683`*^9, 3.472468601859074*^9}, 
   3.472468666394476*^9, {3.472470163001091*^9, 3.472470176091954*^9}, {
   3.472989801922962*^9, 3.472989848619678*^9}, 3.473054504828915*^9, 
   3.473054546284025*^9, {3.473054666718327*^9, 3.473054701138109*^9}, {
   3.4730611999250517`*^9, 3.4730612238232803`*^9}, {3.4730635558287067`*^9, 
   3.4730635807620583`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473055450809198*^9, 3.4730638382620087`*^9}],

Cell[BoxData[
 RowBox[{"-", "17.34505088253227`"}]], "Output",
 CellChangeTimes->{3.473055450809198*^9, 3.4730638383254023`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.473055450809198*^9, 3.473063838441975*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.473055450809198*^9, 3.473063838627831*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.473055450809198*^9, 3.47306383874022*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "8"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "7", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "8", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.473055473212654*^9, 3.473055496550336*^9}, 
   3.473063846384563*^9, 3.4736648695106773`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.4730554840777884`*^9, 3.473063847016498*^9}],

Cell[BoxData[
 RowBox[{"-", "17.34321507554147`"}]], "Output",
 CellChangeTimes->{3.4730554840777884`*^9, 3.4730638470814953`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.4730554840777884`*^9, 3.473063847181963*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"8", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.4730554840777884`*^9, 3.473063847354885*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "8", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.4730554840777884`*^9, 3.473063847461442*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "7"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
     RowBox[{"FindGroundMPSSite", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ".", "can"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], "]"}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"Dimensions", "[", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", 
      RowBox[{"MPSCanonizeSite", "[", 
       RowBox[{"new", ",", "can", ",", 
        RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", "energy", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "6", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "7", "]"}], "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.473055503501376*^9, 3.473055510467874*^9}, 
   3.47306385359439*^9, 3.47366486961021*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.473055512117502*^9, 3.473063854005856*^9}],

Cell[BoxData[
 RowBox[{"-", "17.31676698261285`"}]], "Output",
 CellChangeTimes->{3.473055512117502*^9, 3.47306385407091*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.473055512117502*^9, 3.473063854166402*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.473055512117502*^9, 3.4730638543260098`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.473055512117502*^9, 3.473063854426588*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"L", "[", "6", "]"}], "\[IndentingNewLine]", 
 RowBox[{"R", "[", "8", "]"}]}], "Input",
 CellChangeTimes->{{3.4729891742085037`*^9, 3.47298917547575*^9}, {
  3.47306387600093*^9, 3.47306388844285*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.9999999999999971`", "\[InvisibleSpace]", "-", 
      RowBox[{"3.5538114335001425`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"3.885780586188048`*^-16", "-", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.885780586188048`*^-16"}], "-", 
      RowBox[{"5.551115123125783`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.498001805406602`*^-16"}], "+", 
      RowBox[{"4.163336342344337`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.6653345369377348`*^-16"}], "-", 
      RowBox[{"6.028164079019405`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.1102230246251565`*^-16"}], "+", 
      RowBox[{"3.469446951953614`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.7470027081099033`*^-16"}], "+", 
      RowBox[{"2.3592239273284576`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.0061396160665481`*^-16", "-", 
      RowBox[{"1.8041124150158794`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.2898349882893854`*^-16", "+", 
      RowBox[{"1.3877787807814457`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.42861286636753`*^-17"}], "+", 
      RowBox[{"1.942890293094024`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2.220446049250313`*^-16", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999962`", "\[InvisibleSpace]", "+", 
      RowBox[{"8.719145400798954`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.1449174941446927`*^-16", "+", 
      RowBox[{"3.191891195797325`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "9.43689570931383`*^-16"}], "-", 
      RowBox[{"2.0816681711721685`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.0881733842070815`*^-16", "-", 
      RowBox[{"2.5673907444456745`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"8.326672684688674`*^-17", "-", 
      RowBox[{"2.8622937353617317`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.1163626406917047`*^-16", "+", 
      RowBox[{"2.723515857283587`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"3.191891195797325`*^-16", "-", 
      RowBox[{"1.3921155894713877`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "6.231994087446679`*^-16"}], "+", 
      RowBox[{"2.498001805406602`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.734723475976807`*^-17"}], "+", 
      RowBox[{"6.505213034913027`*^-17", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.5959455978986625`*^-16", "-", 
      RowBox[{"3.3306690738754696`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.999999999999996`", "\[InvisibleSpace]", "-", 
      RowBox[{"4.7379634937616544`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.3877787807814457`*^-16", "-", 
      RowBox[{"2.3592239273284576`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.0531133177191805`*^-16"}], "+", 
      RowBox[{"8.326672684688674`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.220446049250313`*^-16"}], "-", 
      RowBox[{"6.938893903907228`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.5265566588595902`*^-16", "+", 
      RowBox[{"2.7755575615628914`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.6653345369377348`*^-16", "-", 
      RowBox[{"1.8041124150158794`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"8.326672684688674`*^-17", "-", 
      RowBox[{"2.914335439641036`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "7.979727989493313`*^-17"}], "-", 
      RowBox[{"5.204170427930421`*^-17", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.6653345369377348`*^-16"}], "-", 
      RowBox[{"4.440892098500626`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "9.159339953157541`*^-16"}], "+", 
      RowBox[{"1.6653345369377348`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.942890293094024`*^-16", "+", 
      RowBox[{"3.885780586188048`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999961`", "\[InvisibleSpace]", "+", 
      RowBox[{"2.640371103181105`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "-", 
      RowBox[{"4.3021142204224816`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.498001805406602`*^-16"}], "-", 
      RowBox[{"1.0755285551056204`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "4.440892098500626`*^-16"}], "+", 
      RowBox[{"4.163336342344337`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"9.71445146547012`*^-17", "-", 
      RowBox[{"1.249000902703301`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.949029909160572`*^-16"}], "+", 
      RowBox[{"2.6194324487249787`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "+", 
      RowBox[{"1.9081958235744878`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.3530843112619095`*^-16"}], "+", 
      RowBox[{"1.0972125985553305`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.5504091066542713`*^-16", "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.191891195797325`*^-16"}], "-", 
      RowBox[{"9.71445146547012`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.8041124150158794`*^-16"}], "+", 
      RowBox[{"4.0245584642661925`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999987`", "\[InvisibleSpace]", "+", 
      RowBox[{"3.6453015797154476`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"7.4593109467002705`*^-16", "-", 
      RowBox[{"4.996003610813204`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"4.649058915617843`*^-16", "-", 
      RowBox[{"3.8163916471489756`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.5265566588595902`*^-16", "-", 
      RowBox[{"1.700029006457271`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"4.85722573273506`*^-17", "+", 
      RowBox[{"8.673617379884035`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.3704315460216776`*^-16"}], "-", 
      RowBox[{"8.348356728138384`*^-18", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.6653345369377348`*^-16"}], "-", 
      RowBox[{"3.8163916471489756`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.249000902703301`*^-16", "+", 
      RowBox[{"3.0184188481996443`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.0816681711721685`*^-16"}], "+", 
      RowBox[{"2.7755575615628914`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.6653345369377348`*^-16"}], "+", 
      RowBox[{"9.367506770274758`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"6.349087922075114`*^-16", "+", 
      RowBox[{"6.106226635438361`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999951`", "\[InvisibleSpace]", "-", 
      RowBox[{"8.439158660084045`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.6653345369377348`*^-16", "-", 
      RowBox[{"1.6653345369377348`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.444587907752746`*^-16"}], "+", 
      RowBox[{"5.551115123125783`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"3.122502256758253`*^-17", "+", 
      RowBox[{"9.75781955236954`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "7.32920668600201`*^-17"}], "+", 
      RowBox[{"1.3530843112619095`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "3.608224830031759`*^-16"}], "-", 
      RowBox[{"2.498001805406602`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.491862189340054`*^-16", "-", 
      RowBox[{"2.7755575615628914`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.0816681711721685`*^-16", "+", 
      RowBox[{"4.163336342344337`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.885780586188048`*^-16"}], "-", 
      RowBox[{"4.718447854656915`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"3.95516952522712`*^-16", "+", 
      RowBox[{"4.683753385137379`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"8.326672684688674`*^-17", "+", 
      RowBox[{"1.6653345369377348`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999956`", "\[InvisibleSpace]", "-", 
      RowBox[{"4.347650711666873`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "5.551115123125783`*^-17"}], "+", 
      RowBox[{"6.938893903907228`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.3877787807814457`*^-17", "-", 
      RowBox[{"1.8735013540549517`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "4.579669976578771`*^-16"}], "-", 
      RowBox[{"3.469446951953614`*^-18", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"6.938893903907228`*^-17", "+", 
      RowBox[{"2.1510571102112408`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"3.0531133177191805`*^-16", "+", 
      RowBox[{"1.1449174941446927`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.7755575615628914`*^-16", "+", 
      RowBox[{"2.498001805406602`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"5.551115123125783`*^-17", "+", 
      RowBox[{"9.71445146547012`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.0816681711721685`*^-16", "+", 
      RowBox[{"1.6306400674181987`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.9054006148485486`*^-16"}], "-", 
      RowBox[{"6.036837696399289`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.942890293094024`*^-16"}], "-", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999968`", "\[InvisibleSpace]", "+", 
      RowBox[{"1.2254872680875217`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.942890293094024`*^-16", "-", 
      RowBox[{"4.85722573273506`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.706168622523819`*^-16"}], "-", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"3.122502256758253`*^-16", "-", 
      RowBox[{"6.245004513516506`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "5.473052566706826`*^-16"}], "-", 
      RowBox[{"2.463307335887066`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"9.020562075079397`*^-17", "+", 
      RowBox[{"1.8041124150158794`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.642919299551295`*^-16"}], "-", 
      RowBox[{"2.90132501357121`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[InvisibleSpace]", "-", 
      RowBox[{"1.2793585635328952`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.903127820947816`*^-18"}], "-", 
      RowBox[{"1.4094628242311558`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"6.938893903907228`*^-18", "+", 
      RowBox[{"1.6653345369377348`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.0816681711721685`*^-16", "-", 
      RowBox[{"2.0816681711721685`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.999999999999996`", "\[InvisibleSpace]", "+", 
      RowBox[{"2.855517471783697`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.1102230246251565`*^-16"}], "-", 
      RowBox[{"7.077671781985373`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"3.469446951953614`*^-18", "-", 
      RowBox[{"1.700029006457271`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "6.245004513516506`*^-17"}], "-", 
      RowBox[{"4.2500725161431774`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.1102230246251565`*^-16"}], "+", 
      RowBox[{"4.0766001685454967`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.1684043449710089`*^-16"}], "-", 
      RowBox[{"2.255140518769849`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.491862189340054`*^-16"}], "-", 
      RowBox[{"1.2576745200831851`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.222980050563649`*^-16"}], "-", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "4.9439619065339`*^-16"}], "+", 
      RowBox[{"1.6479873021779667`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.5673907444456745`*^-16"}], "+", 
      RowBox[{"1.700029006457271`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.942890293094024`*^-16"}], "+", 
      RowBox[{"6.938893903907228`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999962`", "\[InvisibleSpace]", "+", 
      RowBox[{"8.738669510233166`*^-17", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.4729891760358047`*^9, 3.473054436794284*^9, {3.473063855967791*^9, 
   3.473063889184935*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.9999999999999993`", "\[InvisibleSpace]", "-", 
      RowBox[{"2.637022886871259`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.1102230246251565`*^-16"}], "-", 
      RowBox[{"1.3877787807814457`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.7755575615628914`*^-16", "+", 
      RowBox[{"1.3877787807814457`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.7755575615628914`*^-17", "+", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.3877787807814457`*^-17"}], "-", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.1102230246251565`*^-16", "+", 
      RowBox[{"9.367506770274758`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.3877787807814457`*^-17", "+", 
      RowBox[{"1.8041124150158794`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[InvisibleSpace]", "+", 
      RowBox[{"1.3877787807814457`*^-17", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.3877787807814457`*^-16"}], "-", 
      RowBox[{"1.3877787807814457`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.`", "\[InvisibleSpace]", "+", 
      RowBox[{"1.3674611445287004`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"3.3306690738754696`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-17"}], "-", 
      RowBox[{"2.7755575615628914`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"4.718447854656915`*^-16", "-", 
      RowBox[{"2.0816681711721685`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.3183898417423734`*^-16"}], "+", 
      RowBox[{"3.885780586188048`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "+", 
      RowBox[{"2.7755575615628914`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.8449465006019636`*^-16", "+", 
      RowBox[{"2.7755575615628914`*^-17", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"3.0531133177191805`*^-16", "+", 
      RowBox[{"8.326672684688674`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"3.885780586188048`*^-16", "+", 
      RowBox[{"2.7755575615628914`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999991`", "\[InvisibleSpace]", "-", 
      RowBox[{"4.414868191779478`*^-19", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.7755575615628914`*^-17", "+", 
      RowBox[{"1.8735013540549517`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"3.0531133177191805`*^-16", "-", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.6653345369377348`*^-16"}], "+", 
      RowBox[{"2.498001805406602`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "-", 
      RowBox[{"1.3877787807814457`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"6.938893903907228`*^-17", "+", 
      RowBox[{"1.942890293094024`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.`", "\[InvisibleSpace]", "-", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-17"}], "+", 
      RowBox[{"1.3877787807814457`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[InvisibleSpace]", "-", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999996`", "\[InvisibleSpace]", "-", 
      RowBox[{"8.576794929196424`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.1102230246251565`*^-16", "-", 
      RowBox[{"1.734723475976807`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.220446049250313`*^-16"}], "-", 
      RowBox[{"3.0531133177191805`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.5265566588595902`*^-16"}], "-", 
      RowBox[{"2.0816681711721685`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "4.579669976578771`*^-16"}], "-", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-17"}], "+", 
      RowBox[{"1.8041124150158794`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"4.163336342344337`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"3.608224830031759`*^-16", "+", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.6653345369377348`*^-16", "+", 
      RowBox[{"2.0122792321330962`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999993`", "\[InvisibleSpace]", "+", 
      RowBox[{"9.896348514806032`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.8041124150158794`*^-16"}], "+", 
      RowBox[{"8.326672684688674`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "5.551115123125783`*^-17"}], "+", 
      RowBox[{"2.393918396847994`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "8.326672684688674`*^-17"}], "+", 
      RowBox[{"2.498001805406602`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.942890293094024`*^-16", "-", 
      RowBox[{"1.6306400674181987`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "9.71445146547012`*^-17"}], "-", 
      RowBox[{"3.469446951953614`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.6653345369377348`*^-16"}], "-", 
      RowBox[{"2.7755575615628914`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "+", 
      RowBox[{"3.0531133177191805`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.1510571102112408`*^-16"}], "-", 
      RowBox[{"1.5265566588595902`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999999`", "\[InvisibleSpace]", "+", 
      RowBox[{"1.9937142820086617`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"4.163336342344337`*^-17", "+", 
      RowBox[{"5.551115123125783`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.636779683484747`*^-16", "+", 
      RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2.7755575615628914`*^-17", "-", 
      RowBox[{"1.9081958235744878`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.498001805406602`*^-16"}], "+", 
      RowBox[{"2.7755575615628914`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-16"}], "+", 
      RowBox[{"4.163336342344337`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.7694179454963432`*^-16"}], "+", 
      RowBox[{"1.942890293094024`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "8.326672684688674`*^-17"}], "-", 
      RowBox[{"2.0469737016526324`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"6.938893903907228`*^-17", "-", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.0000000000000007`", "\[InvisibleSpace]", "-", 
      RowBox[{"5.771274788939657`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[InvisibleSpace]", "-", 
      RowBox[{"8.326672684688674`*^-17", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "5.551115123125783`*^-17"}], "+", 
      RowBox[{"4.85722573273506`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.498001805406602`*^-16", "-", 
      RowBox[{"2.7755575615628914`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.3877787807814457`*^-16", "-", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "5.204170427930421`*^-16"}], "+", 
      RowBox[{"9.71445146547012`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "5.551115123125783`*^-17"}], "-", 
      RowBox[{"2.636779683484747`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.914335439641036`*^-16", "-", 
      RowBox[{"5.551115123125783`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"8.326672684688674`*^-17", "+", 
      RowBox[{"1.3877787807814457`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.0000000000000002`", "\[InvisibleSpace]", "+", 
      RowBox[{"5.988445759879212`*^-18", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.4729891760358047`*^9, 3.473054436794284*^9, {3.473063855967791*^9, 
   3.473063889320107*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"R", "[", "9", "]"}]], "Input",
 CellChangeTimes->{{3.4729891789530354`*^9, 3.472989181107009*^9}, {
  3.473063894705723*^9, 3.473063899689921*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.9999999999999996`", "\[InvisibleSpace]", "-", 
      RowBox[{"2.121593510459905`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-17"}], "-", 
      RowBox[{"1.5699247457590104`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.7755575615628914`*^-16", "-", 
      RowBox[{"6.938893903907228`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "8.326672684688674`*^-17"}], "+", 
      RowBox[{"2.220446049250313`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2.7755575615628914`*^-17"}], "+", 
      RowBox[{"1.5439038936193583`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.9999999999999992`", "\[InvisibleSpace]", "-", 
      RowBox[{"4.231276792859457`*^-19", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "4.85722573273506`*^-17"}], "-", 
      RowBox[{"5.551115123125783`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.3877787807814457`*^-17"}], "+", 
      RowBox[{"1.1102230246251565`*^-16", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"3.0531133177191805`*^-16", "+", 
      RowBox[{"6.938893903907228`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "6.938893903907228`*^-17"}], "+", 
      RowBox[{"5.551115123125783`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.0000000000000002`", "\[InvisibleSpace]", "+", 
      RowBox[{"2.692508267026066`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.5265566588595902`*^-16", "-", 
      RowBox[{"6.938893903907228`*^-17", " ", "\[ImaginaryI]"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "1.1102230246251565`*^-16"}], "-", 
      RowBox[{"2.7755575615628914`*^-16", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.`", "\[InvisibleSpace]", "-", 
      RowBox[{"2.7755575615628914`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.491862189340054`*^-16", "+", 
      RowBox[{"9.71445146547012`*^-17", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"1.`", "\[InvisibleSpace]", "-", 
      RowBox[{"2.3337330210075746`*^-17", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.4729891814754066`*^9, 3.473054438152637*^9, {3.473063893001464*^9, 
   3.473063900068367*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["new"], "Input",
 CellChangeTimes->{{3.472988672859764*^9, 3.472988672970002*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.2840207588166873`"}], "+", 
        RowBox[{"0.019503877274745007`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0881831610610464`"}], "-", 
        RowBox[{"0.14368952233848326`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.17488710653349349`"}], "-", 
        RowBox[{"0.09777123174526871`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.10796228891945456`"}], "+", 
        RowBox[{"0.004739399534359728`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.034281678658414194`"}], "+", 
        RowBox[{"0.36592550431734994`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.10254730364948339`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.025658839261781488`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.025072016687673476`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.1643626427360414`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.22748537325014906`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.07957760752091367`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.1496745702510387`"}], "-", 
        RowBox[{"0.09439614183631835`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0633699454936609`"}], "+", 
        RowBox[{"0.09951799864492623`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.051691910895049896`"}], "-", 
        RowBox[{"0.007899690548289609`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.008571624471530915`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.003148896634098227`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.12499243342726571`"}], "-", 
        RowBox[{"0.0576757910772665`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.02238038052330857`"}], "+", 
        RowBox[{"0.09896512242461078`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.02288616400465783`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.09812884497846967`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.005987809146677098`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.005620369153207832`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.0020910498453391747`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.025678311313558043`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0038136026486043986`"}], "-", 
        RowBox[{"0.03875940179708941`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0006006000750950098`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.02360344602301677`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.011712134869287776`"}], "+", 
        RowBox[{"0.004871400722817483`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0012544580130316296`"}], "+", 
        RowBox[{"0.012983437017020337`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0031029919786510485`"}], "-", 
        RowBox[{"0.008937409859669416`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.019475652140407026`"}], "+", 
        RowBox[{"0.009258800045065518`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.021856210864739427`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.02106398222331646`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.028827777615859834`"}], "-", 
        RowBox[{"0.01789673561006615`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.029364176468394607`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0024853944882146164`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0077324408160411515`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.01947527600737848`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0018538893576194072`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.010038512180899399`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.06361175680479628`"}], "+", 
        RowBox[{"0.020730453902215437`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.013575296604948125`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.020831338656140987`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0034360339725965226`"}], "-", 
        RowBox[{"0.0064898031685552875`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.005741685747055029`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.028468766754247803`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.007545091593326789`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.025291277206174426`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.010056412577972993`"}], "-", 
        RowBox[{"0.0004045999283702143`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.003627456077178722`"}], "+", 
        RowBox[{"0.013015405821359745`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0033116273592943162`"}], "+", 
        RowBox[{"0.006953032903461947`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.026038085070364536`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.012363207476793585`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0008057786011833679`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.01224864301569473`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.008277471931876033`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.006420754904194874`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0062022758234368`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.01827495406708475`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.014442633352942522`"}], "-", 
        RowBox[{"0.00032371083124723213`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0012567981846681568`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.000616604848942033`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.004578778468756008`"}], "-", 
        RowBox[{"0.0024077230488226613`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0005100031161374185`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0013508176327983769`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.013002266946742613`"}], "+", 
        RowBox[{"0.009644424205382356`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.004207736365829301`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.004566856934875753`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.004358677874908623`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0020981033271059574`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.008285433982720743`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0023814555275623863`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.00429124424351969`"}], "-", 
        RowBox[{"0.007967021829238535`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.005911424125774704`"}], "-", 
        RowBox[{"0.0020058378548463993`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0021302969823077285`"}], "-", 
        RowBox[{"0.003743879620992411`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.00036746082441109257`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0035165528340854006`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0017223782819431677`"}], "-", 
        RowBox[{"0.0015125322914986397`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0027592601584488325`"}], "+", 
        RowBox[{"0.0012028782876999482`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.00006548597386444753`"}], "+", 
        RowBox[{"0.002224445348720047`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.00799326129728207`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0010388396508626066`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.004162111011306118`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0061824567779323915`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.004126827194162223`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0023968213927071155`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.00021758206078087363`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0011100707070408155`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.00015847615518216644`"}], "-", 
        RowBox[{"0.005517898455985032`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.001597087800881391`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.004743572511416551`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.002114159434569483`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0017264066878224169`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0017693384501062336`"}], "-", 
        RowBox[{"0.002187290624909602`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.005187197077426877`"}], "+", 
        RowBox[{"0.0006854025086602614`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.0005189072452247358`"}], "-", 
        RowBox[{"0.0016070550653720392`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.002039859523956464`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0013526013410645652`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0017962525211499673`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0003983337497604415`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0007843786062054148`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.00021902887314753617`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.004022424099893348`"}], "-", 
        RowBox[{"0.0015754189000916248`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.000019997392221280524`"}], "+", 
        RowBox[{"0.0013318303614036475`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.00005319131947136566`"}], "-", 
        RowBox[{"0.0012060610449568891`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0005644261136225131`"}], "+", 
        RowBox[{"0.0007736890224543382`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.002444534718722013`"}], "+", 
        RowBox[{"0.002299987775274495`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.002027767336394154`"}], "-", 
        RowBox[{"0.00010355171413895014`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0024134579171890148`"}], "+", 
        RowBox[{"0.0005893401052815754`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0010515094999344404`"}], "+", 
        RowBox[{"0.0004587369805585048`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0024347003398639917`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0036153488018995732`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.001015703914585238`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0002234131387892494`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0011791798451173804`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0017145212769006947`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.001893293520757517`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.00122807181718178`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.14488884810309238`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.10925423580553256`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0652838001645184`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.00009765770989278444`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.01152388678722928`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.01609891522944149`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.07389803617122995`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.04260206624496614`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.18592150107415734`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.027736806200626407`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.03137218193657337`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0632008826489527`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.04260255741396561`"}], "-", 
        RowBox[{"0.04577422233124105`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.12287692472569586`"}], "-", 
        RowBox[{"0.05417853098042155`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.06516051865594594`"}], "-", 
        RowBox[{"0.39247114609059025`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.013936250386698556`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.04028196671838272`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.03996848346639709`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.1623147401542378`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.052387979096452465`"}], "-", 
        RowBox[{"0.008169202866152005`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.2496214043649472`"}], "-", 
        RowBox[{"0.14634973478958396`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0642497397333123`"}], "+", 
        RowBox[{"0.11922935758494763`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.10383924846966339`"}], "+", 
        RowBox[{"0.11553633346356468`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.026892442790539886`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.2556999561917399`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",",
      
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.018806937871387947`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.016721008366756832`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.000135943654037427`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.009659827102400799`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.003452543417850457`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.007450475175008755`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.004061247629078213`"}], "-", 
        RowBox[{"0.011655362571830682`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.009156212468417538`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.005529320981517555`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0035385056313288975`"}], "-", 
        RowBox[{"0.007992938672151678`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.006891021730377467`"}], "-", 
        RowBox[{"0.005879433878876285`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.013684900665407125`"}], "-", 
        RowBox[{"0.005572352121970572`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.01405504527130566`"}], "+", 
        RowBox[{"0.0474561597887198`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.007822481012377258`"}], "+", 
        RowBox[{"0.018641922639419536`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.005740176219816057`"}], "+", 
        RowBox[{"0.02113687180126015`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.010707648821395648`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.012997589148230359`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.010165728721017571`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.025956058696802908`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.008752536539516445`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.007857343701457714`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.026119867064548035`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.018145206733885873`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.01214573178685463`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.04199493034911939`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.0034974216314315795`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.002439401678758631`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.004105122236382401`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.000042322951167401805`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0007991726862406886`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0020434690992768073`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0008575176025257631`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.006260474054390957`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0018256587042986662`"}], "-", 
        RowBox[{"0.002755101644176374`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0007626495933110836`"}], "-", 
        RowBox[{"0.0008374816450663467`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.00120770244646569`"}], "-", 
        RowBox[{"0.0027404530862919765`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.005406661564253079`"}], "+", 
        RowBox[{"0.00004569577441629596`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.0025489352079122512`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.01287189871569173`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.00922831026203132`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0069137609457166505`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.00027683952752915965`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.00007291122442518682`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0013585989735393062`"}], "-", 
        RowBox[{"0.002649493890345643`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.004894234608443514`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.015635514195151398`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.008188388236424583`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.005195439961003891`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.002981550119040001`"}], "-", 
        RowBox[{"0.00575819454553305`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0006519915576116101`"}], "-", 
        RowBox[{"0.0026073918197442097`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.02275773451438945`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.003539132534118805`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0015591281192146047`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.00010054691128975153`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0062101787811279004`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0027208580216617076`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.003873364963609351`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.004645440190909559`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0157483973859001`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.009811735730498143`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0055925933656082085`"}], "-", 
        RowBox[{"0.005557388548900463`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.008611319920829436`"}], "-", 
        RowBox[{"0.005839511290163568`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.01759250301035129`"}], "-", 
        RowBox[{"0.005170811905648236`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.0025309332098832904`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.018620132222518678`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0013920080348164172`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0026309346447576385`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0017189541936888405`"}], "+", 
        RowBox[{"0.006848436653947345`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.005462397506893609`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.001999179131845663`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.008863031576944158`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0064638243719967545`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0027454874759519432`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.005274404564785453`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.003028184252132074`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.007111613693432021`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.00365040754981915`"}], "-", 
        RowBox[{"0.014317469405778334`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.00429261183806471`"}], "-", 
        RowBox[{"0.0015032559750270897`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0006956823141159901`"}], "+", 
        RowBox[{"0.0005862042487969731`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0002770788113950915`"}], "-", 
        RowBox[{"0.0008861616927629905`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0011520003241419095`"}], "+", 
        RowBox[{"0.0012143016146205822`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0042268713492459925`"}], "+", 
        RowBox[{"0.0028814556129010942`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.00024942863023385534`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0021191486335191624`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0007845462577758683`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0008050806105881039`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.002617618030153867`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0007801685218430721`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.0020249862792981184`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0016904089321307962`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.001029908816079116`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.000928543606464514`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.00019140581967514543`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0007023151526951409`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.00026731973697317077`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0014419372474802799`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0007666132651064034`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0025533165792272095`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0003063509627129677`"}], "-", 
        RowBox[{"0.000429367637305883`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.001419829937006688`"}], "+", 
        RowBox[{"0.0005544539607356966`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0017439052139832383`"}], "+", 
        RowBox[{"0.0017786005889865375`", " ", "\[ImaginaryI]"}]}]}], "}"}]}],
     "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.472988673377509*^9, 3.473054439143087*^9, 
  3.473063905298542*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "9", "]"}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "10", "]"}], "]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "4", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{3.4729884732812443`*^9, 3.473054442104499*^9, 
  3.473063906711733*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.4729884732812443`*^9, 3.473054442104499*^9, 
  3.4730639067628107`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.4729884732812443`*^9, 3.473054442104499*^9, 
  3.473063906900021*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"defineRight", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.472988538700642*^9, 3.472988542066331*^9}}],

Cell[CellGroupData[{

Cell[BoxData["can"], "Input",
 CellChangeTimes->{{3.4729885488456383`*^9, 3.472988548980721*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "0.`", "}"}], "}"}]], "Output",
 CellChangeTimes->{3.4729885495869093`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"can", "=", 
  RowBox[{"{", 
   RowBox[{"{", "1.", "}"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.472469398828723*^9, 3.472469400562974*^9}, {
   3.472974572950589*^9, 3.472974659167535*^9}, {3.472975193495417*^9, 
   3.472975209614997*^9}, 3.472977247114167*^9, {3.472988558264702*^9, 
   3.4729885592218857`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", "1.`", "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.472469401103157*^9, {3.472974577756291*^9, 3.4729746600551233`*^9}, 
   3.472975209897416*^9, 3.4729753106864567`*^9, 3.472976084176963*^9, 
   3.472976131131179*^9, {3.472988554964061*^9, 3.472988559923945*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["energy"], "Input",
 CellChangeTimes->{{3.4729885630212193`*^9, 3.472988563505349*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{3.47298856384408*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["new"], "Input",
 CellChangeTimes->{{3.472988567326501*^9, 3.472988567470583*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.`", "}"}], ",", 
     RowBox[{"{", "0.`", "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "0.`", "}"}], ",", 
     RowBox[{"{", "0.`", "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.472988567929778*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["energy"], "Input",
 CellChangeTimes->{{3.4729752418990707`*^9, 3.4729752423966093`*^9}}],

Cell[BoxData[
 RowBox[{"-", "3.03007765490184`"}]], "Output",
 CellChangeTimes->{3.4729752428977947`*^9, 3.472975314191059*^9, 
  3.4729761332415648`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"L", "[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.47297534578986*^9, 3.472975348556921*^9}, {
  3.472976320784985*^9, 3.4729763248137417`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.0000000000000002`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1.0000000000000002`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.472975349586694*^9, 3.472976133985022*^9, 
  3.472976325450469*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"R", "[", "3", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.47297535719818*^9, 3.47297537009334*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1.0000000000000009`", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1.0000000000000009`", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1.0000000000000009`", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "1.0000000000000004`", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "1.0000000000000009`", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1.0000000000000009`", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "1.0000000000000009`", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     "1.000000000000001`", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "1.0000000000000009`", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "1.000000000000001`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.472975362000819*^9, 3.472975371061537*^9}, 
   3.472976135088859*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"can", "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "can", "]"}]}], "Input",
 CellChangeTimes->{{3.472976136852737*^9, 3.4729761475816727`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.11023323948163803`"}], "-", 
      RowBox[{"0.1394392926208362`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.004495173859552038`"}], "-", 
      RowBox[{"0.032277750565782956`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.2453505692896612`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.33183416898137696`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.061879174328403216`"}], "-", 
      RowBox[{"0.1086151471352642`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.06408402403555165`"}], "+", 
      RowBox[{"0.09796508639266735`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.37700033604540856`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.3104580467141285`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.10477773647043653`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.04309768023134471`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.12675096921422177`"}], "+", 
      RowBox[{"0.3565492034803754`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.03969858180661341`"}], "+", 
      RowBox[{"0.03379554133364985`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.17169505034754842`"}], "-", 
      RowBox[{"0.12934241773843413`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.0010981174917766257`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.3021711760117892`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.23712343785722848`"}], "-", 
      RowBox[{"0.15789580936047393`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.0908929979605236`"}], "-", 
      RowBox[{"0.12034037862751953`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.12060216443139861`"}], "+", 
      RowBox[{"0.1921540407671654`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.08953637684661793`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.02137865926593696`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.06594328851639177`"}], "+", 
      RowBox[{"0.0844759003781692`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.08694309450823881`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.12023248222122218`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.0672437782397706`"}], "+", 
      RowBox[{"0.14032977364183433`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.08556472837250131`"}], "+", 
      RowBox[{"0.04440351424271363`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.044987399735646104`"}], "-", 
      RowBox[{"0.007068504199201712`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.472976137600383*^9, 3.47297614814782*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{{3.472976137600383*^9, 3.472976148277832*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "2"}], "}"}], ",", 
   RowBox[{"Dimensions", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}], ",", 
      RowBox[{"L", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"R", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.47246941326081*^9, 3.472469413357293*^9}, {
  3.472974699882155*^9, 3.4729747027452717`*^9}, {3.472974802893608*^9, 
  3.4729748094871063`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "10", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "3"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.472469416173629*^9, 3.4729747053551607`*^9, 
  3.472974810481811*^9, 3.4729752172008953`*^9, 3.472975323599709*^9, 
  3.472976155114881*^9, 3.472976343819071*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "2"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
    RowBox[{"FindGroundMPSSite", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}], ",", 
      RowBox[{"L", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"R", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.472469422085642*^9, 3.4724694236134577`*^9}, {
   3.472974881514154*^9, 3.4729748946058483`*^9}, {3.47297523529027*^9, 
   3.472975256279046*^9}, 3.472975462427086*^9, 3.4736648697098913`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "5.529909548923607`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.17708572754209417`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.010890997996381305`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.09001395881373346`"}], "-", 
          RowBox[{"0.03550331576867329`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.028341414208206107`"}], "+", 
          RowBox[{"0.028004534658807454`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.027523822896815993`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.05017039069632206`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.03092918258834179`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.23401299700768202`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.16176390598314613`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.044847341471178935`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.13542297312632864`"}], "+", 
          RowBox[{"0.049896845249432414`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.1879213883273064`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.04812753501163925`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.11931639092901647`"}], "-", 
          RowBox[{"0.20226639303064786`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.05663408512556237`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.14677436637965327`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.04203826477265824`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.09314782706394192`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.06254595424037339`"}], "+", 
          RowBox[{"0.001808410109781697`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.0019268965925955748`"}], "+", 
          RowBox[{"0.10892254615120937`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.09604471304550703`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.10202530264369757`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.022000032378154014`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.02148477335214492`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.05072515185847508`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.06513497460410413`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.04280610196749348`"}], "-", 
          RowBox[{"0.07209778329970525`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.021430121942466854`"}], "-", 
          RowBox[{"0.03525880419449567`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.09036798967599938`"}], "-", 
          RowBox[{"0.13578919047748705`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.06784697619601816`"}], "-", 
          RowBox[{"0.035975787124316434`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.16620196814546243`"}], "-", 
          RowBox[{"0.051534959059157816`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.05266973982359588`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.06683214641473462`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.12223109756434579`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.03793419848590219`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.1653845414739142`"}], "-", 
          RowBox[{"0.048869174802354524`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.13821121914208417`"}], "+", 
          RowBox[{"0.036035680413258685`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.02969417611774935`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.1757131110100669`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.005176335836423732`"}], "+", 
          RowBox[{"0.19872036519249153`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.07238342969902174`"}], "-", 
          RowBox[{"0.022744539464799235`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.08639818757899463`"}], "+", 
          RowBox[{"0.3032150989329501`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.09139555885192681`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.015783587967742357`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.20288204746508615`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.0698404330182906`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.06959365331098617`"}], "-", 
          RowBox[{"0.11420870329855029`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.12583213309649646`"}], "+", 
          RowBox[{"0.04801224868551314`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.16847532141390084`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.03207086360647483`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.16596334388852`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.04650898776003911`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.025735785522756648`"}], "+", 
          RowBox[{"0.20601757089001607`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.007023273407805687`"}], "-", 
          RowBox[{"0.20435271107343392`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.07029243328752643`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.06215550061375902`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.11101417749599087`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.3056908942312864`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.08621297131404425`"}], "-", 
          RowBox[{"0.0007303929318868441`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.472974895855253*^9, 3.472975262024675*^9, 
  3.472975469670848*^9, 3.4729761592746897`*^9, 3.4729766665651283`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "can", "]"}]], "Input",
 CellChangeTimes->{{3.472975477652053*^9, 3.472975480477126*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472975480790874*^9, 3.472976076506823*^9, 
  3.472976162175064*^9, 3.4729766692901907`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "new", "]"}]], "Input",
 CellChangeTimes->{{3.47297548374629*^9, 3.472975487564994*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.4729754895674143`*^9, 3.472976169770421*^9, 
  3.472976671306177*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSCanonizationCheck", "[", 
  RowBox[{"mps", ",", 
   RowBox[{"Site", "\[Rule]", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.472975514619714*^9, 3.472975548987444*^9}, {
  3.472976697687748*^9, 3.472976710222678*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.4729755382524757`*^9, 3.472975549422564*^9}, {
  3.4729766744902973`*^9, 3.4729767108580723`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"L", "[", "2", "]"}]], "Input",
 CellChangeTimes->{{3.472976712071733*^9, 3.472976713180106*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.11823945961676235`", "\[InvisibleSpace]", "-", 
      RowBox[{"2.168404344971009`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.05264498821840114`"}], "-", 
      RowBox[{"0.039721215719285365`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.05608675534589656`"}], "+", 
      RowBox[{"0.0401828727503223`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.08538763852462722`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.009588028070452049`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.062488509515593746`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.07409614053597971`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03751002765838229`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.09149551148045891`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.04468635116086049`"}], "-", 
      RowBox[{"0.07392049930575227`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.06694188199178527`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.014841854161679983`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.010170222143973347`"}], "-", 
      RowBox[{"0.17586383577301665`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.022989324211926246`"}], "+", 
      RowBox[{"0.0319825864955951`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.052644988218401134`"}], "+", 
      RowBox[{"0.039721215719285365`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03840580672864652`", "\[InvisibleSpace]", "-", 
      RowBox[{"2.1955093992831465`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.009050722655074155`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.038215616692845414`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.03425240232535986`"}], "+", 
      RowBox[{"0.03718930073928445`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.0070001584571487505`"}], "+", 
      RowBox[{"0.0567926563966202`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.051125353301078785`"}], "-", 
      RowBox[{"0.03097544819635191`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.04980132628961245`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.019519486837838045`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.03467071929538647`"}], "+", 
      RowBox[{"0.01192570273003215`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.06622848220735505`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.07832452621486596`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.00371188211903321`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.025563128661219146`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.05608675534589656`"}], "-", 
      RowBox[{"0.040182872750322306`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.009050722655074155`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.038215616692845414`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.047973670081324755`", "\[InvisibleSpace]", "-", 
      RowBox[{"2.710505431213761`*^-20", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.05150412231285009`"}], "-", 
      RowBox[{"0.03398522161267355`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.051189786193174915`"}], "+", 
      RowBox[{"0.00045700205408783423`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.027093079624449665`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.056490960157669884`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.019633861386448764`"}], "+", 
      RowBox[{"0.057324573658381096`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.021622885432577708`"}], "-", 
      RowBox[{"0.020946444346453805`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.06760798058722307`"}], "+", 
      RowBox[{"0.08609924422089077`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.021300829043047885`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.007482540213758391`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.08538763852462722`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.009588028070452045`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.03425240232535986`"}], "-", 
      RowBox[{"0.03718930073928444`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.051504122312850086`"}], "+", 
      RowBox[{"0.03398522161267354`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.08206109523539101`", "\[InvisibleSpace]", "-", 
      RowBox[{"1.3010426069826053`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.06446289957277665`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.0305803591774991`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.0063761333279428005`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.0868268550814468`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.019578434271904657`"}], "-", 
      RowBox[{"0.08403417393179903`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03121530611200712`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.013621512469316515`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.020408737592709225`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.14324594009940117`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.03754310762545425`"}], "+", 
      RowBox[{"0.006222411673419984`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.06248850951559376`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.07409614053597971`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.007000158457148748`"}], "-", 
      RowBox[{"0.05679265639662019`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.051189786193174915`"}], "-", 
      RowBox[{"0.0004570020540878364`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.06446289957277665`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.030580359177499104`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.1067721228314436`", "\[InvisibleSpace]", "+", 
      RowBox[{"2.2768245622195593`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.030063966085798394`"}], "+", 
      RowBox[{"0.09797463108298164`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.0009573198001563438`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.09417385589062019`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.012795615235629491`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.0635651777659046`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.10008132708147788`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.12347105978902906`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.06079005455616704`"}], "+", 
      RowBox[{"0.010300649086849974`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.03751002765838228`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.09149551148045891`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.051125353301078785`"}], "+", 
      RowBox[{"0.03097544819635191`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.02709307962444966`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.05649096015766989`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.006376133327942797`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.08682685508144682`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.030063966085798394`"}], "-", 
      RowBox[{"0.09797463108298164`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.10985686291174347`", "\[InvisibleSpace]", "+", 
      RowBox[{"4.336808689942018`*^-19", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.10352722184158655`"}], "+", 
      RowBox[{"0.02497325497975066`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.042016904030077684`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.03051032934113635`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.16347987478530945`"}], "-", 
      RowBox[{"0.04955143712153901`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.017514544725588388`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.05716814195828795`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.04468635116086049`"}], "+", 
      RowBox[{"0.07392049930575227`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.04980132628961245`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.019519486837838045`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.019633861386448757`"}], "-", 
      RowBox[{"0.057324573658381096`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.019578434271904657`"}], "+", 
      RowBox[{"0.08403417393179904`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.0009573198001563404`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.0941738558906202`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.10352722184158655`"}], "-", 
      RowBox[{"0.024973254979750663`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.10918546442595467`", "\[InvisibleSpace]", "+", 
      RowBox[{"2.168404344971009`*^-19", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.036928489628824265`"}], "+", 
      RowBox[{"0.012499678560797759`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.14211544779258534`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.07307483707069916`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.002297201316238977`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.061747298979002864`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.06694188199178529`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.014841854161679983`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.03467071929538647`"}], "-", 
      RowBox[{"0.011925702730032151`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.021622885432577708`"}], "+", 
      RowBox[{"0.020946444346453805`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.03121530611200712`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.013621512469316515`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.012795615235629497`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.0635651777659046`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.04201690403007769`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.03051032934113635`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.036928489628824265`"}], "-", 
      RowBox[{"0.012499678560797756`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.053894148621341044`", "\[InvisibleSpace]", "-", 
      RowBox[{"1.0842021724855044`*^-19", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.03727192777428101`"}], "-", 
      RowBox[{"0.08484480030262986`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.008067025524987047`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.031763635462620995`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.010170222143973338`"}], "+", 
      RowBox[{"0.17586383577301662`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.06622848220735504`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.07832452621486598`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.06760798058722307`"}], "-", 
      RowBox[{"0.08609924422089077`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.02040873759270923`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.14324594009940117`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.10008132708147788`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.12347105978902906`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.16347987478530948`"}], "+", 
      RowBox[{"0.04955143712153901`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.14211544779258534`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.07307483707069914`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.037271927774281`"}], "+", 
      RowBox[{"0.08484480030262986`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.28692828616145605`", "\[InvisibleSpace]", "-", 
      RowBox[{"8.673617379884035`*^-18", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.0474583989190463`"}], "-", 
      RowBox[{"0.06480368626226313`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.022989324211926246`"}], "-", 
      RowBox[{"0.03198258649559509`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.003711882119033211`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.02556312866121914`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.02130082904304788`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.0074825402137583905`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.03754310762545425`"}], "-", 
      RowBox[{"0.006222411673419981`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.06079005455616704`"}], "-", 
      RowBox[{"0.010300649086849974`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.01751454472558839`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.05716814195828795`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.002297201316238976`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.061747298979002864`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.008067025524987045`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.031763635462620995`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.047458398919046296`"}], "+", 
      RowBox[{"0.06480368626226313`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.046683083385937976`", "\[InvisibleSpace]", "+", 
      RowBox[{"8.131516293641283`*^-20", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.4729767136317453`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{
   RowBox[{"mps", "[", 
    RowBox[{"[", "2", "]"}], "]"}], "=", "new"}], "]"}]], "Input",
 CellChangeTimes->{{3.472975475967598*^9, 3.472975495989183*^9}, {
  3.4729760439038477`*^9, 3.472976050337475*^9}, {3.4729766806931953`*^9, 
  3.472976690287738*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.472976052820135*^9, 3.472976693210266*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"bakup", "=", "can"}]], "Input",
 CellChangeTimes->{{3.4729768467060432`*^9, 3.472976856685397*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "0.11023323948163803`"}], "-", 
      RowBox[{"0.1394392926208362`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.004495173859552038`"}], "-", 
      RowBox[{"0.032277750565782956`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.2453505692896612`", "\[InvisibleSpace]", "+", 
      RowBox[{"0.33183416898137696`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.061879174328403216`"}], "-", 
      RowBox[{"0.1086151471352642`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.06408402403555165`"}], "+", 
      RowBox[{"0.09796508639266735`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.37700033604540856`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.3104580467141285`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.10477773647043653`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.04309768023134471`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.12675096921422177`"}], "+", 
      RowBox[{"0.3565492034803754`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.03969858180661341`"}], "+", 
      RowBox[{"0.03379554133364985`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.17169505034754842`"}], "-", 
      RowBox[{"0.12934241773843413`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0.0010981174917766257`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.3021711760117892`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.23712343785722848`"}], "-", 
      RowBox[{"0.15789580936047393`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.0908929979605236`"}], "-", 
      RowBox[{"0.12034037862751953`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.12060216443139861`"}], "+", 
      RowBox[{"0.1921540407671654`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.08953637684661793`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.02137865926593696`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.06594328851639177`"}], "+", 
      RowBox[{"0.0844759003781692`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.08694309450823881`", "\[InvisibleSpace]", "-", 
      RowBox[{"0.12023248222122218`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.0672437782397706`"}], "+", 
      RowBox[{"0.14032977364183433`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.08556472837250131`"}], "+", 
      RowBox[{"0.04440351424271363`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.044987399735646104`"}], "-", 
      RowBox[{"0.007068504199201712`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.472976847342119*^9, 3.472976857116333*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mps", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "=", 
  RowBox[{"MPSCanonizeSite", "[", 
   RowBox[{"new", ",", "can", ",", 
    RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
    RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.472976871954668*^9, 3.472976874608659*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.4739846797180255`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.7987352053385014`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.2831086341913423`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.2391863214980658`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.26403831428285174`"}], "-", 
        RowBox[{"0.023357410456946656`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.5222735875201674`"}], "-", 
        RowBox[{"0.052213806217456235`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.7071550904879735`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.06586228518656294`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.38382827637319095`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0501189567913259`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.29164825999572863`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.48080033078867707`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.13151005715417494`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.2059801349405769`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.3868050559438188`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.5087943080688944`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.3190515076670079`"}], "-", 
        RowBox[{"0.33729209812940075`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.3144307645855127`"}], "-", 
        RowBox[{"0.5385000947048659`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.08036994734459685`"}], "-", 
        RowBox[{"0.14263257136066948`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.081559783152848`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.017364941068625295`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.45124377091289725`"}], "-", 
        RowBox[{"0.611369841619574`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.472976859345106*^9, 3.472976875633133*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"mps", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.472976886475731*^9, 3.472976890558715*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "2", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.472976890943383*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"defineLeft", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.472976898687497*^9, 3.472976905372951*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"Chop", "[", 
   RowBox[{"L", "[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.472976906860794*^9, 3.4729769170083723`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1.0000000000000009`", ",", "0", ",", "0", ",", "0"}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{"0", ",", "1.0000000000000007`", ",", "0", ",", "0"}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0.9999999999999999`", ",", "0"}], "}"}], ",",
    
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.472976909674533*^9, 3.472976917394771*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSCanonizationCheck", "[", 
  RowBox[{"mps", ",", 
   RowBox[{"Site", "\[Rule]", "3"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.4729769192569447`*^9, 3.4729769380620613`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.472976939004017*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "can", "]"}]], "Input",
 CellChangeTimes->{{3.472976960530046*^9, 3.472976963164914*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "10"}], "}"}]], "Output",
 CellChangeTimes->{3.4729769636267033`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "3"}], "}"}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
    RowBox[{"FindGroundMPSSite", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"can", ".", "#"}], "&"}], "/@", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "site", "]"}], "]"}]}], ",", 
      RowBox[{"L", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"R", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.472976966376368*^9, 3.472976968461279*^9}, {
   3.472977001703553*^9, 3.472977004075428*^9}, 3.4736648698094187`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "7.9292132249729725`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.3145736811283248`"}], "-", 
          RowBox[{"0.19677546709154728`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.015716228180908943`"}], "-", 
          RowBox[{"0.061236876633218376`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.03946582613155758`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.18164555195740184`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.5291268346290056`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.08869199154937213`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.1946857061081837`"}], "+", 
          RowBox[{"0.018551368048655568`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.008804314766875246`"}], "+", 
          RowBox[{"0.16885244800379254`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.15315723368922843`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.002612287996998738`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.2864776198081784`"}], "+", 
          RowBox[{"0.023514378236497588`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.25800663768556975`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.007358794916021075`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.2666608438106511`"}], "-", 
          RowBox[{"0.05428233931206503`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.05165569505643558`"}], "-", 
          RowBox[{"0.019950935102849104`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.0008915399443212297`"}], "+", 
          RowBox[{"0.0005883224376593611`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.008192973191978486`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.031760140657698194`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.04448776115316043`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.015372832467565265`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.031146926046511154`"}], "+", 
          RowBox[{"0.003655410657925346`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.002614274798236497`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.025493030392645687`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.031163360455440034`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.008930916829077479`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.029782473108022935`"}], "-", 
          RowBox[{"0.004746868191441008`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.025083120782802313`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.007241906453316514`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.03926637275095487`"}], "-", 
          RowBox[{"0.010764070885876722`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.02138779582915741`"}], "-", 
          RowBox[{"0.010957674465941716`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.0031367348836608636`"}], "+", 
          RowBox[{"0.004991277776397819`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.00391325668873641`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.008532521661370916`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0324607617368152`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.014353379272601106`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.014967959244587301`"}], "-", 
          RowBox[{"0.0029944158947540086`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.00031015705256356963`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.006635756121897777`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.00027277232739417645`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.0002243331737837845`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.009646772964165088`"}], "-", 
          RowBox[{"0.002179004931274176`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.010731328050406328`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.0049126551039825675`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.01913476290654977`"}], "-", 
          RowBox[{"0.00016278770735152833`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.003969394106381376`"}], "-", 
          RowBox[{"0.005487629121263841`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.004957371466037923`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.012355825147607115`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.004367845695696629`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.0006937980378493878`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.002789508692458669`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.008496653995242923`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0004892255077787871`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.006773789853322344`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.005308234133187291`"}], "+", 
          RowBox[{"0.006888963400982629`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.011116547953080735`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.008072888843857375`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.01668714770105967`"}], "+", 
          RowBox[{"0.0021874634080655694`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.005219347773562622`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.0042122007586506876`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.0035736312625550644`"}], "+", 
          RowBox[{"0.000586141718635008`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.03448397074531325`"}], "-", 
          RowBox[{"0.07868443080306443`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.09099634052296302`"}], "+", 
          RowBox[{"0.034686094002470955`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.057741886157998544`"}], "+", 
          RowBox[{"0.011118358578740451`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.016012970554394497`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.19731968708168376`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.0030873880660573718`"}], "-", 
          RowBox[{"0.09474763767601752`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.007254291137853968`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.021713222546445643`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.017895682019558667`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.06477912044488489`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.030172015665026655`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.0206897272300501`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.006150839069438146`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.07214641788575339`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.02174380993077507`"}], "-", 
          RowBox[{"0.06594371076226282`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "0.0050194600579908984`"}], "+", 
          RowBox[{"0.1646463950515417`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.008820096422681462`"}], "+", 
          RowBox[{"0.017060905783625617`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.014062830572704521`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.05780927910598412`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.07945573170507089`"}], "-", 
          RowBox[{"0.19268106750574845`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.050155141944195944`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.059183742714252495`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0636342239719119`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.020702842163658895`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.002852885188055442`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.04084432767402956`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.056607494956620374`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.09850967344360381`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.026054652478468696`"}], "-", 
          RowBox[{"0.06589806624373497`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.06930943681273222`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.09333830237547154`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.003277117096538058`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.01667478992639258`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.01909024666004154`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.007867651495225262`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0018301478248791306`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.00871436041272655`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.013874567177153196`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.0032828135428319164`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.009927636291596658`"}], "+", 
          RowBox[{"0.004478826942451663`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.013679253713350024`"}], "+", 
          RowBox[{"0.002804908912550856`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0024619712752182695`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.021083220408440174`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.01996686319580707`"}], "-", 
          RowBox[{"0.018929307824980108`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.011426084331574998`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.003701079409804629`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.004328014056457999`"}], "-", 
          RowBox[{"0.007836669575532878`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"0.00006556575090740398`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.0047650292379975995`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.007835130452067933`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.0033885902962170504`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0018296174568303565`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.002673779838271771`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.006653023002463668`", "\[InvisibleSpace]", "-", 
          RowBox[{"0.002658286595746632`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.003550994479245399`"}], "+", 
          RowBox[{"0.0034363298909506506`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.0047708017679621425`"}], "+", 
          RowBox[{"0.0015353337683101313`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.0023763648790089804`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.008623244084403982`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.008978687266251154`"}], "-", 
          RowBox[{"0.005996623854972423`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{"0.004970588783468383`", "\[InvisibleSpace]", "+", 
          RowBox[{"0.00017074419338782823`", " ", "\[ImaginaryI]"}]}], ",", 
         RowBox[{
          RowBox[{"-", "0.002286803965682041`"}], "-", 
          RowBox[{"0.0006128146666819821`", " ", "\[ImaginaryI]"}]}]}], 
        "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.472977009321124*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mps", "[", 
   RowBox[{"[", "3", "]"}], "]"}], "=", 
  RowBox[{"MPSCanonizeSite", "[", 
   RowBox[{"new", ",", "can", ",", 
    RowBox[{"Direction", "\[Rule]", "\"\<Left\>\""}], ",", 
    RowBox[{"UseMatrix", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.4729770277767677`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.9052373492535672`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.1900712083043063`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.3542178156607075`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.10774839160943893`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.08222212172314844`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.021747443710540364`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.009587956463113539`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0035976306805010037`"}], "+", 
        RowBox[{"0.`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.10762411873766264`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.005855553609457733`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.03441434468371862`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.012125247673595033`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.000391724492520229`"}], "+", 
        RowBox[{"0.05393531858963078`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.9692544555429647`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.1907921093430074`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.028646558639923436`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.011343245814838795`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.08083776724364324`"}], "-", 
        RowBox[{"0.02322448196058462`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.001956420353770645`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.00637629841673301`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.008118797451770743`"}], "+", 
        RowBox[{"0.012352199515212705`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.051594622392741006`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.006261303396140146`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.05802942907592381`"}], "-", 
        RowBox[{"0.022951036417131813`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.13199962644850682`"}], "-", 
        RowBox[{"0.013157349189347686`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.07754280028879859`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.038783475252944934`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.026081340611005525`"}], "+", 
        RowBox[{"0.05487625649077932`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.9147411271354231`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.2508220025094118`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.1434089467610484`"}], "+", 
        RowBox[{"0.056443714002021445`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0867957641703597`"}], "-", 
        RowBox[{"0.18344044060451078`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.015271101633340887`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.006560936333860715`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.10625937068409057`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.058199159977547196`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.010606768896255885`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.018064092024423318`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0007091507159269483`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0006214999660896676`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.517956045115265`"}], "-", 
        RowBox[{"0.17610984915648475`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0721656016276669`"}], "-", 
        RowBox[{"0.06691472048139296`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.5793705090918213`"}], "-", 
        RowBox[{"0.5126122265020497`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.2502669139194964`"}], "+", 
        RowBox[{"0.12063266589435707`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.07184086328473276`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.19799917745896708`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.1900587191525194`"}], "-", 
        RowBox[{"0.9290128202096771`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.05938619770818028`"}], "+", 
        RowBox[{"0.04093133238478208`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.022516467366783796`"}], "+", 
        RowBox[{"0.009649976657795767`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.10919266637702167`"}], "-", 
        RowBox[{"0.1804169333200528`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.04677885755771671`"}], "-", 
        RowBox[{"0.05412182088920179`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.029381556764607467`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.007140723712699129`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.006038361890747539`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.01021775854860312`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "0.185530210127159`"}], "-", 
        RowBox[{"0.29272041852172886`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.03304485924880973`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.08327838874144652`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.4404225717360065`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.8086468910850693`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.024741393932287192`"}], "+", 
        RowBox[{"0.058189477385034105`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0069461921013551226`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.014382134869342547`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.11418151932089941`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.07906866498704405`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0003249022884610339`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.0060920500479783694`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.015159727779510291`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.013215613543276364`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.028260111658894173`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.022862357652593826`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.04057867408737772`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.17101873946331503`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.011770567643459275`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.005443922108491324`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.0014499847965066953`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.020174622725453117`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.45684838815229895`"}], "-", 
        RowBox[{"0.5920819678438408`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.09220063058423768`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0761766138493693`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.21809703094617194`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.5276892655466615`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.09477436978647288`"}], "+", 
        RowBox[{"0.24213125369244412`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"0.012189139972120086`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.0030428638724176327`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.02269636929635054`", "\[InvisibleSpace]", "+", 
        RowBox[{"0.07311397554017215`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0005659376742387853`"}], "+", 
        RowBox[{"0.01822913603644647`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.0001918428447795148`"}], "-", 
        RowBox[{"0.003017064124984481`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.1506945688107987`"}], "-", 
        RowBox[{"0.2501932884320365`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.09724319011779682`"}], "-", 
        RowBox[{"0.1869162648770214`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{
        RowBox[{"-", "0.21913676722358316`"}], "+", 
        RowBox[{"0.05172429626733986`", " ", "\[ImaginaryI]"}]}], ",", 
       RowBox[{"0.7682979970700643`", "\[InvisibleSpace]", "-", 
        RowBox[{"0.4721885486340951`", " ", "\[ImaginaryI]"}]}]}], "}"}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.47297703768533*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSCanonizationCheck", "[", 
  RowBox[{"mps", ",", 
   RowBox[{"Site", "\[Rule]", "4"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.472977044948494*^9, 3.4729770546373453`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.472977055278228*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "4"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.472469432759774*^9, 3.472469433045414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "5"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4724694388709707`*^9, 3.47246943900412*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "6"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.472469444953669*^9, 3.472469445088418*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "7"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.472469449638479*^9, 3.4724694497605047`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "8"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4724694544864483`*^9, 3.472469454668885*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "9"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.47246945979847*^9, 3.472469459995927*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "10"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.472469463782297*^9, 3.4724694641688957`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"defineRight", "[", "1", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4724694779004107`*^9, 3.472469484199164*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "10"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.472469495766541*^9, 3.47246949606396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "9"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.472469500934623*^9, 3.4724695012762337`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "8"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.47246953202291*^9, 3.472469532282652*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "7"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4724695360708933`*^9, 3.472469537477004*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "6"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4724695412224092`*^9, 3.4724695414200983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "5"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4724695449665422`*^9, 3.472469545089216*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "4"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.472469548953373*^9, 3.4724695498460703`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "3"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.47246955461478*^9, 3.47246955493482*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "2"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.472469561142453*^9, 3.472469561306593*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "1"}], "}"}], ",", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mps", "[", 
       RowBox[{"[", "site", "]"}], "]"}], "=", "new"}]}]}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.472469564646585*^9, 3.472469564768407*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Old Testing", "Section",
 CellChangeTimes->{{3.4724701146919737`*^9, 3.4724701205292063`*^9}}],

Cell[BoxData[
 RowBox[{"defineLeft", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.472469642388296*^9, 3.472469648263438*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"IsLinkActive", "[", "]"}]], "Input",
 CellChangeTimes->{{3.47229863937318*^9, 3.47229864410165*^9}, {
  3.472298703223785*^9, 3.472298703350629*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.472298703932858*^9, 3.472298724102902*^9}, 
   3.472298766289423*^9, {3.4723028002320843`*^9, 3.472302828135542*^9}, {
   3.472302951915777*^9, 3.472302989064138*^9}, 3.4723037472724543`*^9, {
   3.472303823591634*^9, 3.472303839147786*^9}, {3.4723039115310087`*^9, 
   3.472303934043594*^9}, {3.4723040335877247`*^9, 3.47230403782511*^9}, 
   3.4723041721861553`*^9, 3.472360306994424*^9, 3.4723839325076923`*^9, 
   3.4724548323069763`*^9, 3.4724548758240967`*^9, 3.472468514828175*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"testsite", "=", "10"}], ";"}]], "Input",
 CellChangeTimes->{{3.4724685788567667`*^9, 3.472468599948432*^9}, {
   3.472468664046069*^9, 3.472468664103245*^9}, 3.472470125208104*^9, {
   3.472989686643928*^9, 3.472989686707499*^9}, {3.473054495675261*^9, 
   3.473054497062055*^9}, {3.4730546747146482`*^9, 3.473054674886344*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "testsite"}], "}"}], ",", 
   RowBox[{
    RowBox[{"temp", "=", 
     RowBox[{"mps", "[", 
      RowBox[{"[", "site", "]"}], "]"}]}], ";", 
    RowBox[{"Timing", "[", 
     RowBox[{"new", "=", 
      RowBox[{"MPSMatrixVector", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", "temp", ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], "]"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "testsite"}], "}"}], ",", 
   RowBox[{
    RowBox[{"Timing", "[", 
     RowBox[{"old", "=", 
      RowBox[{"Partition", "[", 
       RowBox[{
        RowBox[{"Partition", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MPSEffectiveHam", "[", 
            RowBox[{
             RowBox[{"L", "[", 
              RowBox[{"site", "-", "1"}], "]"}], ",", 
             RowBox[{"R", "[", 
              RowBox[{"site", "+", "1"}], "]"}], ",", 
             RowBox[{"interactionsL", "[", 
              RowBox[{"site", "-", "1"}], "]"}], ",", 
             RowBox[{"interactionsR", "[", 
              RowBox[{"site", "+", "1"}], "]"}], ",", 
             RowBox[{"fieldL", "[", 
              RowBox[{"site", "-", "1"}], "]"}], ",", 
             RowBox[{"fieldR", "[", 
              RowBox[{"site", "+", "1"}], "]"}], ",", 
             RowBox[{"operatorsL", "[", 
              RowBox[{"site", "-", "1"}], "]"}], ",", 
             RowBox[{"operatorsR", "[", 
              RowBox[{"site", "+", "1"}], "]"}], ",", 
             RowBox[{"HMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
                 RowBox[{"Min", "[", 
                  RowBox[{"numTensors", ",", 
                   RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
            "]"}], ".", 
           RowBox[{"Flatten", "[", 
            RowBox[{"mps", "[", 
             RowBox[{"[", "site", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"Length", "[", 
           RowBox[{"mps", "[", 
            RowBox[{"[", 
             RowBox[{"site", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"Length", "[", 
         RowBox[{"mps", "[", 
          RowBox[{"[", 
           RowBox[{"site", ",", "1", ",", "1"}], "]"}], "]"}], "]"}]}], 
       "]"}]}], "]"}], "//", "Normal"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.4724606438121433`*^9, 3.472460676110228*^9}, {
   3.472462447909309*^9, 3.47246249134626*^9}, {3.4724625402534513`*^9, 
   3.4724625719903383`*^9}, {3.472462802795916*^9, 3.472462831104908*^9}, {
   3.472462861489675*^9, 3.472463010266642*^9}, {3.472463182281623*^9, 
   3.4724631854907722`*^9}, {3.472463500047091*^9, 3.472463506458467*^9}, {
   3.4724657384034452`*^9, 3.472465742330604*^9}, {3.472466088446577*^9, 
   3.472466096521057*^9}, {3.472466129603302*^9, 3.472466129701433*^9}, 
   3.472466170578692*^9, {3.472466280701398*^9, 3.472466281038463*^9}, {
   3.472467312137054*^9, 3.472467344293009*^9}, {3.4724673887116203`*^9, 
   3.4724674113225822`*^9}, {3.4724674676025553`*^9, 3.472467509241569*^9}, {
   3.472467539385932*^9, 3.4724675555119867`*^9}, {3.472467702309668*^9, 
   3.472467711447235*^9}, {3.47246789119564*^9, 3.472467892506123*^9}, {
   3.472468589121419*^9, 3.4724685912821093`*^9}, {3.472470136571056*^9, 
   3.4724701607806377`*^9}, {3.472989796045066*^9, 3.472989826875085*^9}, {
   3.4730545422836123`*^9, 3.473054545176862*^9}, {3.473054581193801*^9, 
   3.473054664745623*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"10.690511811807072`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.5640798396965114`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
       
       RowBox[{"{", 
        RowBox[{"10.836731506709421`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.5171064021688241`", " ", "\[ImaginaryI]"}]}], "}"}]}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "7.298333063648222`"}], "+", 
         RowBox[{"8.280906160712991`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"7.307731402381436`", "\[InvisibleSpace]", "-", 
         RowBox[{"6.299069358380347`", " ", "\[ImaginaryI]"}]}], "}"}]}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4724606773766623`*^9, 3.4724608684671*^9, 3.47246115369849*^9, 
   3.4724612838893433`*^9, 3.472461342850691*^9, 3.472462427255107*^9, 
   3.4724624947361183`*^9, 3.472462578091269*^9, 3.47246268892948*^9, 
   3.472462834701461*^9, 3.4724628704431334`*^9, {3.4724629551627607`*^9, 
   3.472463011356473*^9}, 3.472463356208746*^9, 3.4724634570247583`*^9, 
   3.472463507206932*^9, 3.472463793569631*^9, 3.472463829840391*^9, 
   3.472465104284863*^9, 3.472465142165859*^9, 3.4724652260047913`*^9, 
   3.472465313850058*^9, 3.4724655095884047`*^9, 3.472465603480195*^9, 
   3.472465745879465*^9, 3.472465823714623*^9, {3.47246608317032*^9, 
   3.472466098024962*^9}, 3.472466130432324*^9, 3.47246617134026*^9, 
   3.4724662707584677`*^9, 3.472466322306493*^9, 3.472466370639168*^9, 
   3.4724664273191557`*^9, {3.4724664775719767`*^9, 3.472466483906304*^9}, {
   3.472466538573092*^9, 3.472466556649413*^9}, {3.472467351437305*^9, 
   3.472467412875902*^9}, {3.472467470692979*^9, 3.4724674790852137`*^9}, {
   3.472467511707183*^9, 3.472467556403837*^9}, {3.472467704741498*^9, 
   3.472467712083653*^9}, 3.472467893553629*^9, 3.472468135182638*^9, 
   3.4724685170188713`*^9, {3.4724685936479683`*^9, 3.472468601859074*^9}, 
   3.472468666394476*^9, {3.472470163001091*^9, 3.472470176091954*^9}, {
   3.472989801922962*^9, 3.472989848619678*^9}, 3.473054504828915*^9, 
   3.473054546284025*^9, {3.473054666718327*^9, 3.4730546768089533`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"10.69051181180707`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.5640798396965113`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"10.836731506709425`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.5171064021688242`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "7.29833306364822`"}], "+", 
         RowBox[{"8.280906160712993`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"7.307731402381433`", "\[InvisibleSpace]", "-", 
         RowBox[{"6.299069358380347`", " ", "\[ImaginaryI]"}]}]}], "}"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4724606773766623`*^9, 3.4724608684671*^9, 3.47246115369849*^9, 
   3.4724612838893433`*^9, 3.472461342850691*^9, 3.472462427255107*^9, 
   3.4724624947361183`*^9, 3.472462578091269*^9, 3.47246268892948*^9, 
   3.472462834701461*^9, 3.4724628704431334`*^9, {3.4724629551627607`*^9, 
   3.472463011356473*^9}, 3.472463356208746*^9, 3.4724634570247583`*^9, 
   3.472463507206932*^9, 3.472463793569631*^9, 3.472463829840391*^9, 
   3.472465104284863*^9, 3.472465142165859*^9, 3.4724652260047913`*^9, 
   3.472465313850058*^9, 3.4724655095884047`*^9, 3.472465603480195*^9, 
   3.472465745879465*^9, 3.472465823714623*^9, {3.47246608317032*^9, 
   3.472466098024962*^9}, 3.472466130432324*^9, 3.47246617134026*^9, 
   3.4724662707584677`*^9, 3.472466322306493*^9, 3.472466370639168*^9, 
   3.4724664273191557`*^9, {3.4724664775719767`*^9, 3.472466483906304*^9}, {
   3.472466538573092*^9, 3.472466556649413*^9}, {3.472467351437305*^9, 
   3.472467412875902*^9}, {3.472467470692979*^9, 3.4724674790852137`*^9}, {
   3.472467511707183*^9, 3.472467556403837*^9}, {3.472467704741498*^9, 
   3.472467712083653*^9}, 3.472467893553629*^9, 3.472468135182638*^9, 
   3.4724685170188713`*^9, {3.4724685936479683`*^9, 3.472468601859074*^9}, 
   3.472468666394476*^9, {3.472470163001091*^9, 3.472470176091954*^9}, {
   3.472989801922962*^9, 3.472989848619678*^9}, 3.473054504828915*^9, 
   3.473054546284025*^9, {3.473054666718327*^9, 3.473054676830721*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Chop", "[", 
  RowBox[{"new", "/", "old"}], "]"}]], "Input",
 CellChangeTimes->{{3.473054525424222*^9, 3.47305456227777*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.9999999999999998`", ",", "0.9999999999999999`", ",", 
       "1.0000000000000004`", ",", "0.9999999999999997`", ",", 
       "1.0000000000000004`", ",", "0.9999999999999998`", ",", 
       "0.9999999999999991`", ",", "1.0000000000000004`", ",", 
       "0.9999999999999991`", ",", "0.9999999999999999`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "0.9999999999999997`", ",", "0.9999999999999996`", ",", 
       "0.9999999999999998`", ",", "0.9999999999999997`", ",", 
       "0.9999999999999996`", ",", "1.000000000000001`", ",", 
       "0.9999999999999976`", ",", "0.9999999999999996`", ",", 
       "1.0000000000000004`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.9999999999999992`", ",", "1.0000000000000004`", ",", 
       "0.9999999999999991`", ",", "1.0000000000000004`", ",", 
       "0.9999999999999997`", ",", "1.0000000000000002`", ",", 
       "1.0000000000000007`", ",", "0.9999999999999999`", ",", "1.`", ",", 
       "0.9999999999999987`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.9999999999999991`", ",", "0.9999999999999999`", ",", 
       "0.9999999999999997`", ",", "0.9999999999999993`", ",", "1.`", ",", 
       "0.9999999999999997`", ",", "1.0000000000000004`", ",", "1.`", ",", 
       "0.9999999999999998`", ",", "1.0000000000000004`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.9999999999999996`", ",", "0.9999999999999997`", ",", 
       "1.0000000000000004`", ",", "1.`", ",", "1.0000000000000013`", ",", 
       "1.0000000000000002`", ",", "0.9999999999999994`", ",", 
       "1.0000000000000004`", ",", "0.9999999999999993`", ",", 
       "1.0000000000000007`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.0000000000000007`", ",", "0.9999999999999997`", ",", 
       "0.999999999999999`", ",", "1.0000000000000007`", ",", 
       "1.0000000000000002`", ",", "1.0000000000000004`", ",", 
       "0.9999999999999998`", ",", "1.`", ",", "1.`", ",", 
       "1.0000000000000007`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.000000000000001`", ",", "0.9999999999999993`", ",", 
       "1.000000000000001`", ",", "0.9999999999999994`", ",", 
       "1.0000000000000002`", ",", "1.000000000000001`", ",", 
       "0.9999999999999997`", ",", "0.9999999999999997`", ",", 
       "1.0000000000000002`", ",", "0.9999999999999996`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "0.999999999999998`", ",", "0.9999999999999992`", ",", 
       "1.`", ",", "1.0000000000000002`", ",", "0.9999999999999953`", ",", 
       "0.9999999999999992`", ",", "0.9999999999999996`", ",", 
       "1.000000000000001`", ",", "0.9999999999999998`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.0000000000000007`", ",", "0.9999999999999987`", ",", "1.`", ",", 
       "1.0000000000000004`", ",", "0.9999999999999993`", ",", 
       "1.0000000000000004`", ",", "1.0000000000000009`", ",", 
       "1.0000000000000004`", ",", "0.9999999999999996`", ",", 
       "1.0000000000000009`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.0000000000000002`", ",", "0.9999999999999962`", ",", 
       "1.0000000000000013`", ",", "1.`", ",", "0.9999999999999996`", ",", 
       "0.9999999999999993`", ",", "1.0000000000000007`", ",", 
       "0.9999999999999991`", ",", "1.0000000000000004`", ",", "1.`"}], 
      "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.9999999999999999`", ",", "0.9999999999999998`", ",", 
       "0.9999999999999997`", ",", "1.0000000000000002`", ",", 
       "1.0000000000000013`", ",", "1.0000000000000007`", ",", 
       "1.0000000000000007`", ",", "0.9999999999999996`", ",", 
       "0.9999999999999996`", ",", "0.9999999999999993`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.000000000000001`", ",", "0.9999999999999997`", ",", 
       "1.0000000000000004`", ",", "1.000000000000001`", ",", 
       "1.0000000000000002`", ",", "1.0000000000000004`", ",", 
       "0.9999999999999993`", ",", "1.0000000000000002`", ",", 
       "1.0000000000000007`", ",", "0.9999999999999993`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.0000000000000009`", ",", "1.0000000000000004`", ",", 
       "0.9999999999999997`", ",", "0.9999999999999999`", ",", 
       "1.0000000000000002`", ",", "1.`", ",", "0.9999999999999996`", ",", 
       "1.000000000000001`", ",", "1.`", ",", "1.0000000000000004`"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "1.0000000000000004`", ",", "1.0000000000000024`", ",", 
       "0.9999999999999998`", ",", "1.`", ",", "1.`", ",", 
       "1.0000000000000002`", ",", "1.0000000000000002`", ",", 
       "0.9999999999999992`", ",", "1.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.9999999999999989`", ",", "1.0000000000000009`", ",", 
       "1.0000000000000004`", ",", "0.9999999999999997`", ",", 
       "0.9999999999999999`", ",", "0.9999999999999988`", ",", 
       "0.9999999999999997`", ",", "0.9999999999999997`", ",", 
       "1.0000000000000002`", ",", "1.0000000000000004`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.0000000000000009`", ",", "0.9999999999999989`", ",", 
       "1.0000000000000002`", ",", "1.0000000000000002`", ",", 
       "1.0000000000000004`", ",", "1.0000000000000004`", ",", 
       "0.9999999999999996`", ",", "1.0000000000000002`", ",", 
       "1.0000000000000009`", ",", "1.0000000000000007`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0.9999999999999993`", ",", "0.9999999999999997`", ",", 
       "1.0000000000000013`", ",", "1.0000000000000009`", ",", "1.`", ",", 
       "1.`", ",", "1.0000000000000007`", ",", "1.0000000000000002`", ",", 
       "1.0000000000000004`", ",", "1.000000000000003`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.`", ",", "1.0000000000000002`", ",", "0.9999999999999996`", ",", 
       "0.9999999999999999`", ",", "1.0000000000000004`", ",", 
       "0.9999999999999998`", ",", "0.9999999999999992`", ",", 
       "0.9999999999999992`", ",", "1.0000000000000002`", ",", 
       "0.9999999999999993`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.0000000000000004`", ",", "1.0000000000000002`", ",", 
       "0.9999999999999994`", ",", "1.0000000000000009`", ",", 
       "1.0000000000000002`", ",", "0.9999999999999997`", ",", 
       "0.9999999999999998`", ",", "1.0000000000000002`", ",", "1.`", ",", 
       "1.`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1.0000000000000004`", ",", "1.0000000000000104`", ",", 
       "0.9999999999999998`", ",", "0.9999999999999996`", ",", 
       "1.0000000000000002`", ",", "0.9999999999999988`", ",", 
       "1.0000000000000007`", ",", "1.0000000000000027`", ",", 
       "1.000000000000001`", ",", "0.9999999999999998`"}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.47305452800601*^9, 3.473054562603001*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", 
  RowBox[{"HMatrix", "[", 
   RowBox[{"[", 
    RowBox[{"All", ",", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"1", ",", 
        RowBox[{"1", "-", "1"}]}], "]"}], ";;", "1"}], ",", 
     RowBox[{
      RowBox[{"Max", "[", 
       RowBox[{"1", ",", 
        RowBox[{"1", "-", "1"}]}], "]"}], ";;", 
      RowBox[{"Min", "[", 
       RowBox[{"numTensors", ",", 
        RowBox[{"1", "+", "1"}]}], "]"}]}]}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.472466558171042*^9, 3.4724665672056303`*^9}, {
  3.472467596385825*^9, 3.47246761532358*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "1", ",", "2"}], "}"}]], "Output",
 CellChangeTimes->{{3.472466561034032*^9, 3.472466567517535*^9}, 
   3.472467560179369*^9, {3.4724676021158533`*^9, 3.472467615842811*^9}, 
   3.472468136982752*^9, 3.472468522965138*^9, 3.472468607000202*^9, 
   3.472468667756218*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "testsite"}], "}"}], ",", 
   RowBox[{"Timing", "[", 
    RowBox[{
     RowBox[{"new", "=", 
      RowBox[{"FindGroundMPSSite", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "testsite"}], "}"}], ",", 
   RowBox[{"Timing", "[", 
    RowBox[{
     RowBox[{"old", "=", 
      RowBox[{"FindGroundMPSSiteManual", "[", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "site", "]"}], "]"}], ",", 
        RowBox[{"L", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"R", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"interactionsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"interactionsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"fieldL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"fieldR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"operatorsL", "[", 
         RowBox[{"site", "-", "1"}], "]"}], ",", 
        RowBox[{"operatorsR", "[", 
         RowBox[{"site", "+", "1"}], "]"}], ",", 
        RowBox[{"HMatrix", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
           RowBox[{
            RowBox[{"Max", "[", 
             RowBox[{"1", ",", 
              RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
            RowBox[{"Min", "[", 
             RowBox[{"numTensors", ",", 
              RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
       "]"}]}], ";"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.472298155324778*^9, 3.47229828681356*^9}, {
   3.472298329006065*^9, 3.472298399607561*^9}, {3.4722984446830883`*^9, 
   3.4722984737123013`*^9}, {3.472303752101985*^9, 3.472303812613493*^9}, {
   3.472303893521098*^9, 3.472303899217523*^9}, {3.4723043652100773`*^9, 
   3.472304367221262*^9}, {3.472304495747816*^9, 3.4723045295727043`*^9}, {
   3.472360672909754*^9, 3.472360764169936*^9}, {3.472360794450034*^9, 
   3.472360813016994*^9}, {3.4723629056843357`*^9, 3.472362922483879*^9}, 
   3.472364533557041*^9, {3.4723685410984917`*^9, 3.472368547629571*^9}, 
   3.472383860210805*^9, {3.472386603454194*^9, 3.47238661778895*^9}, {
   3.4723868263943357`*^9, 3.47238686589636*^9}, 3.472447982831373*^9, {
   3.472448298172476*^9, 3.472448326605163*^9}, {3.4724529066632357`*^9, 
   3.472452957134687*^9}, {3.472453109401301*^9, 3.4724531343318787`*^9}, {
   3.472453875499312*^9, 3.472453877869507*^9}, {3.472454546396635*^9, 
   3.4724545465655613`*^9}, {3.472463032929503*^9, 3.4724630433447027`*^9}, {
   3.472466673406986*^9, 3.472466684379388*^9}, {3.472466857828532*^9, 
   3.4724669251731453`*^9}, {3.472467112965929*^9, 3.472467118785308*^9}, {
   3.472467717658914*^9, 3.4724677206754303`*^9}, {3.4724678029558773`*^9, 
   3.472467804337151*^9}, 3.472467837646888*^9, {3.47246861285111*^9, 
   3.472468615758597*^9}, {3.47247018974923*^9, 3.472470217973907*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.4723606860804253`*^9, {3.472360746210073*^9, 3.4723607651161957`*^9}, {
   3.472360797827734*^9, 3.472360813662294*^9}, {3.472362900094283*^9, 
   3.472362923946143*^9}, 3.472364534701733*^9, 3.4723684921141*^9, {
   3.472368542250826*^9, 3.472368548857609*^9}, 3.4723838612588673`*^9, 
   3.472384229919189*^9, 3.472385772716918*^9, 3.4723860428814793`*^9, {
   3.4723865968570642`*^9, 3.472386618400073*^9}, {3.472386828488488*^9, 
   3.4723868694427757`*^9}, 3.472448000630547*^9, 3.472448250120935*^9, {
   3.472448313823267*^9, 3.472448327152762*^9}, 3.4724529584317923`*^9, {
   3.472453111649228*^9, 3.472453135161868*^9}, 3.4724534422778063`*^9, 
   3.472453799475902*^9, 3.472453879258889*^9, 3.4724539906241913`*^9, 
   3.472454142954729*^9, 3.472454281892769*^9, 3.472454573174357*^9, 
   3.4724548789438343`*^9, 3.4724587380268106`*^9, 3.4724591404714327`*^9, 
   3.472459445763383*^9, 3.472459488430534*^9, 3.47245965614027*^9, 
   3.472459840541848*^9, 3.4724598730404387`*^9, 3.47246229443451*^9, 
   3.472463045349805*^9, 3.472463142765997*^9, 3.472463365151457*^9, 
   3.4724665402254057`*^9, 3.472466590097262*^9, 3.47246668563302*^9, {
   3.472466915925582*^9, 3.472466926433159*^9}, 3.4724670753007708`*^9, 
   3.472467120274246*^9, 3.472467662808495*^9, 3.4724677212801523`*^9, 
   3.472467805344824*^9, 3.472467839393867*^9, 3.4724681384750013`*^9, 
   3.472468526522264*^9, 3.4724686163608437`*^9, 3.472468668911285*^9, {
   3.472470222093553*^9, 3.472470260307734*^9}, {3.472470304729911*^9, 
   3.472470318237712*^9}, 3.472989866104826*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{
  3.4723606860804253`*^9, {3.472360746210073*^9, 3.4723607651161957`*^9}, {
   3.472360797827734*^9, 3.472360813662294*^9}, {3.472362900094283*^9, 
   3.472362923946143*^9}, 3.472364534701733*^9, 3.4723684921141*^9, {
   3.472368542250826*^9, 3.472368548857609*^9}, 3.4723838612588673`*^9, 
   3.472384229919189*^9, 3.472385772716918*^9, 3.4723860428814793`*^9, {
   3.4723865968570642`*^9, 3.472386618400073*^9}, {3.472386828488488*^9, 
   3.4723868694427757`*^9}, 3.472448000630547*^9, 3.472448250120935*^9, {
   3.472448313823267*^9, 3.472448327152762*^9}, 3.4724529584317923`*^9, {
   3.472453111649228*^9, 3.472453135161868*^9}, 3.4724534422778063`*^9, 
   3.472453799475902*^9, 3.472453879258889*^9, 3.4724539906241913`*^9, 
   3.472454142954729*^9, 3.472454281892769*^9, 3.472454573174357*^9, 
   3.4724548789438343`*^9, 3.4724587380268106`*^9, 3.4724591404714327`*^9, 
   3.472459445763383*^9, 3.472459488430534*^9, 3.47245965614027*^9, 
   3.472459840541848*^9, 3.4724598730404387`*^9, 3.47246229443451*^9, 
   3.472463045349805*^9, 3.472463142765997*^9, 3.472463365151457*^9, 
   3.4724665402254057`*^9, 3.472466590097262*^9, 3.47246668563302*^9, {
   3.472466915925582*^9, 3.472466926433159*^9}, 3.4724670753007708`*^9, 
   3.472467120274246*^9, 3.472467662808495*^9, 3.4724677212801523`*^9, 
   3.472467805344824*^9, 3.472467839393867*^9, 3.4724681384750013`*^9, 
   3.472468526522264*^9, 3.4724686163608437`*^9, 3.472468668911285*^9, {
   3.472470222093553*^9, 3.472470260307734*^9}, {3.472470304729911*^9, 
   3.472470318237712*^9}, 3.472989866115883*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"site", "=", "testsite"}], "}"}], ",", 
   RowBox[{"Dimensions", "/@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"L", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"R", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"interactionsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"interactionsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"fieldL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"fieldR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"operatorsL", "[", 
       RowBox[{"site", "-", "1"}], "]"}], ",", 
      RowBox[{"operatorsR", "[", 
       RowBox[{"site", "+", "1"}], "]"}], ",", 
      RowBox[{"HMatrix", "[", 
       RowBox[{"[", 
        RowBox[{"All", ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
         RowBox[{
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
          RowBox[{"Min", "[", 
           RowBox[{"numTensors", ",", 
            RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
     "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.472467177444056*^9, 3.472467222434466*^9}, {
   3.472467726126589*^9, 3.472467726615595*^9}, {3.4724678437581*^9, 
   3.472467843838277*^9}, 3.47246862061382*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "1", ",", "2", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "2", ",", "2"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.472467212905519*^9, 3.472467222917396*^9}, 
   3.472467727320579*^9, 3.472467844440611*^9, 3.472467953160575*^9, 
   3.4724681434808292`*^9, 3.47246852882826*^9, 3.472468622427937*^9, 
   3.472468670772747*^9, 3.472989872103311*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"site", "=", "testsite"}], "}"}], ",", 
    RowBox[{"Heff", "=", 
     RowBox[{"MPSEffectiveHam", "[", 
      RowBox[{
       RowBox[{"L", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"R", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"interactionsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"interactionsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"fieldL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"fieldR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"operatorsL", "[", 
        RowBox[{"site", "-", "1"}], "]"}], ",", 
       RowBox[{"operatorsR", "[", 
        RowBox[{"site", "+", "1"}], "]"}], ",", 
       RowBox[{"HMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"All", ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
          RowBox[{
           RowBox[{"Max", "[", 
            RowBox[{"1", ",", 
             RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
           RowBox[{"Min", "[", 
            RowBox[{"numTensors", ",", 
             RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
      "]"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.4723648829558687`*^9, 3.4723648902013063`*^9}, {
   3.4723650488672047`*^9, 3.472365053234524*^9}, {3.47236512936621*^9, 
   3.4723651318160963`*^9}, {3.472365214640211*^9, 3.472365217310245*^9}, {
   3.472365432737372*^9, 3.47236544028973*^9}, {3.472448447063305*^9, 
   3.472448455029344*^9}, 3.4724630912369003`*^9, {3.472466929638558*^9, 
   3.472466929724598*^9}, {3.472466962060144*^9, 3.4724669877034597`*^9}, 
   3.4724671250957413`*^9, {3.47246773063323*^9, 3.4724677311088457`*^9}, {
   3.4724677721514177`*^9, 3.47246777269073*^9}, {3.47246862598699*^9, 
   3.472468631399118*^9}, {3.472989989215198*^9, 3.4729899921791058`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dimensions", "[", "Heff", "]"}]], "Input",
 CellChangeTimes->{{3.472989960043582*^9, 3.472989960241885*^9}, {
  3.47298999600352*^9, 3.472989998675432*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.472989999331588*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"new", "/", "old"}]], "Input",
 CellChangeTimes->{{3.472467036062742*^9, 3.472467040406272*^9}, {
  3.472989887229025*^9, 3.472989892662467*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.`", "\[InvisibleSpace]", "+", 
     RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0.`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.`", " ", "\[ImaginaryI]"}]}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.472467040824739*^9, 3.4724676900890083`*^9, 3.472467735259529*^9, 
   3.472467847530456*^9, 3.472468146188877*^9, 3.4724685330841837`*^9, 
   3.472468633321369*^9, 3.4724686736865273`*^9, {3.472989883583199*^9, 
   3.472989893799206*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"HOld", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Heff", ".", 
        RowBox[{"Flatten", "[", "old", "]"}]}], ",", "1"}], "]"}], ",", "2"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HNew", "=", 
   RowBox[{"Partition", "[", 
    RowBox[{
     RowBox[{"Partition", "[", 
      RowBox[{
       RowBox[{"Heff", ".", 
        RowBox[{"Flatten", "[", "new", "]"}]}], ",", "1"}], "]"}], ",", "2"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"HOld", "/", "old"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", 
  RowBox[{"HNew", "/", "new"}], "]"}]}], "Input",
 CellChangeTimes->{{3.472448465256857*^9, 3.472448501390892*^9}, {
   3.472448532882173*^9, 3.4724485597138853`*^9}, {3.472448661925445*^9, 
   3.472448679492895*^9}, {3.472453824346685*^9, 3.4724538531994963`*^9}, {
   3.472454302091867*^9, 3.472454306246765*^9}, 3.472458756907494*^9, {
   3.472463122314193*^9, 3.472463126053364*^9}, 3.472463160671733*^9, {
   3.472467266944941*^9, 3.4724672752404213`*^9}, {3.472467749808282*^9, 
   3.472467760332176*^9}, {3.4724678538598967`*^9, 3.472467855912814*^9}, {
   3.472468639792605*^9, 3.472468642025507*^9}, {3.4724686790260553`*^9, 
   3.472468679774221*^9}, {3.472989919266568*^9, 3.472989921944738*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\), \
\\(\\({\\(\\(\\(\\(-15.931339606052106`\\)\\) - \\(\\(1.069916423800771`*^-15\
\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5922168432320716` \
\[InvisibleSpace]\\)\\) + \\(\\(0.3867432585241109`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(-1.3454132927792832`\\)\\) - \\(\\(0.286721937181332`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.049506313764969945` \
\[InvisibleSpace]\\)\\) + \\(\\(0.06319594008221541`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), False, Rule[Editable, \
False]]\\) and \\!\\({\\(\\(\\(\\(17.44941793255293` \[InvisibleSpace]\\)\\) \
+ \\(\\(9.032483453899151`*^-16\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.6252204571894995`\\)\\) - \\(\\(0.4789255694222191`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.2117498316964552` \
\[InvisibleSpace]\\)\\) + \\(\\(0.01430441609582156`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(-0.04856717993113924`\\)\\) - \
\\(\\(0.3961136323364399`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.27244426426057067`\\)\\) - \\(\\(0.3181138373355074`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\) have incompatible shapes. \\!\\(\\*ButtonBox[\\\
\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990001745309*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\), \
\\(\\({\\(\\(\\(\\(-15.931339606052106`\\)\\) - \\(\\(1.069916423800771`*^-15\
\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5922168432320716` \
\[InvisibleSpace]\\)\\) + \\(\\(0.3867432585241109`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(-1.3454132927792832`\\)\\) - \\(\\(0.286721937181332`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.049506313764969945` \
\[InvisibleSpace]\\)\\) + \\(\\(0.06319594008221541`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), False, Rule[Editable, \
False]]\\) and \\!\\({\\(\\(\\(\\(17.44941793255293` \[InvisibleSpace]\\)\\) \
+ \\(\\(9.032483453899151`*^-16\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.6252204571894995`\\)\\) - \\(\\(0.4789255694222191`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.2117498316964552` \
\[InvisibleSpace]\\)\\) + \\(\\(0.01430441609582156`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(-0.04856717993113924`\\)\\) - \
\\(\\(0.3961136323364399`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.27244426426057067`\\)\\) - \\(\\(0.3181138373355074`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\) have incompatible shapes. \\!\\(\\*ButtonBox[\\\
\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990001834415*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\), \
\\(\\({\\(\\(\\(\\(-15.931339606052106`\\)\\) - \\(\\(1.069916423800771`*^-15\
\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5922168432320716` \
\[InvisibleSpace]\\)\\) + \\(\\(0.3867432585241109`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(-1.3454132927792832`\\)\\) - \\(\\(0.286721937181332`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.049506313764969945` \
\[InvisibleSpace]\\)\\) + \\(\\(0.06319594008221541`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), False, Rule[Editable, \
False]]\\) and \\!\\({\\(\\(\\(\\(17.44941793255293` \[InvisibleSpace]\\)\\) \
+ \\(\\(9.032483453899151`*^-16\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.6252204571894995`\\)\\) - \\(\\(0.4789255694222191`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.2117498316964552` \
\[InvisibleSpace]\\)\\) + \\(\\(0.01430441609582156`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(-0.04856717993113924`\\)\\) - \
\\(\\(0.3961136323364399`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.27244426426057067`\\)\\) - \\(\\(0.3181138373355074`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\) have incompatible shapes. \\!\\(\\*ButtonBox[\\\
\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990001970955*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Dot :: \\\"dotsh\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990002188689*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\), \
\\(\\({\\(\\(\\(\\(-15.931339606052106`\\)\\) - \\(\\(1.069916423800771`*^-15\
\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5922168432320716` \
\[InvisibleSpace]\\)\\) + \\(\\(0.3867432585241109`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(-1.3454132927792832`\\)\\) - \\(\\(0.286721937181332`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.049506313764969945` \
\[InvisibleSpace]\\)\\) + \\(\\(0.06319594008221541`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), False, Rule[Editable, \
False]]\\) and \\!\\({0.`, 0.`, 0.`, 0.`, 0.`}\\) have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990002331843*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\), \
\\(\\({\\(\\(\\(\\(-15.931339606052106`\\)\\) - \\(\\(1.069916423800771`*^-15\
\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5922168432320716` \
\[InvisibleSpace]\\)\\) + \\(\\(0.3867432585241109`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(-1.3454132927792832`\\)\\) - \\(\\(0.286721937181332`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.049506313764969945` \
\[InvisibleSpace]\\)\\) + \\(\\(0.06319594008221541`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), False, Rule[Editable, \
False]]\\) and \\!\\({0.`, 0.`, 0.`, 0.`, 0.`}\\) have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.4729900025410357`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)}\\)\\), \
\\(\\({\\(\\(\\(\\(-15.931339606052106`\\)\\) - \\(\\(1.069916423800771`*^-15\
\\\\ \[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.5922168432320716` \
\[InvisibleSpace]\\)\\) + \\(\\(0.3867432585241109`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 12 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(-1.3454132927792832`\\)\\) - \\(\\(0.286721937181332`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.049506313764969945` \
\[InvisibleSpace]\\)\\) + \\(\\(0.06319594008221541`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), False, Rule[Editable, \
False]]\\) and \\!\\({0.`, 0.`, 0.`, 0.`, 0.`}\\) have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990002686788*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Dot :: \\\"dotsh\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.4729900028775253`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\)\\), \\(\\({\\(\\(-15.931339606052106`\\)\\), \
\\(\\(\\(\\(0.5922168432320716` \[InvisibleSpace]\\)\\) + \
\\(\\(0.3867432585241109`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.8266088610584442`\\)\\) + \\(\\(0.8365214076310485`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), \
\\(\\(-14.230058669596115`\\)\\), \\(\\(\\(\\(-0.5615196794816874`\\)\\) - \
\\(\\(0.3820452735518045`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), \
False, Rule[Editable, False]]\\) and \\!\\({17.44941793255293`, \
\\(\\(\\(\\(-0.6252204571894995`\\)\\) - \\(\\(0.4789255694222191`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.2117498316964552` \
\[InvisibleSpace]\\)\\) + \\(\\(0.01430441609582156`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(-0.04856717993113924`\\)\\) - \
\\(\\(0.3961136323364399`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.27244426426057067`\\)\\) - \\(\\(0.3181138373355074`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\) have incompatible shapes. \\!\\(\\*ButtonBox[\\\
\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990003007237*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\)\\), \\(\\({\\(\\(-15.931339606052106`\\)\\), \
\\(\\(\\(\\(0.5922168432320716` \[InvisibleSpace]\\)\\) + \
\\(\\(0.3867432585241109`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.8266088610584442`\\)\\) + \\(\\(0.8365214076310485`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), \
\\(\\(-14.230058669596115`\\)\\), \\(\\(\\(\\(-0.5615196794816874`\\)\\) - \
\\(\\(0.3820452735518045`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), \
False, Rule[Editable, False]]\\) and \\!\\({17.44941793255293`, \
\\(\\(\\(\\(-0.6252204571894995`\\)\\) - \\(\\(0.4789255694222191`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.2117498316964552` \
\[InvisibleSpace]\\)\\) + \\(\\(0.01430441609582156`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(-0.04856717993113924`\\)\\) - \
\\(\\(0.3961136323364399`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.27244426426057067`\\)\\) - \\(\\(0.3181138373355074`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\) have incompatible shapes. \\!\\(\\*ButtonBox[\\\
\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990003222496*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\)\\), \\(\\({\\(\\(-15.931339606052106`\\)\\), \
\\(\\(\\(\\(0.5922168432320716` \[InvisibleSpace]\\)\\) + \
\\(\\(0.3867432585241109`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.8266088610584442`\\)\\) + \\(\\(0.8365214076310485`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), \
\\(\\(-14.230058669596115`\\)\\), \\(\\(\\(\\(-0.5615196794816874`\\)\\) - \
\\(\\(0.3820452735518045`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), \
False, Rule[Editable, False]]\\) and \\!\\({17.44941793255293`, \
\\(\\(\\(\\(-0.6252204571894995`\\)\\) - \\(\\(0.4789255694222191`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(0.2117498316964552` \
\[InvisibleSpace]\\)\\) + \\(\\(0.01430441609582156`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(-0.04856717993113924`\\)\\) - \
\\(\\(0.3961136323364399`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.27244426426057067`\\)\\) - \\(\\(0.3181138373355074`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\) have incompatible shapes. \\!\\(\\*ButtonBox[\\\
\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990003358336*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Dot :: \\\"dotsh\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.4729900035015087`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.057308501857499805`", " ", 
     RowBox[{
      TagBox[
       RowBox[{"SparseArray", "[", 
        RowBox[{
         InterpretationBox[
          
          RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
           "\[InvisibleSpace]", "\<\">\"\>"}],
          SequenceForm["<", 16, ">"],
          Editable->False], ",", 
         RowBox[{"{", 
          RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
       False,
       Editable->False], ".", 
      RowBox[{"{", 
       RowBox[{"17.44941793255293`", ",", 
        RowBox[{
         RowBox[{"-", "0.6252204571894995`"}], "-", 
         RowBox[{"0.4789255694222191`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{"0.2117498316964552`", "\[InvisibleSpace]", "+", 
         RowBox[{"0.01430441609582156`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "0.04856717993113924`"}], "-", 
         RowBox[{"0.3961136323364399`", " ", "\[ImaginaryI]"}]}], ",", 
        RowBox[{
         RowBox[{"-", "0.27244426426057067`"}], "-", 
         RowBox[{"0.3181138373355074`", " ", "\[ImaginaryI]"}]}]}], "}"}]}]}],
     "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1.0079806108501221`"}], "+", 
           RowBox[{"0.7721239483877507`", " ", "\[ImaginaryI]"}]}], ")"}], 
         " ", 
         RowBox[{
          TagBox[
           RowBox[{"SparseArray", "[", 
            RowBox[{
             InterpretationBox[
              
              RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
               "\[InvisibleSpace]", "\<\">\"\>"}],
              SequenceForm["<", 16, ">"],
              Editable->False], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
           False,
           Editable->False], ".", 
          RowBox[{"{", 
           RowBox[{"17.44941793255293`", ",", 
            RowBox[{
             RowBox[{"-", "0.6252204571894995`"}], "-", 
             RowBox[{"0.4789255694222191`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{"0.2117498316964552`", "\[InvisibleSpace]", "+", 
             RowBox[{"0.01430441609582156`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.04856717993113924`"}], "-", 
             RowBox[{"0.3961136323364399`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.27244426426057067`"}], "-", 
             RowBox[{"0.3181138373355074`", " ", "\[ImaginaryI]"}]}]}], 
           "}"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"4.70110065215043`", "\[InvisibleSpace]", "-", 
           RowBox[{"0.3175752221286114`", " ", "\[ImaginaryI]"}]}], ")"}], 
         " ", 
         RowBox[{
          TagBox[
           RowBox[{"SparseArray", "[", 
            RowBox[{
             InterpretationBox[
              
              RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
               "\[InvisibleSpace]", "\<\">\"\>"}],
              SequenceForm["<", 16, ">"],
              Editable->False], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
           False,
           Editable->False], ".", 
          RowBox[{"{", 
           RowBox[{"17.44941793255293`", ",", 
            RowBox[{
             RowBox[{"-", "0.6252204571894995`"}], "-", 
             RowBox[{"0.4789255694222191`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{"0.2117498316964552`", "\[InvisibleSpace]", "+", 
             RowBox[{"0.01430441609582156`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.04856717993113924`"}], "-", 
             RowBox[{"0.3961136323364399`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.27244426426057067`"}], "-", 
             RowBox[{"0.3181138373355074`", " ", "\[ImaginaryI]"}]}]}], 
           "}"}]}]}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "0.304946138882436`"}], "+", 
           RowBox[{"2.487138905552278`", " ", "\[ImaginaryI]"}]}], ")"}], " ",
          
         RowBox[{
          TagBox[
           RowBox[{"SparseArray", "[", 
            RowBox[{
             InterpretationBox[
              
              RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
               "\[InvisibleSpace]", "\<\">\"\>"}],
              SequenceForm["<", 16, ">"],
              Editable->False], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
           False,
           Editable->False], ".", 
          RowBox[{"{", 
           RowBox[{"17.44941793255293`", ",", 
            RowBox[{
             RowBox[{"-", "0.6252204571894995`"}], "-", 
             RowBox[{"0.4789255694222191`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{"0.2117498316964552`", "\[InvisibleSpace]", "+", 
             RowBox[{"0.01430441609582156`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.04856717993113924`"}], "-", 
             RowBox[{"0.3961136323364399`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.27244426426057067`"}], "-", 
             RowBox[{"0.3181138373355074`", " ", "\[ImaginaryI]"}]}]}], 
           "}"}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1.553076654499126`"}], "+", 
           RowBox[{"1.8134174179801619`", " ", "\[ImaginaryI]"}]}], ")"}], 
         " ", 
         RowBox[{
          TagBox[
           RowBox[{"SparseArray", "[", 
            RowBox[{
             InterpretationBox[
              
              RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
               "\[InvisibleSpace]", "\<\">\"\>"}],
              SequenceForm["<", 16, ">"],
              Editable->False], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
           False,
           Editable->False], ".", 
          RowBox[{"{", 
           RowBox[{"17.44941793255293`", ",", 
            RowBox[{
             RowBox[{"-", "0.6252204571894995`"}], "-", 
             RowBox[{"0.4789255694222191`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{"0.2117498316964552`", "\[InvisibleSpace]", "+", 
             RowBox[{"0.01430441609582156`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.04856717993113924`"}], "-", 
             RowBox[{"0.3961136323364399`", " ", "\[ImaginaryI]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "0.27244426426057067`"}], "-", 
             RowBox[{"0.3181138373355074`", " ", "\[ImaginaryI]"}]}]}], 
           "}"}]}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4724538540980864`*^9, 3.472454156487014*^9, {3.472454295095014*^9, 
   3.4724543067100554`*^9}, 3.472454895857667*^9, {3.472462314230434*^9, 
   3.4724623350099173`*^9}, {3.4724631145595617`*^9, 3.472463156884596*^9}, 
   3.472463189207294*^9, 3.4724633697225113`*^9, 3.472466545115314*^9, 
   3.472466594397478*^9, 3.472466689052652*^9, 3.472466919015106*^9, 
   3.4724669662434673`*^9, {3.472467275900198*^9, 3.472467298292432*^9}, 
   3.472467692731578*^9, {3.472467743538664*^9, 3.472467761010285*^9}, {
   3.472467850049202*^9, 3.472467856563859*^9}, 3.472468152459462*^9, 
   3.472468535843747*^9, 3.472468642534457*^9, {3.4724686759283743`*^9, 
   3.472468681429914*^9}, {3.472989900427318*^9, 3.4729899272853127`*^9}, 
   3.4729900036442347`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Power", "::", "\<\"infy\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \\!\\(1\\/0.`\\) encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/infy\\\", \
ButtonNote -> \\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990003890088*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Power", "::", "\<\"infy\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \\!\\(1\\/0.`\\) encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/infy\\\", \
ButtonNote -> \\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990004025126*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Power", "::", "\<\"infy\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Infinite expression \\!\\(1\\/0.`\\) encountered. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/infy\\\", \
ButtonNote -> \\\"Power::infy\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.47299000425289*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Power :: \\\"infy\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990004257848*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\)\\), \\(\\({\\(\\(-15.931339606052106`\\)\\), \
\\(\\(\\(\\(0.5922168432320716` \[InvisibleSpace]\\)\\) + \
\\(\\(0.3867432585241109`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.8266088610584442`\\)\\) + \\(\\(0.8365214076310485`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), \
\\(\\(-14.230058669596115`\\)\\), \\(\\(\\(\\(-0.5615196794816874`\\)\\) - \
\\(\\(0.3820452735518045`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), \
False, Rule[Editable, False]]\\) and \\!\\({0, 0, 0, 0, 0}\\) have \
incompatible shapes. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990004262609*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\)\\), \\(\\({\\(\\(-15.931339606052106`\\)\\), \
\\(\\(\\(\\(0.5922168432320716` \[InvisibleSpace]\\)\\) + \
\\(\\(0.3867432585241109`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.8266088610584442`\\)\\) + \\(\\(0.8365214076310485`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), \
\\(\\(-14.230058669596115`\\)\\), \\(\\(\\(\\(-0.5615196794816874`\\)\\) - \
\\(\\(0.3820452735518045`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), \
False, Rule[Editable, False]]\\) and \\!\\({0, 0, 0, 0, 0}\\) have \
incompatible shapes. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990004269041*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\(\\*TagBox[\\(SparseArray[\\(\\(Automatic, \
\\(\\(\[LeftSkeleton] 2 \[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, 4, \
8, 12, 16}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\)\\), \\(\\({\\(\\(-15.931339606052106`\\)\\), \
\\(\\(\\(\\(0.5922168432320716` \[InvisibleSpace]\\)\\) + \
\\(\\(0.3867432585241109`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\\(\\(-0.8266088610584442`\\)\\) + \\(\\(0.8365214076310485`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\[LeftSkeleton] 5 \[RightSkeleton]\\)\\), \
\\(\\(-14.230058669596115`\\)\\), \\(\\(\\(\\(-0.5615196794816874`\\)\\) - \
\\(\\(0.3820452735518045`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\[LeftSkeleton] 6 \[RightSkeleton]\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), \
False, Rule[Editable, False]]\\) and \\!\\({0, 0, 0, 0, 0}\\) have \
incompatible shapes. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.4729900042754374`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Dot :: \\\"dotsh\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.472989898170426*^9, 3.47298992526388*^9}, 
   3.472990004281767*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"ComplexInfinity", " ", 
    RowBox[{
     TagBox[
      RowBox[{"SparseArray", "[", 
       RowBox[{
        InterpretationBox[
         RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
          "\[InvisibleSpace]", "\<\">\"\>"}],
         SequenceForm["<", 16, ">"],
         Editable->False], ",", 
        RowBox[{"{", 
         RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
      False,
      Editable->False], ".", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ComplexInfinity", " ", 
         RowBox[{
          TagBox[
           RowBox[{"SparseArray", "[", 
            RowBox[{
             InterpretationBox[
              
              RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
               "\[InvisibleSpace]", "\<\">\"\>"}],
              SequenceForm["<", 16, ">"],
              Editable->False], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
           False,
           Editable->False], ".", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ComplexInfinity", " ", 
         RowBox[{
          TagBox[
           RowBox[{"SparseArray", "[", 
            RowBox[{
             InterpretationBox[
              
              RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
               "\[InvisibleSpace]", "\<\">\"\>"}],
              SequenceForm["<", 16, ">"],
              Editable->False], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
           False,
           Editable->False], ".", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], 
        "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ComplexInfinity", " ", 
         RowBox[{
          TagBox[
           RowBox[{"SparseArray", "[", 
            RowBox[{
             InterpretationBox[
              
              RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
               "\[InvisibleSpace]", "\<\">\"\>"}],
              SequenceForm["<", 16, ">"],
              Editable->False], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
           False,
           Editable->False], ".", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ComplexInfinity", " ", 
         RowBox[{
          TagBox[
           RowBox[{"SparseArray", "[", 
            RowBox[{
             InterpretationBox[
              
              RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "16", 
               "\[InvisibleSpace]", "\<\">\"\>"}],
              SequenceForm["<", 16, ">"],
              Editable->False], ",", 
             RowBox[{"{", 
              RowBox[{"4", ",", "4"}], "}"}]}], "]"}],
           False,
           Editable->False], ".", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}]}], 
        "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.4724538540980864`*^9, 3.472454156487014*^9, {3.472454295095014*^9, 
   3.4724543067100554`*^9}, 3.472454895857667*^9, {3.472462314230434*^9, 
   3.4724623350099173`*^9}, {3.4724631145595617`*^9, 3.472463156884596*^9}, 
   3.472463189207294*^9, 3.4724633697225113`*^9, 3.472466545115314*^9, 
   3.472466594397478*^9, 3.472466689052652*^9, 3.472466919015106*^9, 
   3.4724669662434673`*^9, {3.472467275900198*^9, 3.472467298292432*^9}, 
   3.472467692731578*^9, {3.472467743538664*^9, 3.472467761010285*^9}, {
   3.472467850049202*^9, 3.472467856563859*^9}, 3.472468152459462*^9, 
   3.472468535843747*^9, 3.472468642534457*^9, {3.4724686759283743`*^9, 
   3.472468681429914*^9}, {3.472989900427318*^9, 3.4729899272853127`*^9}, 
   3.472990004287057*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Inside the optimize routine", "Section",
 CellChangeTimes->{{3.47254163988197*^9, 3.472541647013205*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"mps", "=", 
   RowBox[{"MPSProductState", "[", 
    RowBox[{"10", ",", 
     RowBox[{"BondDimension", "\[Rule]", "10"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.472544188846539*^9, 3.472544188990093*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"pspec\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(i$\\) is neither an integer nor a \
list of integers. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/pspec\\\", ButtonNote -> \
\\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.47254419019549*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"pspec\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(i$\\) is neither an integer nor a \
list of integers. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/pspec\\\", ButtonNote -> \
\\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544190207541*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"pspec\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(i$\\) is neither an integer nor a \
list of integers. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/pspec\\\", ButtonNote -> \
\\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544190219849*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"pspec\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4725441902288*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"energy", ",", "prevEnergy", ",", "energyList", ",", 
     RowBox[{"sweeps", "=", "10"}], ",", 
     RowBox[{"sweep", "=", "0"}], ",", 
     RowBox[{"IntRange", "=", "1"}], ",", 
     RowBox[{"monitorenergy", "=", "True"}], ",", 
     RowBox[{"tol", "=", "DefaultEnergyTolerance"}], ",", "R", ",", "L", ",", 
     "fieldL", ",", "fieldR", ",", "operatorsR", ",", "operatorsL", ",", 
     "interactionsL", ",", "interactionsR", ",", "Heff", ",", "numTensors", 
     ",", "defineRight", ",", "defineLeft", ",", "\[Chi]", ",", "new", ",", 
     "invL", ",", "invR"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Preparation", " ", "assignments"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"energyList", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"MPSNormalize", "[", "mps", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"MPSCanonize", "[", "mps", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"numTensors", "=", 
     RowBox[{"Length", "[", "mps", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"\[Chi]", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"mps", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "These", " ", "will", " ", "be", " ", "used", " ", "to", " ", "define", 
      " ", "left", " ", "and", " ", "right", " ", "matrices"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"defineRight", "[", "temp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "fer", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{
         "R", ",", "fieldR", ",", "operatorsR", ",", "interactionsR"}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "[", 
          RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"R", "[", "n_", "]"}], ":=", 
         RowBox[{
          RowBox[{"R", "[", "n", "]"}], "=", 
          RowBox[{"RProduct", "[", 
           RowBox[{
            RowBox[{"mps", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", 
            RowBox[{"mps", "[", 
             RowBox[{"[", "n", "]"}], "]"}], ",", 
            RowBox[{"R", "[", 
             RowBox[{"n", "+", "1"}], "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fieldR", "[", 
          RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fieldR", "[", "n_", "]"}], ":=", 
         RowBox[{
          RowBox[{"fieldR", "[", "n", "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"PadRight", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fieldR", "[", 
                 RowBox[{"n", "+", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", ",", "\[Chi]"}], "}"}]}], "]"}], "+", 
             RowBox[{
              RowBox[{"HMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"\[Alpha]", ",", "n", ",", "n"}], "]"}], "]"}], 
              RowBox[{"RProduct", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                 RowBox[{"mps", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"R", "[", 
                 RowBox[{"n", "+", "1"}], "]"}]}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"operatorsR", "[", 
          RowBox[{"numTensors", "+", "2"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"operatorsR", "[", 
          RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"operatorsR", "[", "n_", "]"}], ":=", 
         RowBox[{
          RowBox[{"operatorsR", "[", "n", "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"operatorsR", "[", 
                  RowBox[{"n", "+", "1"}], "]"}], "[", 
                 RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
                RowBox[{"Min", "[", 
                 RowBox[{
                  RowBox[{"IntRange", "-", "1"}], ",", 
                  RowBox[{"Length", "[", 
                   RowBox[{
                    RowBox[{"operatorsR", "[", 
                    RowBox[{"n", "+", "1"}], "]"}], "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], "]"}]}], "]"}]}], 
               "]"}], ",", 
              RowBox[{"RProduct", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                 RowBox[{"mps", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"R", "[", 
                 RowBox[{"n", "+", "1"}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interactionsR", "[", 
          RowBox[{"numTensors", "+", "1"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interactionsR", "[", "n_", "]"}], ":=", 
         RowBox[{
          RowBox[{"interactionsR", "[", "n", "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"RProduct", "[", 
              RowBox[{
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"interactionsR", "[", 
                 RowBox[{"n", "+", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"HMatrix", "[", 
                RowBox[{"[", 
                 RowBox[{"\[Alpha]", ",", "n", ",", 
                  RowBox[{
                   RowBox[{"n", "+", "1"}], ";;", 
                   RowBox[{"Min", "[", 
                    RowBox[{
                    RowBox[{"n", "+", "IntRange"}], ",", "numTensors"}], 
                    "]"}]}]}], "]"}], "]"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"RProduct", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                    RowBox[{"mps", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                    RowBox[{"mps", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
                 "/@", 
                 RowBox[{
                  RowBox[{"operatorsR", "[", 
                   RowBox[{"n", "+", "1"}], "]"}], "[", 
                  RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], ")"}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"defineLeft", "[", "temp_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "fer", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ClearAll", "[", 
         RowBox[{
         "L", ",", "fieldL", ",", "operatorsL", ",", "interactionsL"}], "]"}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", "[", "0", "]"}], "=", 
         RowBox[{"{", 
          RowBox[{"{", "1", "}"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"L", "[", "n_", "]"}], ":=", 
         RowBox[{"LProduct", "[", 
          RowBox[{
           RowBox[{"mps", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"mps", "[", 
            RowBox[{"[", "n", "]"}], "]"}], ",", 
           RowBox[{"L", "[", 
            RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fieldL", "[", "0", "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fieldL", "[", "n_", "]"}], ":=", 
         RowBox[{
          RowBox[{"fieldL", "[", "n", "]"}], "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"PadRight", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"fieldL", "[", 
                 RowBox[{"n", "-", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"\[Chi]", ",", "\[Chi]"}], "}"}]}], "]"}], "+", 
             RowBox[{
              RowBox[{"HMatrix", "[", 
               RowBox[{"[", 
                RowBox[{"\[Alpha]", ",", "n", ",", "n"}], "]"}], "]"}], 
              RowBox[{"LProduct", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                 RowBox[{"mps", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"L", "[", 
                 RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"operatorsL", "[", 
          RowBox[{"-", "1"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"operatorsL", "[", "0", "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"operatorsL", "[", "n_", "]"}], ":=", 
         RowBox[{
          RowBox[{"operatorsL", "[", "n", "]"}], "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"operatorsL", "[", 
                  RowBox[{"n", "-", "1"}], "]"}], "[", 
                 RowBox[{"[", "\[Alpha]", "]"}], "]"}], ",", 
                RowBox[{"-", 
                 RowBox[{"Min", "[", 
                  RowBox[{
                   RowBox[{"IntRange", "-", "1"}], ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"operatorsL", "[", 
                    RowBox[{"n", "-", "1"}], "]"}], "[", 
                    RowBox[{"[", "\[Alpha]", "]"}], "]"}], "]"}]}], "]"}]}]}],
                "]"}], ",", 
              RowBox[{"LProduct", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                 RowBox[{"mps", "[", 
                  RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                RowBox[{"mps", "[", 
                 RowBox[{"[", "n", "]"}], "]"}], ",", 
                RowBox[{"L", "[", 
                 RowBox[{"n", "-", "1"}], "]"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interactionsL", "[", "0", "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", "0", "}"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"interactionsL", "[", "n_", "]"}], ":=", 
         RowBox[{
          RowBox[{"interactionsL", "[", "n", "]"}], "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"LProduct", "[", 
              RowBox[{
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{"mps", "[", 
                RowBox[{"[", "n", "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"interactionsL", "[", 
                 RowBox[{"n", "-", "1"}], "]"}], "[", 
                RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], "]"}], "+", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"HMatrix", "[", 
                RowBox[{"[", 
                 RowBox[{"\[Alpha]", ",", 
                  RowBox[{
                   RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{"n", "-", "IntRange"}], ",", "1"}], "]"}], ";;", 
                   RowBox[{"n", "-", "1"}]}], ",", "n"}], "]"}], "]"}], ".", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"LProduct", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"sigma", "[", "\[Alpha]", "]"}], ".", 
                    RowBox[{"mps", "[", 
                    RowBox[{"[", "n", "]"}], "]"}]}], ",", 
                    RowBox[{"mps", "[", 
                    RowBox[{"[", "n", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
                 "/@", 
                 RowBox[{
                  RowBox[{"operatorsL", "[", 
                   RowBox[{"n", "-", "1"}], "]"}], "[", 
                  RowBox[{"[", "\[Alpha]", "]"}], "]"}]}], ")"}]}], ")"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "1", ",", "3"}], "}"}]}], "]"}]}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"Start", " ", "from", " ", "the", " ", "left"}], ",", " ", 
      RowBox[{
      "so", " ", "prepare", " ", "all", " ", "right", " ", "matrices"}]}], 
     " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"ClearAll", "[", "new", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"defineRight", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"While", "[", 
     RowBox[{
      RowBox[{"sweep", "<", "sweeps"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Sweep", " ", "to", " ", "the", " ", "right", " ", "clears", " ", 
        "all", " ", "left", " ", "matrices", " ", "and", " ", "defines", " ", 
        "them", " ", "one", " ", "by", " ", "one"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"defineLeft", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"invL", "=", 
           RowBox[{"PseudoInverse", "[", 
            RowBox[{"L", "[", 
             RowBox[{"site", "-", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"invR", "=", 
           RowBox[{"PseudoInverse", "[", 
            RowBox[{"R", "[", 
             RowBox[{"site", "+", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
           RowBox[{"FindGroundMPSSite", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "site", "]"}], "]"}], ",", 
             RowBox[{"invL", ".", 
              RowBox[{"L", "[", 
               RowBox[{"site", "-", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"site", "+", "1"}], "]"}], ".", "invR"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"invL", ".", "#"}], "&"}], "/@", 
              RowBox[{"interactionsL", "[", 
               RowBox[{"site", "-", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", ".", "invR"}], "&"}], "/@", 
              RowBox[{"interactionsR", "[", 
               RowBox[{"site", "+", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"invL", ".", "#"}], "&"}], "/@", 
              RowBox[{"fieldL", "[", 
               RowBox[{"site", "-", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", ".", "invR"}], "&"}], "/@", 
              RowBox[{"fieldR", "[", 
               RowBox[{"site", "+", "1"}], "]"}]}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"invL", ".", "#"}], "&"}], 
                RowBox[{"operatorsL", "[", 
                 RowBox[{"site", "-", "1"}], "]"}]}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", ".", "invR"}], "&"}], ",", 
               RowBox[{"operatorsR", "[", 
                RowBox[{"site", "+", "1"}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"HMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
                 RowBox[{"Min", "[", 
                  RowBox[{"numTensors", ",", 
                   RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"energyList", "=", 
           RowBox[{"(", 
            RowBox[{"energyList", "~", "Join", "~", 
             RowBox[{"{", "energy", "}"}]}], ")"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mps", "[", 
            RowBox[{"[", "site", "]"}], "]"}], "=", "new"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"site", ",", "1", ",", "numTensors"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sweep", "+=", "0.5"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Sweep", " ", "to", " ", "the", " ", "left", " ", "clears", " ", 
         "all", " ", "right", " ", "matrices", " ", "and", " ", "defines", 
         " ", "them", " ", "one", " ", "by", " ", "one"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"defineRight", "[", "1", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"invL", "=", 
           RowBox[{"PseudoInverse", "[", 
            RowBox[{"L", "[", 
             RowBox[{"site", "-", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"invR", "=", 
           RowBox[{"PseudoInverse", "[", 
            RowBox[{"R", "[", 
             RowBox[{"site", "+", "1"}], "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"energy", ",", "new", ",", "info"}], "}"}], "=", 
           RowBox[{"FindGroundMPSSite", "[", 
            RowBox[{
             RowBox[{"mps", "[", 
              RowBox[{"[", "site", "]"}], "]"}], ",", 
             RowBox[{"invL", ".", 
              RowBox[{"L", "[", 
               RowBox[{"site", "-", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"site", "+", "1"}], "]"}], ".", "invR"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"invL", ".", "#"}], "&"}], "/@", 
              RowBox[{"interactionsL", "[", 
               RowBox[{"site", "-", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", ".", "invR"}], "&"}], "/@", 
              RowBox[{"interactionsR", "[", 
               RowBox[{"site", "+", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"invL", ".", "#"}], "&"}], "/@", 
              RowBox[{"fieldL", "[", 
               RowBox[{"site", "-", "1"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", ".", "invR"}], "&"}], "/@", 
              RowBox[{"fieldR", "[", 
               RowBox[{"site", "+", "1"}], "]"}]}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"invL", ".", "#"}], "&"}], 
                RowBox[{"operatorsL", "[", 
                 RowBox[{"site", "-", "1"}], "]"}]}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", ".", "invR"}], "&"}], ",", 
               RowBox[{"operatorsR", "[", 
                RowBox[{"site", "+", "1"}], "]"}], ",", 
               RowBox[{"{", "2", "}"}]}], "]"}], ",", 
             RowBox[{"HMatrix", "[", 
              RowBox[{"[", 
               RowBox[{"All", ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"site", "-", "1"}]}], "]"}], ";;", "site"}], ",", 
                RowBox[{
                 RowBox[{"Max", "[", 
                  RowBox[{"1", ",", 
                   RowBox[{"site", "-", "1"}]}], "]"}], ";;", 
                 RowBox[{"Min", "[", 
                  RowBox[{"numTensors", ",", 
                   RowBox[{"site", "+", "1"}]}], "]"}]}]}], "]"}], "]"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"energyList", "=", 
           RowBox[{"(", 
            RowBox[{"energyList", "~", "Join", "~", 
             RowBox[{"{", "energy", "}"}]}], ")"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"mps", "[", 
            RowBox[{"[", "site", "]"}], "]"}], "=", "new"}], ";"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"site", ",", "numTensors", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sweep", "+=", "0.5"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ";", "\[IndentingNewLine]", "energyList"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.472541845306262*^9, 3.47254185586093*^9}, {
  3.472541928470063*^9, 3.472541946119842*^9}, {3.4725420477068233`*^9, 
  3.4725420683508244`*^9}, {3.4725421432118387`*^9, 3.472542156940085*^9}, {
  3.472542277205546*^9, 3.472542295693095*^9}, {3.472542343864071*^9, 
  3.472542370743349*^9}, {3.472542457788416*^9, 3.472542466827393*^9}, {
  3.472542687751973*^9, 3.472542719514051*^9}, {3.472542778392116*^9, 
  3.472542821451672*^9}, {3.472543997863854*^9, 3.472544175057909*^9}, {
  3.472544223379003*^9, 3.472544284201025*^9}, {3.472544324002577*^9, 
  3.47254435345441*^9}, {3.473664869909018*^9, 3.473664869974882*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\({\\({1}\\)}\\) and \
\\!\\({\\(\\({\\({0}\\)}\\)\\), \\(\\({\\({0}\\)}\\)\\), \\(\\({\\({0}\\)}\\)\
\\)}\\) have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544193382312*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\({\\({1}\\)}\\) and \
\\!\\({\\(\\({\\({0}\\)}\\)\\), \\(\\({\\({0}\\)}\\)\\), \\(\\({\\({0}\\)}\\)\
\\)}\\) have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544193480291*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Dot", "::", "\<\"dotsh\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Tensors \\!\\({\\({1}\\)}\\) and \\!\\({}\\) have \
incompatible shapes. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", ButtonNote -> \
\\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544193612644*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Dot :: \\\"dotsh\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4725441937391033`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({energy$1902, new$1902}\\) and \
\\!\\(FindGroundMPSSite[\\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)]\\) \
are not the same shape. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4725441938641577`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MapThread", "::", "\<\"mptd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Object \\!\\(new$1902\\) at position {2, \\!\\(1\\)} in \
\\!\\(MapThread[\\(\\(\\(\\(\\(\\(\\(\\(ConjugateTranspose[#2]\\)\\) . \
\\(\\({\\({1}\\)}\\)\\) . #1\\)\\) &\\)\\), \\(\\({new$1902, \
new$1902}\\)\\)\\)\\)]\\) has only \\!\\(0\\) of required \\!\\(1\\) \
dimensions. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/MapThread/mptd\\\", ButtonNote -> \
\\\"MapThread::mptd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544193987659*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PseudoInverse", "::", "\<\"matrix\"\>"}], ":", 
  " ", "\<\"Argument \\!\\({\\(\\(new$1902 + \
\\(\\((\\(\\(\\(\\(\\(ConjugateTranspose[#2]\\)\\) . \\(\\({\\({1}\\)}\\)\\) \
. #1\\)\\) &\\))\\)\\)\\)\\), \\(\\(new$1902 + \
\\(\\((\\(\\(\\(\\(\\(ConjugateTranspose[#2]\\)\\) . \\(\\({\\({1}\\)}\\)\\) \
. #1\\)\\) &\\))\\)\\)\\)\\)}\\) at position \\!\\(1\\) is not a nonempty \
rectangular matrix. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/matrix\\\", ButtonNote -> \
\\\"PseudoInverse::matrix\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544194111514*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MapThread", "::", "\<\"mptd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Object \\!\\(new$1902\\) at position {2, \\!\\(1\\)} in \
\\!\\(MapThread[\\(\\(\\(\\(\\(\\(\\(\\(ConjugateTranspose[#2]\\)\\) . \
\\(\\({\\({1}\\)}\\)\\) . #1\\)\\) &\\)\\), \\(\\({new$1902, \
new$1902}\\)\\)\\)\\)]\\) has only \\!\\(0\\) of required \\!\\(1\\) \
dimensions. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/MapThread/mptd\\\", ButtonNote -> \
\\\"MapThread::mptd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4725441942387533`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MapThread", "::", "\<\"mptd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Object \\!\\(new$1902\\) at position {2, \\!\\(1\\)} in \
\\!\\(MapThread[\\(\\(\\(\\(\\(\\(\\(\\(ConjugateTranspose[#2]\\)\\) . \
\\(\\({\\({0}\\)}\\)\\) . #1\\)\\) &\\)\\), \\(\\({new$1902, \
new$1902}\\)\\)\\)\\)]\\) has only \\!\\(0\\) of required \\!\\(1\\) \
dimensions. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/MapThread/mptd\\\", ButtonNote -> \
\\\"MapThread::mptd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544194461966*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(MapThread :: \\\"mptd\\\"\\) will \
be suppressed during this calculation. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/stop\\\", \
ButtonNote -> \\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4725441945921164`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "::", "\<\"tdlen\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Objects of unequal length in \\!\\(\\(\\({\\(\\({0, 0, 0, \
0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \
\\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, \
0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, \
0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, \
0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \
\\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\)}\\)\\) + \\(\\({\\(\[LeftSkeleton] \
1 \[RightSkeleton]\\)}\\)\\)\\) cannot be combined. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Thread/tdlen\\\", ButtonNote -> \
\\\"Thread::tdlen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544194722644*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "::", "\<\"tdlen\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Objects of unequal length in \\!\\(\\(\\({\\(\\({0, 0, 0, \
0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \
\\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, \
0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, \
0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, \
0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \
\\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\)}\\)\\) + \\(\\({\\(\[LeftSkeleton] \
1 \[RightSkeleton]\\)}\\)\\)\\) cannot be combined. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Thread/tdlen\\\", ButtonNote -> \
\\\"Thread::tdlen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.47254419486469*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Thread", "::", "\<\"tdlen\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Objects of unequal length in \\!\\(\\(\\({\\(\\({0, 0, 0, \
0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \
\\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, \
0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, \
0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, \
0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\), \
\\(\\({0, 0, 0, 0, 0, 0, 0, 0, 0, 0}\\)\\)}\\)\\) + \\(\\({\\(\[LeftSkeleton] \
1 \[RightSkeleton]\\)}\\)\\)\\) cannot be combined. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Thread/tdlen\\\", ButtonNote -> \
\\\"Thread::tdlen\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544195160325*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Thread :: \\\"tdlen\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4725441954602413`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({energy$1902, new$1902}\\) and \
\\!\\(FindGroundMPSSite[\\(\\(\\(\\({\\*TagBox[\\(SparseArray[\\(\\(\
\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)]\\), False, Rule[Editable, False]], \
\\*TagBox[\\(SparseArray[\\(\\(Automatic, \\(\\(\[LeftSkeleton] 2 \
\[RightSkeleton]\\)\\), \\(\\({1, \\(\\({\\(\\({0, \\(\\(\[LeftSkeleton] 9 \
\[RightSkeleton]\\)\\), 100}\\)\\), \\(\\({\\(\[LeftSkeleton] 1 \
\[RightSkeleton]\\)}\\)\\)}\\)\\), \\(\\({\\(\\(\\(\\(0.2567678768946222` \
\[InvisibleSpace]\\)\\) + \\(\\(0.21476147921327682`\\\\ \
\[ImaginaryI]\\)\\)\\)\\), \\(\\(\\(\\(-0.07469280562569676`\\)\\) - \
\\(\\(0.2133573053197715`\\\\ \[ImaginaryI]\\)\\)\\)\\), \
\\(\\(\[LeftSkeleton] 97 \[RightSkeleton]\\)\\), \
\\(\\(\\(\\(0.06115857055994927` \[InvisibleSpace]\\)\\) + \
\\(\\(0.032771494025113784`\\\\ \
\[ImaginaryI]\\)\\)\\)\\)}\\)\\)}\\)\\)\\)\\)]\\), False, Rule[Editable, \
False]]}\\)\\), \\(\\(\[LeftSkeleton] 9 \[RightSkeleton]\\)\\)\\)\\)]\\) are \
not the same shape. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544195767324*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"PseudoInverse", "::", "\<\"matrix\"\>"}], ":", 
  " ", "\<\"Argument \\!\\({\\(\\(new$1902 + \
\\(\\((\\(\\(\\(\\(\\(ConjugateTranspose[#2]\\)\\) . \\(\\({\\(\\(new$1902 + \
\\(\\((\\(\\(\\(Dot[\\(\\(\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\) \
&\\))\\)\\)\\)\\), \\(\\(new$1902 + \\(\\((\\(\\(\\(Dot[\\(\\(\[LeftSkeleton] \
3 \[RightSkeleton]\\)\\)]\\)\\) &\\))\\)\\)\\)\\)}\\)\\) . #1\\)\\) \
&\\))\\)\\)\\)\\), \\(\\(new$1902 + \
\\(\\((\\(\\(\\(\\(\\(ConjugateTranspose[#2]\\)\\) . \\(\\({\\(\\(new$1902 + \
\\(\\((\\(\\(\\(Dot[\\(\\(\[LeftSkeleton] 3 \[RightSkeleton]\\)\\)]\\)\\) \
&\\))\\)\\)\\)\\), \\(\\(new$1902 + \\(\\((\\(\\(\\(Dot[\\(\\(\[LeftSkeleton] \
3 \[RightSkeleton]\\)\\)]\\)\\) &\\))\\)\\)\\)\\)}\\)\\) . #1\\)\\) \
&\\))\\)\\)\\)\\)}\\) at position \\!\\(1\\) is not a nonempty rectangular \
matrix. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/matrix\\\", ButtonNote -> \
\\\"PseudoInverse::matrix\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544196085161*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Set", "::", "\<\"shape\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Lists \\!\\({energy$1902, new$1902}\\) and \
\\!\\(FindGroundMPSSite[\\(\\(\[LeftSkeleton] 1 \[RightSkeleton]\\)\\)]\\) \
are not the same shape. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/Set/shape\\\", ButtonNote -> \
\\\"Set::shape\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544196430503*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Set :: \\\"shape\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472544196752763*^9}],

Cell[BoxData["$Aborted"], "Message", "MSG",
 CellChangeTimes->{3.472544197099345*^9}],

Cell[BoxData["$Aborted"], "Message", "MSG",
 CellChangeTimes->{3.4725441972799053`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", 
   ",", "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902", ",", "energy$1902", ",", "energy$1902", ",", 
   "energy$1902"}], "}"}]], "Output",
 CellChangeTimes->{3.4725419933177*^9, 3.472542084393882*^9, 
  3.4725421259194317`*^9, 3.472542183709249*^9, 3.4725423146208878`*^9, 
  3.4725423898206873`*^9, 3.472542744365129*^9, 3.4725428395118227`*^9, 
  3.472544197609676*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListPlot", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.472542841789505*^9, 3.47254284517981*^9}}],

Cell[BoxData[
 GraphicsBox[
  {Hue[0.67, 0.6, 0.6], PointBox[CompressedData["
1:eJxV1glUzWkfB/BLI0kpWt4W7SU1lArTgr4t2rQvt1Jy93stGcaM7P1VlIYc
Jryj4qJmGFKmhdd6raPXIC9JRPc1IoQWS0Lz9p55fufc6ZxO59Pvfu/v//yf
//M8fzvR1/HSoTwe78rg7////vXT5X/bx7Dgbc1YFfsHzkd+XBx6jKwDk0Wh
c1tUZEN4bag8EHuZbIyegneq/FdkM5xy1ra2eUMei47N5Uu+/cKK2Rbv7c6v
q3Ei2yOr5lVW81GyI95/8JN/WmvJPA66FTeP7nO3YR4P0dX/ON7YasvsiqiN
kaLfqskTcMX/cVn+CDtmN5iqVxcmeZInoUiS2zNukjmzBzpLlF3VWRbMnnA5
Pe3xtXvU3wsmO2YOCRDReCYjxEB7h/Zu8hSE/81TYVG1PNe1nvwVHib1ug4d
RePzhpv7a8ODxWQfZNl512fvs2b2xd2PNll77tF4/PAoOsLUzJaufxr6buhu
6rAjT8eCPufo4knkGSi98GJ9RgPZH2V/M/DDgeu+pyzs/zIHGLa1ir53YeYF
IKplfgjfneoBONjcuHEXqB6IeP6W6ytyqB6Iov7d44r3Uj0IV/pzxtX8RPUg
VE+fMnrNSaoHQ8tB12l+M9WD8dlew7yZSBNI1//7EdVn4vrIcwE676geAq8G
+GcPUD0EbRMv6e8Y4sDqoQgrlYqy9Jm5UHSvrHumsKB6GFo+FZXcsKR6GPqS
t3SesKF6OIZ5NiQbNbH558JxuT+0ySqK6hGwqv/X+Nhq9vxwEbj0R4yHaQLN
9yzo+ZV6PLVm88nNwure/G3eZ2h+I8HvvqDl10T1SDS9DLqf1Ub1KHg19oi0
1FSPwu7IkV1fv6R6NO4JjqS9HcnWAxeNO5rmxaBCYD0914zqMYja/4eBzniq
x+J84jinoAnMiIX5/vZhv5K5WKyxbv/d0otZFQvHqu9NZiynfBxmPOyo/qcP
ez4RBy2fsacfn2DPFxeHfv9L3/Z1s/lRxeGDpnnxMPiwsaFhCbufiIf4XJ2s
r4fmIx7LLD+vy+xjVsVj9wLfmrbhjiyfAOUX857/PIoZCXAr6t3GH83MJaA0
SNgiIasSYBxXk7DLiPKJ6Pzl2jGFBeUT8ULTXCJuxdx3CLSifCIeyu3PeNpS
PgmZ27972kJGEj763LEyt6N8Enb/dtjFx4HySfC8eztD70vK85F43Ew+4E55
Pm5FKa3E0ZTnQ97r/993EsrzkalpXjKGbTBpmpxJ+WRsO2+pe3MJ5ZPxKDm7
234p5ZPRX9Jd5LiM8iko82qrcFxO+RT8kHxnuuMKyqfAoiZB7k5WpeBk/rG9
A2ReKkbXFioerKZ8KvQ0zaXiyjLfUaZrKZ+KnYKdp6dnU342KvQq3+WQMRut
xRdf7yFzs5G++erQAI7ys7HyqFtD+zrKp2FD9qpnZ3Ion4ZLr7f+mJBH+TRs
z/Nuu5xP+TTs1DQvHXnmLS92TWT7L9KRWn3jYvArZi4dBr7tlb7BbL2p0hHQ
6pbCF9L6mwNjaSevVsaMOdj16cfyT3Jar3NgNs3Nz1BB+TnQCp1yuo7My4DS
4fYR4wWUz8BWTXMZeNKp32G6kPIZ+MX75pFhmZSfi5yoWm9fMuaiMurLBWvI
3FwcnRCxsH8R5Qd9++ivBdmUF6BD977QaS+zrQDHDc7lp/ey9QkBZhmtOdU6
la0/gQAhmuYEODj0+hJpKrNSAAejITlfvaL1KkBU1YXTd98yqwc/z5cVPXtH
+6cQM/qX9u17z2wrxKGYuw6fyRDihNPJ1uG0/gVCLD60Mmh7MzufOSEOLypo
WTaV7T/KwbymVUK0P/vuQZEzs1oIXyPdp8lpNH4RyqXdBUsazVh/EfpOeoR8
s4nt9xDhjnmaqOkps0CEyW/cr3tas/2dE+HSKPvFOVOYlSJ0rY0tq61jVolg
4nesg3eWWS2CjaZ5YuQXzo8PPDuG9RfDsMnJOW+1Pusvho2L28K8b4xZfzGK
Ho/5WHnkH6y/GNlhVmVhMez6lWI8yv0cPs+MXa9KDFHt1KY8S+ovRsCTkkdb
9tP7hgSHR1RfWFXObCvBz5qGBGe7TrmcIAskuDGvvvnjG1ofEpi2vq0zvMXu
p1KCCev2mBdOofNCgtLFLyc0NjGrJdDzdhWOl9D7jBTRCf0bfDzYeGyl8Fe9
am+op/NEirQ5T+rvq5gFUqRrmpPi4aRik/CLNP9SRGprDSzk0/ilGJ5cJtaW
M6uleBMc45G1lt1vngy1pXXrhJdHsv4yRCtmDhzcOIz1l+F2vepKb+MI1l+G
xogHGWvXs89zMpzNqyxc4aHH+stwUtMqGXxkB7qurWJWy2BVFd1m3MPMk8M7
93lVziFd1l+OlTpvDeZ3GLH+cqSUT7u32ZPNn0AOHeXV/ITn9PzJ0VQ25HLP
Mxq/HH/Wl8ee47HzVzX4fcVjJgbR+69ajtWa5ilQMVH7uIk+s60Ce9aM5ad6
MEOBn34vCnTZzyxQ4HhBp8HL8fS+pcBs/T95rpOZlQoYFT48ow6k836w7qy1
vCiXWa3ASsHdEtt8Ov/nobl8aX3mJnvV/wBUrL5v
    "]]},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, Automatic},
  PlotRange->Automatic,
  PlotRangeClipping->True]], "Output",
 CellChangeTimes->{3.472542845675684*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Append", "[", 
  RowBox[{
   RowBox[{"{", "}"}], ",", "o"}], "]"}]], "Input",
 CellChangeTimes->{{3.472542655794142*^9, 3.472542664555664*^9}}],

Cell[BoxData[
 RowBox[{"{", "o", "}"}]], "Output",
 CellChangeTimes->{3.472542665279278*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Canonization", "Section",
 CellChangeTimes->{{3.472804243505074*^9, 3.4728042450911407`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mps", "=", 
   RowBox[{"MPSProductState", "[", 
    RowBox[{"10", ",", 
     RowBox[{"BondDimension", "\[Rule]", "15"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MPSNormalize", "[", "mps", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MPSCanonize", "[", "mps", "]"}]}], "Input",
 CellChangeTimes->{{3.472804352158557*^9, 3.4728043554350758`*^9}, {
  3.472814242722034*^9, 3.472814248383019*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"pspec\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(i$\\) is neither an integer nor a \
list of integers. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/pspec\\\", ButtonNote -> \
\\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.47280435585743*^9, 3.4728043741559687`*^9}, 
   3.4728047341510687`*^9, 3.4728108159169292`*^9, 3.472810847222595*^9, 
   3.4728137486447153`*^9, 3.472813853557871*^9, 3.472814160116323*^9, 
   3.472814249024041*^9, 3.472814996037972*^9, 3.472815042158564*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"pspec\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(i$\\) is neither an integer nor a \
list of integers. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/pspec\\\", ButtonNote -> \
\\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.47280435585743*^9, 3.4728043741559687`*^9}, 
   3.4728047341510687`*^9, 3.4728108159169292`*^9, 3.472810847222595*^9, 
   3.4728137486447153`*^9, 3.472813853557871*^9, 3.472814160116323*^9, 
   3.472814249024041*^9, 3.472814996037972*^9, 3.472815042182399*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"pspec\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(i$\\) is neither an integer nor a \
list of integers. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/pspec\\\", ButtonNote -> \
\\\"Part::pspec\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.47280435585743*^9, 3.4728043741559687`*^9}, 
   3.4728047341510687`*^9, 3.4728108159169292`*^9, 3.472810847222595*^9, 
   3.4728137486447153`*^9, 3.472813853557871*^9, 3.472814160116323*^9, 
   3.472814249024041*^9, 3.472814996037972*^9, 3.47281504219515*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"pspec\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.47280435585743*^9, 3.4728043741559687`*^9}, 
   3.4728047341510687`*^9, 3.4728108159169292`*^9, 3.472810847222595*^9, 
   3.4728137486447153`*^9, 3.472813853557871*^9, 3.472814160116323*^9, 
   3.472814249024041*^9, 3.472814996037972*^9, 3.472815042206085*^9}],

Cell[BoxData[
 RowBox[{"4.2014790415728455`*^10", "-", 
  RowBox[{"1.7881393432617188`*^-6", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{{3.472804355957878*^9, 3.472804374274226*^9}, 
   3.472804734260247*^9, 3.472810815972555*^9, 3.472810847266131*^9, 
   3.472813748701679*^9, 3.472813853615261*^9, 3.472814160155067*^9, 
   3.472814249141756*^9, 3.472814996099866*^9, 3.4728150422162437`*^9}],

Cell[BoxData["0.9999999999999983`"], "Output",
 CellChangeTimes->{{3.472804355957878*^9, 3.472804374274226*^9}, 
   3.472804734260247*^9, 3.472810815972555*^9, 3.472810847266131*^9, 
   3.472813748701679*^9, 3.472813853615261*^9, 3.472814160155067*^9, 
   3.472814249141756*^9, 3.472814996099866*^9, 3.472815042296362*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSNormalize", "[", "mps", "]"}]], "Input",
 CellChangeTimes->{{3.47281499762755*^9, 3.472815000749707*^9}}],

Cell[BoxData["0.9999999999999996`"], "Output",
 CellChangeTimes->{3.472815001132827*^9, 3.4728150444906816`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"u", ",", "v", ",", "t"}], "}"}], "=", 
    RowBox[{"SingularValueDecomposition", "[", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"mps", "[", 
        RowBox[{"[", "10", "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "convert", " ", "the", " ", "result", " ", "to", " ", "MPS", 
    " ", 
    RowBox[{"form", " ", "[", 
     RowBox[{"spin", ",", " ", "chi", ",", " ", "1"}], "]"}]}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"mps", "[", 
     RowBox[{"[", "10", "]"}], "]"}], "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Conjugate", "[", "#", "]"}], "}"}], "&"}], ",", 
      RowBox[{"PadRight", "[", 
       RowBox[{"t", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "15"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", "2", "}"}]}], "]"}]}], "  ", ";"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", " ", 
   RowBox[{
   "Store", " ", "the", " ", "matrix", " ", "to", " ", "multiply", " ", "the",
     " ", "tensor", " ", "on", " ", "the", " ", "left"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xM", "=", 
   RowBox[{"PadRight", "[", 
    RowBox[{
     RowBox[{"u", ".", "v"}], ",", 
     RowBox[{"{", 
      RowBox[{"15", ",", "15"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "do", " ", "the", " ", "loop", " ", "to", " ", "the", " ", 
    "left", " ", "until", " ", "the", " ", "first", " ", "site"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Start", " ", "by", " ", "multiplying", " ", "the", " ", "tensor", " ", 
       "with", " ", "the", " ", "matrix", " ", "from", " ", "the", " ", 
       "previous", " ", "site"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"newTensor", "=", 
        RowBox[{
         RowBox[{"mps", "[", 
          RowBox[{"[", "s", "]"}], "]"}], ".", "xM"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"SVD", " ", "of", " ", "the", " ", "new", " ", "tensor"}], 
         ",", " ", 
         RowBox[{"putting", " ", "[", 
          RowBox[{"chiL", ",", " ", 
           RowBox[{"spin", "*", "chiR"}]}], "]"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", "v", ",", "t"}], "}"}], "=", 
        RowBox[{"SingularValueDecomposition", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"newTensor", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "2", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Form", " ", "the", " ", "new", " ", "tensor", " ", "with", " ", 
         "the", " ", "first", " ", "row", " ", "of", " ", 
         RowBox[{"t", "^", "dagger"}]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"mps", "[", 
         RowBox[{"[", "s", "]"}], "]"}], "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"ConjugateTranspose", "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"15", ",", "15"}], "}"}]}], "]"}], "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "All"}], "]"}], "]"}], ")"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Prepare", " ", "new", " ", "right", " ", "matrix"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"xM", "=", 
        RowBox[{"PadRight", "[", 
         RowBox[{
          RowBox[{"u", ".", "v"}], ",", 
          RowBox[{"{", 
           RowBox[{"15", ",", "15"}], "}"}]}], "]"}]}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", 
        RowBox[{"10", "-", "1"}], ",", "2", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.472804289505574*^9, 3.472804371648139*^9}, 
   3.472804740893305*^9, 3.472804854359643*^9, {3.472813805642412*^9, 
   3.472813810424505*^9}, {3.4728141356875563`*^9, 3.472814137123248*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Finish", " ", "off", " ", "with", " ", "the", " ", "first", " ", 
    "tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"newTensor", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"#", ".", "xM"}], "&"}], ")"}], "/@", 
      RowBox[{"mps", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"SVD", " ", "of", " ", "the", " ", "new", " ", "tensor"}], ",", 
     " ", 
     RowBox[{"putting", " ", "[", 
      RowBox[{
       RowBox[{"chiL", "=", "1"}], ",", " ", 
       RowBox[{"spin", "*", "chiR"}]}], "]"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "t"}], "}"}], "=", 
     RowBox[{"SingularValueDecomposition", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{"newTensor", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "2", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Form", " ", "the", " ", "new", " ", "tensor", " ", "with", " ", "the", 
     " ", "first", " ", "row", " ", "of", " ", 
     RowBox[{"t", "^", "dagger"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mps", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Partition", "[", 
        RowBox[{
         RowBox[{"ConjugateTranspose", "[", "t", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "15"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "All"}], "]"}], "]"}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "And", " ", "here", " ", "we", " ", "DROP", " ", "the", " ", "last", " ",
       "normalization"}], ",", " ", 
     RowBox[{"hoping", " ", "it", " ", "is", " ", "ok"}]}], " ", 
    "*)"}]}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"mps", "[", 
          RowBox[{"[", 
           RowBox[{"site", ",", "1"}], "]"}], "]"}], "]"}], ".", 
        RowBox[{"mps", "[", 
         RowBox[{"[", 
          RowBox[{"site", ",", "1"}], "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"ConjugateTranspose", "[", 
         RowBox[{"mps", "[", 
          RowBox[{"[", 
           RowBox[{"site", ",", "2"}], "]"}], "]"}], "]"}], ".", 
        RowBox[{"mps", "[", 
         RowBox[{"[", 
          RowBox[{"site", ",", "2"}], "]"}], "]"}]}]}], ")"}], "]"}], "//", 
    "MatrixForm"}], ",", 
   RowBox[{"{", 
    RowBox[{"site", ",", "1", ",", "10", ",", "1"}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.4728047618670588`*^9, 3.4728048227990427`*^9}, {
  3.472804875155026*^9, 3.47280492139624*^9}, {3.4728049569667797`*^9, 
  3.4728050042080708`*^9}, {3.472805048789886*^9, 3.472805072033517*^9}, {
  3.472814263051771*^9, 3.472814272569461*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`site$$ = 10, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`site$$], 1, 10, 1}}, Typeset`size$$ = {
    6118.125, {255.875, 261.125}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`site$1666$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`site$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`site$$, $CellContext`site$1666$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> MatrixForm[
        Chop[Dot[
           ConjugateTranspose[
            Part[$CellContext`mps, $CellContext`site$$, 1]], 
           Part[$CellContext`mps, $CellContext`site$$, 1]] + Dot[
           ConjugateTranspose[
            Part[$CellContext`mps, $CellContext`site$$, 2]], 
           Part[$CellContext`mps, $CellContext`site$$, 2]]]], 
      "Specifications" :> {{$CellContext`site$$, 1, 10, 1}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{6161., {300.375, 305.625}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.47280477877593*^9, 3.472804823105522*^9}, {
   3.472804912943392*^9, 3.472804922218277*^9}, 3.4728049677832937`*^9, 
   3.472805005738064*^9, {3.4728050595555363`*^9, 3.472805072738312*^9}, {
   3.472810824719297*^9, 3.4728108545361147`*^9}, 3.4728141037749863`*^9, 
   3.4728142734184732`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472968205342073*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472968205361747*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 2\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472968205368928*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.47296820547773*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part \\!\\(2\\) of \\!\\(ConjugateTranspose[t$1677]\\) \
does not exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.472974987764698*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partw\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part \\!\\(2\\) of \\!\\(ConjugateTranspose[t$1677]\\) \
does not exist. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/partw\\\", ButtonNote -> \
\\\"Part::partw\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4729749877746*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473062606842099*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473062606854473*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 2\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4730626068664837`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473062606878426*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4730626220507402`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473062622063529*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 2\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473062622076116*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473062622088386*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.4730754770767107`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 1\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473075477090567*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Part specification \\!\\(mps \[LeftDoubleBracket] \
\\(\\(10, 2\\)\\) \[RightDoubleBracket]\\) is longer than depth of object. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473075477096644*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"General", "::", "\<\"stop\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"Further output of \\!\\(Part :: \\\"partd\\\"\\) will be \
suppressed during this calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\
\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.473075477201449*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MPSCanonizationCheck", "[", "mps_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "norm", ",", "numTensors", ",", "spin", ",", "id", ",", "\[Chi]"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"numTensors", "=", 
      RowBox[{"Length", "[", "mps", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"spin", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]", "=", 
      RowBox[{"Length", "[", 
       RowBox[{"mps", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"id", "=", 
      RowBox[{"IdentityMatrix", "[", "\[Chi]", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Chop", "[", 
         RowBox[{"Total", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"mps", "[", 
                 RowBox[{"[", 
                  RowBox[{"site", ",", "s"}], "]"}], "]"}], ".", 
                RowBox[{"ConjugateTranspose", "[", 
                 RowBox[{"mps", "[", 
                  RowBox[{"[", 
                   RowBox[{"site", ",", "s"}], "]"}], "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"s", ",", "1", ",", "spin"}], "}"}]}], "]"}], "-", 
             "id"}], "]"}], "]"}], "]"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"site", ",", "2", ",", 
          RowBox[{"numTensors", "-", "1"}]}], "}"}]}], "]"}], "+", 
      RowBox[{"Chop", "[", 
       RowBox[{
        RowBox[{"Total", "[", 
         RowBox[{"Abs", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"mps", "[", 
                RowBox[{"[", 
                 RowBox[{"numTensors", ",", "s"}], "]"}], "]"}], ".", 
               RowBox[{"ConjugateTranspose", "[", 
                RowBox[{"mps", "[", 
                 RowBox[{"[", 
                  RowBox[{"numTensors", ",", "s"}], "]"}], "]"}], "]"}]}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", "1", ",", "spin"}], "}"}]}], "]"}], "-", 
            "id"}], "]"}], "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{"\[Chi]", "-", "2"}], ")"}]}], "]"}]}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.472804386013184*^9, 3.472804470226245*^9}, {
  3.472804507217682*^9, 3.472804626506401*^9}, {3.4728046600473003`*^9, 
  3.472804708914483*^9}, {3.472814324501045*^9, 3.472814440853352*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MPSCanonizationCheck", "[", "mps", "]"}]], "Input",
 CellChangeTimes->{{3.4728046292965183`*^9, 3.4728046350182333`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Right\"\>", "\[InvisibleSpace]", "0"}],
  SequenceForm["Right", 0],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.472814692362814*^9, 3.472814863423706*^9, {3.4728149132141848`*^9, 
   3.472814940126772*^9}}],

Cell[BoxData["chung"], "Print",
 CellChangeTimes->{
  3.472814692362814*^9, 3.472814863423706*^9, {3.4728149132141848`*^9, 
   3.472814940141357*^9}}]
}, Open  ]],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.472804645798621*^9, 3.472804710581946*^9}, {
   3.4728143132429333`*^9, 3.472814366297214*^9}, 3.472814443484301*^9, {
   3.472814535467209*^9, 3.472814622719136*^9}, 3.472814692371447*^9, 
   3.4728148634363203`*^9, {3.472814913236143*^9, 3.4728149401538486`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", "MPSCanonizationCheck", "]"}]], "Input",
 CellChangeTimes->{{3.472814915943551*^9, 3.4728149187341213`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Sense", "\[Rule]", "\<\"Right\"\>"}], ",", 
   RowBox[{"Site", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.472814919242713*^9}]
}, Open  ]]
}, Closed]]
},
WindowSize->{790, 751},
WindowMargins->{{312, Automatic}, {29, Automatic}},
ShowSelection->True,
FrontEndVersion->"6.0 for Linux x86 (64-bit) (February 7, 2008)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[568, 21, 76, 1, 32, "Input"],
Cell[CellGroupData[{
Cell[669, 26, 204, 5, 32, "Input"],
Cell[876, 33, 285, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1198, 42, 127, 2, 32, "Input"],
Cell[1328, 46, 203, 3, 31, "Output"]
}, Open  ]],
Cell[1546, 52, 308, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[1879, 62, 4978, 97, 297, "Input"],
Cell[CellGroupData[{
Cell[6882, 163, 100, 1, 24, "Print"],
Cell[6985, 166, 2708, 39, 185, "Print"]
}, Open  ]],
Cell[9708, 208, 11745, 245, 632, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21490, 458, 244, 6, 32, "Input"],
Cell[21737, 466, 1403, 26, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23177, 497, 113, 1, 39, "Subsection"],
Cell[CellGroupData[{
Cell[23315, 502, 443, 13, 32, "Input"],
Cell[23761, 517, 20363, 476, 249, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44173, 999, 97, 1, 39, "Subsection"],
Cell[CellGroupData[{
Cell[44295, 1004, 102, 1, 32, "Input"],
Cell[44400, 1007, 699, 18, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45136, 1030, 100, 1, 32, "Input"],
Cell[45239, 1033, 780, 20, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46056, 1058, 100, 1, 32, "Input"],
Cell[46159, 1061, 708, 18, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46904, 1084, 490, 14, 32, "Input"],
Cell[47397, 1100, 24060, 575, 244, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71494, 1680, 493, 14, 32, "Input"],
Cell[71990, 1696, 25118, 589, 246, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97145, 2290, 1014, 21, 32, "Input"],
Cell[98162, 2313, 28103, 631, 248, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126302, 2949, 820, 22, 55, "Input"],
Cell[127125, 2973, 36268, 724, 235, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[163430, 3702, 127, 2, 32, "Input"],
Cell[163560, 3706, 171, 3, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[163780, 3715, 161, 2, 73, "Section"],
Cell[CellGroupData[{
Cell[163966, 3721, 128, 2, 32, "Input"],
Cell[164097, 3725, 289, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164423, 3735, 4446, 96, 451, "Input"],
Cell[168872, 3833, 506, 10, 45, "Message"],
Cell[169381, 3845, 451, 9, 24, "Message"],
Cell[169835, 3856, 508, 10, 45, "Message"],
Cell[170346, 3868, 449, 9, 24, "Message"],
Cell[170798, 3879, 506, 10, 45, "Message"],
Cell[171307, 3891, 461, 9, 24, "Message"],
Cell[171771, 3902, 449, 9, 24, "Message"],
Cell[172223, 3913, 454, 9, 24, "Message"],
Cell[172680, 3924, 1590, 28, 119, "Message"],
Cell[174273, 3954, 1574, 27, 119, "Message"],
Cell[175850, 3983, 1295, 23, 99, "Message"],
Cell[177148, 4008, 454, 9, 24, "Message"],
Cell[177605, 4019, 150, 2, 31, "Output"]
}, Open  ]],
Cell[177770, 4024, 3184, 73, 275, "Input"],
Cell[CellGroupData[{
Cell[180979, 4101, 841, 26, 55, "Input"],
Cell[181823, 4129, 24435, 552, 244, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206295, 4686, 3470, 80, 385, "Input"],
Cell[209768, 4768, 506, 10, 45, "Message"],
Cell[210277, 4780, 449, 9, 24, "Message"],
Cell[210729, 4791, 506, 10, 45, "Message"],
Cell[211238, 4803, 449, 9, 24, "Message"],
Cell[211690, 4814, 505, 10, 45, "Message"],
Cell[212198, 4826, 458, 9, 24, "Message"],
Cell[212659, 4837, 449, 9, 24, "Message"],
Cell[213111, 4848, 451, 9, 24, "Message"],
Cell[213565, 4859, 1669, 27, 99, "Message"],
Cell[215237, 4888, 1711, 27, 99, "Message"],
Cell[216951, 4917, 1431, 23, 99, "Message"],
Cell[218385, 4942, 452, 9, 24, "Message"],
Cell[218840, 4953, 76, 1, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218953, 4959, 504, 15, 32, "Input"],
Cell[219460, 4976, 470, 11, 238, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[219979, 4993, 116, 1, 73, "Section"],
Cell[CellGroupData[{
Cell[220120, 4998, 60, 1, 32, "Input"],
Cell[220183, 5001, 461, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220681, 5013, 1457, 40, 187, "Input"],
Cell[222141, 5055, 1048, 15, 31, "Output"],
Cell[223192, 5072, 1047, 15, 31, "Output"]
}, Open  ]],
Cell[224254, 5090, 15139, 390, 1001, "Input"],
Cell[239396, 5482, 130, 2, 32, "Input"],
Cell[239529, 5486, 131, 2, 32, "Input"],
Cell[239663, 5490, 184, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[239872, 5499, 1496, 41, 121, "Input"],
Cell[241371, 5542, 873, 23, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242281, 5570, 1371, 37, 99, "Input"],
Cell[243655, 5609, 318, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244010, 5620, 2250, 58, 209, "Input"],
Cell[246263, 5680, 306, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246606, 5691, 131, 2, 32, "Input"],
Cell[246740, 5695, 139, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246916, 5703, 2577, 64, 253, "Input"],
Cell[CellGroupData[{
Cell[249518, 5771, 187, 2, 24, "Print"],
Cell[249708, 5775, 189, 2, 24, "Print"],
Cell[249900, 5779, 187, 2, 24, "Print"],
Cell[250090, 5783, 187, 2, 24, "Print"],
Cell[250280, 5787, 189, 2, 24, "Print"],
Cell[250472, 5791, 187, 2, 24, "Print"],
Cell[250662, 5795, 184, 2, 24, "Print"],
Cell[250849, 5799, 187, 2, 24, "Print"],
Cell[251039, 5803, 186, 2, 24, "Print"],
Cell[251228, 5807, 190, 2, 24, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[251467, 5815, 74, 1, 32, "Input"],
Cell[251544, 5818, 193, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251774, 5826, 129, 2, 32, "Input"],
Cell[251906, 5830, 886, 24, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[252829, 5859, 133, 2, 32, "Input"],
Cell[252965, 5863, 188, 4, 31, "Output"]
}, Open  ]],
Cell[253168, 5870, 130, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[253323, 5876, 374, 9, 32, "Input"],
Cell[253700, 5887, 1623, 35, 116, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[255360, 5927, 3554, 90, 297, "Input"],
Cell[CellGroupData[{
Cell[258939, 6021, 189, 2, 24, "Print"],
Cell[259131, 6025, 741, 20, 24, "Print"],
Cell[259875, 6047, 188, 2, 24, "Print"],
Cell[260066, 6051, 759, 20, 45, "Print"],
Cell[260828, 6073, 188, 2, 24, "Print"],
Cell[261019, 6077, 759, 20, 45, "Print"],
Cell[261781, 6099, 186, 2, 24, "Print"],
Cell[261970, 6103, 768, 20, 45, "Print"],
Cell[262741, 6125, 187, 2, 24, "Print"],
Cell[262931, 6129, 775, 20, 45, "Print"],
Cell[263709, 6151, 188, 2, 24, "Print"],
Cell[263900, 6155, 773, 20, 45, "Print"],
Cell[264676, 6177, 188, 2, 24, "Print"],
Cell[264867, 6181, 766, 20, 45, "Print"],
Cell[265636, 6203, 188, 2, 24, "Print"],
Cell[265827, 6207, 759, 20, 45, "Print"],
Cell[266589, 6229, 188, 2, 24, "Print"],
Cell[266780, 6233, 759, 20, 45, "Print"],
Cell[267542, 6255, 190, 2, 24, "Print"],
Cell[267735, 6259, 741, 20, 24, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[268525, 6285, 177, 3, 32, "Input"],
Cell[268705, 6290, 888, 25, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269630, 6320, 133, 2, 32, "Input"],
Cell[269766, 6324, 186, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269989, 6333, 97, 1, 32, "Input"],
Cell[270089, 6336, 272, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270398, 6347, 319, 8, 32, "Input"],
Cell[270720, 6357, 1601, 34, 116, "Output"]
}, Open  ]],
Cell[272336, 6394, 131, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[272492, 6400, 267, 7, 32, "Input"],
Cell[272762, 6409, 853, 23, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273652, 6437, 183, 4, 32, "Input"],
Cell[273838, 6443, 198, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[274073, 6452, 3965, 98, 363, "Input"],
Cell[CellGroupData[{
Cell[278063, 6554, 214, 3, 24, "Print"],
Cell[278280, 6559, 764, 21, 24, "Print"],
Cell[279047, 6582, 214, 3, 24, "Print"],
Cell[279264, 6587, 784, 21, 45, "Print"],
Cell[280051, 6610, 216, 3, 24, "Print"],
Cell[280270, 6615, 784, 21, 45, "Print"],
Cell[281057, 6638, 214, 3, 24, "Print"],
Cell[281274, 6643, 791, 21, 45, "Print"],
Cell[282068, 6666, 214, 3, 24, "Print"],
Cell[282285, 6671, 800, 21, 45, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[283134, 6698, 199, 4, 32, "Input"],
Cell[283336, 6704, 75, 1, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[283448, 6710, 449, 11, 77, "Input"],
Cell[283900, 6723, 485, 10, 24, "Message"],
Cell[284388, 6735, 483, 10, 24, "Message"],
Cell[284874, 6747, 483, 10, 24, "Message"],
Cell[285360, 6759, 502, 10, 24, "Message"],
Cell[285865, 6771, 122, 2, 31, "Output"],
Cell[285990, 6775, 121, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[286148, 6782, 129, 2, 32, "Input"],
Cell[286280, 6786, 817, 23, 52, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[287146, 6815, 110, 1, 73, "Section"],
Cell[CellGroupData[{
Cell[287281, 6820, 1634, 44, 187, "Input"],
Cell[288918, 6866, 1165, 16, 31, "Output"],
Cell[290086, 6884, 1168, 16, 31, "Output"],
Cell[291257, 6902, 1210, 18, 31, "Output"]
}, Open  ]],
Cell[292482, 6923, 15139, 390, 1001, "Input"],
Cell[307624, 7315, 129, 2, 32, "Input"],
Cell[307756, 7319, 128, 2, 32, "Input"],
Cell[307887, 7323, 578, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[308490, 7336, 128, 2, 32, "Input"],
Cell[308621, 7340, 411, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309069, 7351, 1558, 42, 121, "Input"],
Cell[310630, 7395, 987, 24, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[311654, 7424, 5620, 129, 341, "Input"],
Cell[317277, 7555, 3558, 70, 172, "Output"],
Cell[320838, 7627, 3552, 70, 172, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[324427, 7702, 2127, 57, 209, "Input"],
Cell[326557, 7761, 147, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326741, 7769, 122, 2, 32, "Input"],
Cell[326866, 7773, 92, 1, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326995, 7779, 1389, 39, 121, "Input"],
Cell[328387, 7820, 674, 19, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[329098, 7844, 3832, 104, 341, "Input"],
Cell[332933, 7950, 6062, 120, 292, "Output"],
Cell[338998, 8072, 5973, 120, 292, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[345020, 8198, 99, 1, 73, "Section"],
Cell[345122, 8201, 130, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[345277, 8207, 3433, 88, 297, "Input"],
Cell[CellGroupData[{
Cell[348735, 8299, 145, 2, 24, "Print"],
Cell[348883, 8303, 693, 20, 24, "Print"],
Cell[349579, 8325, 142, 2, 24, "Print"],
Cell[349724, 8329, 715, 20, 45, "Print"],
Cell[350442, 8351, 141, 2, 24, "Print"],
Cell[350586, 8355, 713, 20, 45, "Print"],
Cell[351302, 8377, 142, 2, 24, "Print"],
Cell[351447, 8381, 720, 20, 45, "Print"],
Cell[352170, 8403, 144, 2, 24, "Print"],
Cell[352317, 8407, 727, 20, 45, "Print"],
Cell[353047, 8429, 142, 2, 24, "Print"],
Cell[353192, 8433, 727, 20, 45, "Print"],
Cell[353922, 8455, 142, 2, 24, "Print"],
Cell[354067, 8459, 720, 20, 45, "Print"],
Cell[354790, 8481, 142, 2, 24, "Print"],
Cell[354935, 8485, 713, 20, 45, "Print"],
Cell[355651, 8507, 142, 2, 24, "Print"],
Cell[355796, 8511, 713, 20, 45, "Print"],
Cell[356512, 8533, 142, 2, 24, "Print"],
Cell[356657, 8537, 693, 20, 24, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[357399, 8563, 1403, 39, 121, "Input"],
Cell[358805, 8604, 337, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[359179, 8615, 2202, 56, 165, "Input"],
Cell[361384, 8673, 1214, 26, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[362635, 8704, 452, 9, 99, "Input"],
Cell[363090, 8715, 409, 6, 31, "Output"],
Cell[363502, 8723, 429, 7, 31, "Output"],
Cell[363934, 8732, 420, 7, 31, "Output"],
Cell[364357, 8741, 431, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[364825, 8753, 1998, 53, 165, "Input"],
Cell[366826, 8808, 2624, 59, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[369487, 8872, 455, 9, 99, "Input"],
Cell[369945, 8883, 356, 6, 31, "Output"],
Cell[370304, 8891, 375, 7, 31, "Output"],
Cell[370682, 8900, 366, 7, 31, "Output"],
Cell[371051, 8909, 377, 7, 31, "Output"]
}, Open  ]],
Cell[371443, 8919, 1952, 52, 165, "Input"],
Cell[CellGroupData[{
Cell[373420, 8975, 452, 9, 99, "Input"],
Cell[373875, 8986, 361, 6, 31, "Output"],
Cell[374239, 8994, 383, 7, 31, "Output"],
Cell[374625, 9003, 374, 7, 31, "Output"],
Cell[375002, 9012, 385, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[375424, 9024, 2023, 54, 187, "Input"],
Cell[377450, 9080, 426, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[377913, 9092, 453, 9, 99, "Input"],
Cell[378369, 9103, 438, 7, 31, "Output"],
Cell[378810, 9112, 460, 8, 31, "Output"],
Cell[379273, 9122, 451, 8, 31, "Output"],
Cell[379727, 9132, 461, 8, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[380225, 9145, 2025, 54, 187, "Input"],
Cell[382253, 9201, 422, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[382712, 9213, 453, 9, 99, "Input"],
Cell[383168, 9224, 381, 6, 31, "Output"],
Cell[383552, 9232, 403, 7, 31, "Output"],
Cell[383958, 9241, 395, 7, 31, "Output"],
Cell[384356, 9250, 403, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[384796, 9262, 1977, 53, 187, "Input"],
Cell[386776, 9317, 441, 8, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[387254, 9330, 476, 10, 99, "Input"],
Cell[387733, 9342, 373, 6, 31, "Output"],
Cell[388109, 9350, 395, 7, 31, "Output"],
Cell[388507, 9359, 383, 7, 31, "Output"],
Cell[388893, 9368, 394, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[389324, 9380, 199, 4, 32, "Input"],
Cell[389526, 9386, 354, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[389917, 9396, 1997, 53, 187, "Input"],
Cell[391917, 9451, 383, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[392337, 9463, 428, 9, 99, "Input"],
Cell[392768, 9474, 364, 6, 31, "Output"],
Cell[393135, 9482, 385, 7, 31, "Output"],
Cell[393523, 9491, 374, 7, 31, "Output"],
Cell[393900, 9500, 386, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[394323, 9512, 173, 4, 32, "Input"],
Cell[394499, 9518, 308, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[394844, 9527, 1998, 53, 187, "Input"],
Cell[396845, 9582, 356, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[397238, 9593, 427, 9, 99, "Input"],
Cell[397668, 9604, 318, 5, 31, "Output"],
Cell[397989, 9611, 338, 6, 31, "Output"],
Cell[398330, 9619, 330, 6, 31, "Output"],
Cell[398663, 9627, 340, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[399040, 9638, 1970, 53, 187, "Input"],
Cell[401013, 9693, 362, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[401412, 9704, 456, 9, 99, "Input"],
Cell[401871, 9715, 293, 5, 31, "Output"],
Cell[402167, 9722, 313, 6, 31, "Output"],
Cell[402483, 9730, 303, 6, 31, "Output"],
Cell[402789, 9738, 313, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[403139, 9749, 1665, 44, 165, "Input"],
Cell[404807, 9795, 1328, 34, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[406172, 9834, 1508, 40, 121, "Input"],
Cell[407683, 9876, 821, 19, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[408541, 9900, 1703, 45, 165, "Input"],
Cell[410247, 9947, 1167, 32, 52, "Output"]
}, Open  ]],
Cell[411429, 9982, 134, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[411588, 9988, 460, 13, 55, "Input"],
Cell[412051, 10003, 174, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[412262, 10012, 2192, 57, 231, "Input"],
Cell[414457, 10071, 172, 4, 31, "Output"],
Cell[414632, 10077, 152, 3, 31, "Output"],
Cell[414787, 10082, 174, 4, 31, "Output"],
Cell[414964, 10088, 162, 4, 31, "Output"],
Cell[415129, 10094, 172, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[415338, 10103, 2216, 57, 231, "Input"],
Cell[417557, 10162, 174, 4, 31, "Output"],
Cell[417734, 10168, 154, 3, 31, "Output"],
Cell[417891, 10173, 174, 4, 31, "Output"],
Cell[418068, 10179, 164, 4, 31, "Output"],
Cell[418235, 10185, 174, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[418446, 10194, 2216, 57, 231, "Input"],
Cell[420665, 10253, 173, 4, 31, "Output"],
Cell[420841, 10259, 151, 3, 31, "Output"],
Cell[420995, 10264, 174, 4, 31, "Output"],
Cell[421172, 10270, 166, 4, 31, "Output"],
Cell[421341, 10276, 172, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[421550, 10285, 2243, 58, 231, "Input"],
Cell[423796, 10345, 173, 4, 31, "Output"],
Cell[423972, 10351, 153, 3, 31, "Output"],
Cell[424128, 10356, 175, 4, 31, "Output"],
Cell[424306, 10362, 163, 4, 31, "Output"],
Cell[424472, 10368, 173, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[424682, 10377, 2240, 58, 231, "Input"],
Cell[426925, 10437, 177, 4, 31, "Output"],
Cell[427105, 10443, 155, 3, 31, "Output"],
Cell[427263, 10448, 176, 4, 31, "Output"],
Cell[427442, 10454, 168, 4, 31, "Output"],
Cell[427613, 10460, 178, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[427828, 10469, 2214, 57, 231, "Input"],
Cell[430045, 10528, 175, 4, 31, "Output"],
Cell[430223, 10534, 155, 3, 31, "Output"],
Cell[430381, 10539, 174, 4, 31, "Output"],
Cell[430558, 10545, 163, 4, 31, "Output"],
Cell[430724, 10551, 174, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[430935, 10560, 2240, 58, 231, "Input"],
Cell[433178, 10620, 172, 4, 31, "Output"],
Cell[433353, 10626, 152, 3, 31, "Output"],
Cell[433508, 10631, 172, 4, 31, "Output"],
Cell[433683, 10637, 164, 4, 31, "Output"],
Cell[433850, 10643, 172, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[434059, 10652, 2242, 58, 231, "Input"],
Cell[436304, 10712, 174, 4, 31, "Output"],
Cell[436481, 10718, 154, 3, 31, "Output"],
Cell[436638, 10723, 176, 4, 31, "Output"],
Cell[436817, 10729, 164, 4, 31, "Output"],
Cell[436984, 10735, 173, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[437194, 10744, 211, 5, 32, "Input"],
Cell[437408, 10751, 122, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[437567, 10758, 1450, 39, 143, "Input"],
Cell[439020, 10799, 671, 19, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[439728, 10823, 1284, 36, 121, "Input"],
Cell[441015, 10861, 194, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441246, 10870, 2139, 56, 231, "Input"],
Cell[443388, 10928, 149, 3, 31, "Output"],
Cell[443540, 10933, 126, 2, 31, "Output"],
Cell[443669, 10937, 147, 3, 31, "Output"],
Cell[443819, 10942, 137, 3, 31, "Output"],
Cell[443959, 10947, 147, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444143, 10955, 95, 1, 32, "Input"],
Cell[444241, 10958, 217, 5, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[444495, 10968, 125, 2, 32, "Input"],
Cell[444623, 10972, 133, 3, 31, "Output"]
}, Open  ]],
Cell[444771, 10978, 131, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[444927, 10984, 1335, 38, 121, "Input"],
Cell[446265, 11024, 145, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[446447, 11032, 2506, 68, 275, "Input"],
Cell[448956, 11102, 230, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[449223, 11113, 427, 9, 99, "Input"],
Cell[449653, 11124, 103, 2, 31, "Output"],
Cell[449759, 11128, 125, 3, 31, "Output"],
Cell[449887, 11133, 115, 3, 31, "Output"],
Cell[450005, 11138, 125, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[450167, 11146, 2498, 65, 275, "Input"],
Cell[452668, 11213, 1324, 22, 65, "Message"],
Cell[453995, 11237, 1324, 22, 65, "Message"],
Cell[455322, 11261, 3185, 72, 152, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[458544, 11338, 2419, 64, 275, "Input"],
Cell[460966, 11404, 409, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[461412, 11421, 2418, 64, 275, "Input"],
Cell[463833, 11487, 414, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[464284, 11504, 2418, 64, 275, "Input"],
Cell[466705, 11570, 418, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[467160, 11587, 2418, 64, 275, "Input"],
Cell[469581, 11653, 415, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[470033, 11670, 2448, 65, 275, "Input"],
Cell[472484, 11737, 412, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[472933, 11754, 2446, 65, 275, "Input"],
Cell[475382, 11821, 407, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[475826, 11838, 2420, 64, 275, "Input"],
Cell[478249, 11904, 408, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[478694, 11921, 2449, 65, 275, "Input"],
Cell[481146, 11988, 939, 17, 65, "Message"],
Cell[482088, 12007, 373, 11, 31, "Output"]
}, Open  ]],
Cell[482476, 12021, 411, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[482912, 12032, 4800, 110, 319, "Input"],
Cell[487715, 12144, 567, 10, 45, "Message"],
Cell[488285, 12156, 1654, 25, 31, "Output"],
Cell[489942, 12183, 2385, 44, 52, "Output"],
Cell[492330, 12229, 149, 3, 31, "Output"],
Cell[492482, 12234, 128, 2, 31, "Output"],
Cell[492613, 12238, 147, 3, 31, "Output"],
Cell[492763, 12243, 137, 3, 31, "Output"],
Cell[492903, 12248, 146, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[493086, 12256, 2191, 57, 231, "Input"],
Cell[495280, 12315, 149, 3, 31, "Output"],
Cell[495432, 12320, 130, 2, 31, "Output"],
Cell[495565, 12324, 150, 3, 31, "Output"],
Cell[495718, 12329, 139, 3, 31, "Output"],
Cell[495860, 12334, 149, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[496046, 12342, 2187, 57, 231, "Input"],
Cell[498236, 12401, 148, 3, 31, "Output"],
Cell[498387, 12406, 125, 2, 31, "Output"],
Cell[498515, 12410, 149, 3, 31, "Output"],
Cell[498667, 12415, 141, 3, 31, "Output"],
Cell[498811, 12420, 148, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[498996, 12428, 225, 4, 55, "Input"],
Cell[499224, 12434, 13778, 283, 1082, "Output"],
Cell[513005, 12719, 8849, 183, 615, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[521891, 12907, 171, 3, 32, "Input"],
Cell[522065, 12912, 2465, 56, 166, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[524567, 12973, 95, 1, 32, "Input"],
Cell[524665, 12976, 23876, 464, 1232, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[548578, 13445, 304, 7, 77, "Input"],
Cell[548885, 13454, 174, 4, 31, "Output"],
Cell[549062, 13460, 168, 4, 31, "Output"],
Cell[549233, 13466, 174, 4, 31, "Output"]
}, Open  ]],
Cell[549422, 13473, 130, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[549577, 13479, 97, 1, 32, "Input"],
Cell[549677, 13482, 119, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[549833, 13490, 339, 7, 32, "Input"],
Cell[550175, 13499, 312, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[550524, 13510, 100, 1, 32, "Input"],
Cell[550627, 13513, 71, 1, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[550735, 13519, 95, 1, 32, "Input"],
Cell[550833, 13522, 325, 11, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[551195, 13538, 102, 1, 32, "Input"],
Cell[551300, 13541, 154, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[551491, 13549, 201, 4, 32, "Input"],
Cell[551695, 13555, 296, 8, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[552028, 13568, 149, 3, 32, "Input"],
Cell[552180, 13573, 1823, 44, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[554040, 13622, 165, 2, 55, "Input"],
Cell[554208, 13626, 2894, 63, 152, "Output"],
Cell[557105, 13691, 140, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[557282, 13699, 1674, 46, 143, "Input"],
Cell[558959, 13747, 936, 25, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[559932, 13777, 1804, 48, 143, "Input"],
Cell[561739, 13827, 6381, 124, 292, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[568157, 13956, 131, 2, 32, "Input"],
Cell[568291, 13960, 187, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[568515, 13969, 130, 2, 32, "Input"],
Cell[568648, 13973, 175, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[568860, 13982, 246, 5, 32, "Input"],
Cell[569109, 13989, 152, 2, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[569298, 13996, 120, 2, 32, "Input"],
Cell[569421, 14000, 14079, 278, 799, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[583537, 14283, 312, 7, 32, "Input"],
Cell[583852, 14292, 148, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[584037, 14300, 123, 2, 32, "Input"],
Cell[584163, 14304, 2895, 63, 152, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[587095, 14372, 352, 8, 32, "Input"],
Cell[587450, 14382, 2532, 57, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[590019, 14444, 183, 4, 32, "Input"],
Cell[590205, 14450, 125, 3, 31, "Output"]
}, Open  ]],
Cell[590345, 14456, 129, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[590499, 14462, 172, 4, 32, "Input"],
Cell[590674, 14468, 503, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[591214, 14487, 201, 4, 32, "Input"],
Cell[591418, 14493, 73, 1, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[591528, 14499, 131, 2, 32, "Input"],
Cell[591662, 14503, 118, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[591817, 14511, 1729, 47, 143, "Input"],
Cell[593549, 14560, 12395, 231, 612, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[605981, 14796, 330, 8, 32, "Input"],
Cell[606314, 14806, 9368, 187, 472, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[615719, 14998, 199, 4, 32, "Input"],
Cell[615921, 15004, 73, 1, 31, "Output"]
}, Open  ]],
Cell[616009, 15008, 1739, 47, 165, "Input"],
Cell[617751, 15057, 1740, 47, 165, "Input"],
Cell[619494, 15106, 1739, 47, 165, "Input"],
Cell[621236, 15155, 1741, 47, 165, "Input"],
Cell[622980, 15204, 1741, 47, 165, "Input"],
Cell[624724, 15253, 1738, 47, 165, "Input"],
Cell[626465, 15302, 1742, 47, 165, "Input"],
Cell[628210, 15351, 150, 3, 32, "Input"],
Cell[628363, 15356, 1739, 47, 165, "Input"],
Cell[630105, 15405, 1741, 47, 165, "Input"],
Cell[631849, 15454, 1738, 47, 165, "Input"],
Cell[633590, 15503, 1741, 47, 165, "Input"],
Cell[635334, 15552, 1743, 47, 165, "Input"],
Cell[637080, 15601, 1741, 47, 165, "Input"],
Cell[638824, 15650, 1741, 47, 165, "Input"],
Cell[640568, 15699, 1737, 47, 165, "Input"],
Cell[642308, 15748, 1739, 47, 165, "Input"],
Cell[644050, 15797, 1739, 47, 165, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[645826, 15849, 100, 1, 73, "Section"],
Cell[645929, 15852, 129, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[646083, 15858, 173, 3, 32, "Input"],
Cell[646259, 15863, 539, 7, 31, "Output"]
}, Open  ]],
Cell[646813, 15873, 363, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[647201, 15883, 5080, 118, 319, "Input"],
Cell[652284, 16003, 2343, 45, 31, "Output"],
Cell[654630, 16050, 2275, 42, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[656942, 16097, 149, 3, 32, "Input"],
Cell[657094, 16102, 7024, 144, 212, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[664155, 16251, 610, 17, 32, "Input"],
Cell[664768, 16270, 319, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[665124, 16281, 4546, 103, 275, "Input"],
Cell[669673, 16386, 1668, 25, 31, "Output"],
Cell[671344, 16413, 1668, 25, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[673049, 16443, 1540, 41, 99, "Input"],
Cell[674592, 16486, 909, 24, 31, "Output"]
}, Open  ]],
Cell[675516, 16513, 2085, 48, 99, "Input"],
Cell[CellGroupData[{
Cell[677626, 16565, 180, 3, 32, "Input"],
Cell[677809, 16570, 115, 3, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[677961, 16578, 168, 3, 32, "Input"],
Cell[678132, 16583, 1102, 29, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[679271, 16617, 1385, 31, 99, "Input"],
Cell[680659, 16650, 1758, 28, 114, "Message"],
Cell[682420, 16680, 1758, 28, 114, "Message"],
Cell[684181, 16710, 1758, 28, 114, "Message"],
Cell[685942, 16740, 501, 10, 24, "Message"],
Cell[686446, 16752, 1237, 20, 81, "Message"],
Cell[687686, 16774, 1239, 20, 81, "Message"],
Cell[688928, 16796, 1237, 20, 81, "Message"],
Cell[690168, 16818, 503, 10, 24, "Message"],
Cell[690674, 16830, 1660, 27, 85, "Message"],
Cell[692337, 16859, 1660, 27, 85, "Message"],
Cell[694000, 16888, 1660, 27, 85, "Message"],
Cell[695663, 16917, 503, 10, 24, "Message"],
Cell[696169, 16929, 7730, 189, 212, "Output"],
Cell[703902, 17120, 453, 9, 49, "Message"],
Cell[704358, 17131, 453, 9, 49, "Message"],
Cell[704814, 17142, 452, 9, 49, "Message"],
Cell[705269, 17153, 502, 10, 24, "Message"],
Cell[705774, 17165, 1231, 21, 65, "Message"],
Cell[707008, 17188, 1231, 21, 65, "Message"],
Cell[708242, 17211, 1233, 21, 65, "Message"],
Cell[709478, 17234, 501, 10, 24, "Message"],
Cell[709982, 17246, 4113, 112, 112, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[714144, 17364, 111, 1, 43, "Section"],
Cell[CellGroupData[{
Cell[714280, 17369, 249, 6, 32, "Input"],
Cell[714532, 17377, 433, 9, 24, "Message"],
Cell[714968, 17388, 434, 9, 24, "Message"],
Cell[715405, 17399, 434, 9, 24, "Message"],
Cell[715842, 17410, 451, 9, 24, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[716330, 17424, 25248, 607, 2101, "Input"],
Cell[741581, 18033, 497, 10, 24, "Message"],
Cell[742081, 18045, 497, 10, 24, "Message"],
Cell[742581, 18057, 422, 9, 24, "Message"],
Cell[743006, 18068, 454, 9, 24, "Message"],
Cell[743463, 18079, 497, 10, 24, "Message"],
Cell[743963, 18091, 641, 12, 65, "Message"],
Cell[744607, 18105, 701, 12, 65, "Message"],
Cell[745311, 18119, 643, 12, 65, "Message"],
Cell[745957, 18133, 641, 12, 65, "Message"],
Cell[746601, 18147, 459, 9, 24, "Message"],
Cell[747063, 18158, 940, 15, 105, "Message"],
Cell[748006, 18175, 939, 15, 105, "Message"],
Cell[748948, 18192, 940, 15, 105, "Message"],
Cell[749891, 18209, 457, 9, 24, "Message"],
Cell[750351, 18220, 1339, 23, 85, "Message"],
Cell[751693, 18245, 1131, 18, 85, "Message"],
Cell[752827, 18265, 495, 10, 24, "Message"],
Cell[753325, 18277, 452, 9, 24, "Message"],
Cell[753780, 18288, 85, 1, 24, "Message"],
Cell[753868, 18291, 87, 1, 24, "Message"],
Cell[753958, 18294, 4517, 64, 692, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[758512, 18363, 126, 2, 32, "Input"],
Cell[758641, 18367, 2902, 52, 230, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[761580, 18424, 167, 4, 32, "Input"],
Cell[761750, 18430, 92, 2, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[761891, 18438, 99, 1, 73, "Section"],
Cell[CellGroupData[{
Cell[762015, 18443, 440, 10, 77, "Input"],
Cell[762458, 18455, 675, 12, 24, "Message"],
Cell[763136, 18469, 675, 12, 24, "Message"],
Cell[763814, 18483, 674, 12, 24, "Message"],
Cell[764491, 18497, 694, 12, 24, "Message"],
Cell[765188, 18511, 407, 6, 33, "Output"],
Cell[765598, 18519, 322, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[765957, 18528, 132, 2, 32, "Input"],
Cell[766092, 18532, 112, 1, 31, "Output"]
}, Open  ]],
Cell[766219, 18536, 1649, 52, 143, "Input"],
Cell[767871, 18590, 3044, 77, 275, "Input"],
Cell[770918, 18669, 2103, 62, 187, "Input"],
Cell[CellGroupData[{
Cell[773046, 18735, 1116, 30, 77, "Input"],
Cell[774165, 18767, 2121, 42, 436, "Output"],
Cell[776289, 18811, 482, 9, 24, "Message"],
Cell[776774, 18822, 482, 9, 24, "Message"],
Cell[777259, 18833, 482, 9, 24, "Message"],
Cell[777744, 18844, 452, 9, 24, "Message"],
Cell[778199, 18855, 428, 9, 24, "Message"],
Cell[778630, 18866, 426, 9, 24, "Message"],
Cell[779059, 18877, 482, 9, 24, "Message"],
Cell[779544, 18888, 482, 9, 24, "Message"],
Cell[780029, 18899, 484, 9, 24, "Message"],
Cell[780516, 18910, 453, 9, 24, "Message"],
Cell[780972, 18921, 484, 9, 24, "Message"],
Cell[781459, 18932, 482, 9, 24, "Message"],
Cell[781944, 18943, 482, 9, 24, "Message"],
Cell[782429, 18954, 453, 9, 24, "Message"],
Cell[782885, 18965, 484, 9, 24, "Message"],
Cell[783372, 18976, 482, 9, 24, "Message"],
Cell[783857, 18987, 482, 9, 24, "Message"],
Cell[784342, 18998, 453, 9, 24, "Message"]
}, Open  ]],
Cell[784810, 19010, 2861, 74, 319, "Input"],
Cell[CellGroupData[{
Cell[787696, 19088, 145, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[787866, 19094, 265, 7, 24, "Print"],
Cell[788134, 19103, 150, 3, 24, "Print"]
}, Open  ]],
Cell[788299, 19109, 319, 4, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[788655, 19118, 147, 2, 32, "Input"],
Cell[788805, 19122, 194, 5, 31, "Output"]
}, Open  ]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
